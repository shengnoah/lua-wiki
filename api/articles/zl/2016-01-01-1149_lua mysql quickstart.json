{"title":"lua mysql quickstart","uid":"2a29af4bdb847ed9c57801ebaf85b056","slug":"zl/2016-01-01-1149_lua mysql quickstart","date":"2024-04-03T03:47:33.016Z","updated":"2024-04-03T03:47:33.017Z","comments":true,"path":"api/articles/zl/2016-01-01-1149_lua mysql quickstart.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","content":"<div class=\"entry\">\n<pre><code>    &lt;p&gt;Here is the tutorial to write and build Lua application that can communicate with MySQL database.&lt;/p&gt;\n</code></pre>\n<h2 id=\"Dependency-Installation\"><a href=\"#Dependency-Installation\" class=\"headerlink\" title=\"Dependency Installation\"></a>Dependency Installation</h2><p>At first, we need to install LuaRocks. Here is the <a href=\"http://yular.github.io/2017/01/08/LuaRocks-QuickStart/\">tutorial</a>.</p>\n<p>We need to install dependency to access MySQL database through Lua. Execute the command to install dependency:<br/></p><figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\">luarocks install luasql-mysql MYSQL_INCDIR=/usr/include/mysql/</span><br/></pre></td></tr></tbody></table></figure><p></p>\n<p>But default dependency miss some libraries or variables. In that case, we need to use different source:<br/></p><figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\">luarocks --from=http://rocks.luarocks.org/dev install luasql-mysql cvs-1 MYSQL_INCDIR=/usr/include/mysql</span><br/></pre></td></tr></tbody></table></figure><p></p>\n<hr/>\n<h2 id=\"Sample-Code\"><a href=\"#Sample-Code\" class=\"headerlink\" title=\"Sample Code\"></a>Sample Code</h2><p>Below is the sample code to do MySQL query. The file name is mysql.lua:<br/></p><figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/><span class=\"line\">5</span><br/><span class=\"line\">6</span><br/><span class=\"line\">7</span><br/><span class=\"line\">8</span><br/><span class=\"line\">9</span><br/><span class=\"line\">10</span><br/><span class=\"line\">11</span><br/><span class=\"line\">12</span><br/><span class=\"line\">13</span><br/><span class=\"line\">14</span><br/><span class=\"line\">15</span><br/><span class=\"line\">16</span><br/><span class=\"line\">17</span><br/><span class=\"line\">18</span><br/><span class=\"line\">19</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\">luasql = require <span class=\"string\">&#34;luasql.mysql&#34;</span></span><br/><span class=\"line\">env = assert (luasql.mysql())</span><br/><span class=\"line\">con = assert (env:connect(<span class=\"string\">&#34;database_name&#34;</span>,<span class=\"string\">&#34;user_name&#34;</span>,<span class=\"string\">&#34;password&#34;</span>,<span class=\"string\">&#34;host_ip&#34;</span>,port))</span><br/><span class=\"line\"></span><br/><span class=\"line\"><span class=\"built_in\">print</span>(env,con)</span><br/><span class=\"line\"></span><br/><span class=\"line\">cur,errorString = con:execute([[select * from <span class=\"built_in\">test</span>;]])</span><br/><span class=\"line\"><span class=\"built_in\">print</span>(cur,errorString )</span><br/><span class=\"line\"></span><br/><span class=\"line\">row = cur:fetch ({}, <span class=\"string\">&#34;a&#34;</span>)</span><br/><span class=\"line\"></span><br/><span class=\"line\"><span class=\"keyword\">while</span> row <span class=\"keyword\">do</span></span><br/><span class=\"line\">    <span class=\"built_in\">print</span>(string.format(<span class=\"string\">&#34;Id: %s &#34;</span>, row.id))</span><br/><span class=\"line\">    row = cur:fetch (row, <span class=\"string\">&#34;a&#34;</span>)</span><br/><span class=\"line\">end</span><br/><span class=\"line\"></span><br/><span class=\"line\">cur:close()</span><br/><span class=\"line\">con:close()</span><br/><span class=\"line\">env:close()</span><br/></pre></td></tr></tbody></table></figure><p></p>\n<p>Then execute above lua script using following command:<br/></p><figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\">lua mysql.lua</span><br/></pre></td></tr></tbody></table></figure><p></p>\n<pre><code>&lt;/div&gt;\n\n&lt;footer&gt;\n    &lt;div class=&quot;alignright&quot;&gt;\n      \n      &lt;a href=&quot;javascript:void(0)&quot; class=&quot;share-link bdsharebuttonbox&quot; data-cmd=&quot;more&quot;&gt;Share&lt;/a&gt;\n    &lt;/div&gt;\n    \n    \n\n\n\n    \n  &lt;div class=&quot;clearfix&quot;&gt;&lt;/div&gt;\n&lt;/footer&gt;\n</code></pre>\n","text":" &lt;p&gt;Here is the tutorial to write and build Lua application that can communicate with MySQL database.&lt;/p&gt; Dependency Installatio...","link":"","photos":[],"count_time":{"symbolsCount":"1.5k","symbolsTime":"1 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Dependency-Installation\"><span class=\"toc-text\">Dependency Installation</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Sample-Code\"><span class=\"toc-text\">Sample Code</span></a></li></ol>","author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"lua redis quickstart","uid":"19ae04012cda1aea5fefcb599cd4ac49","slug":"zl/2016-01-01-1147_lua redis quickstart","date":"2024-04-03T03:47:33.016Z","updated":"2024-04-03T03:47:33.016Z","comments":true,"path":"api/articles/zl/2016-01-01-1147_lua redis quickstart.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":" &lt;p&gt;Here is a tutorial to install Redis Lua client library which are redis-lua and lredis. Actually, official library is redis-lua. Bu...","link":"","photos":[],"count_time":{"symbolsCount":"1.9k","symbolsTime":"2 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"lua mongodb quickstart","uid":"dcfa146d03cff7d7d8e3fb653130f0b9","slug":"zl/2016-01-01-1148_lua mongodb quickstart","date":"2024-04-03T03:47:33.016Z","updated":"2024-04-03T03:47:33.016Z","comments":true,"path":"api/articles/zl/2016-01-01-1148_lua mongodb quickstart.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":" &lt;p&gt;Here is the tutorial to write and build Lua application that can communicate with MongoDB database.&lt;/p&gt; Dependency Installat...","link":"","photos":[],"count_time":{"symbolsCount":"1.3k","symbolsTime":"1 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}}}