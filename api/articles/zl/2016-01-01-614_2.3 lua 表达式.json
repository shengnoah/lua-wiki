{"title":"2.3 lua 表达式","uid":"dbea4ef0040d964bfdee0e07b0e19da7","slug":"zl/2016-01-01-614_2.3 lua 表达式","date":"2024-04-03T03:47:35.840Z","updated":"2024-04-03T03:47:35.840Z","comments":true,"path":"api/articles/zl/2016-01-01-614_2.3 lua 表达式.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","content":"<h2 id=\"算术表达式\"><a href=\"#算术表达式\" class=\"headerlink\" title=\"算术表达式\"></a>算术表达式</h2><p>Lua 的算术运算符如下表所示：</p>\n<table>\n<thead>\n<tr>\n<th>表达符</th>\n<th>备注</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>+</td>\n<td>加法</td>\n</tr>\n<tr>\n<td>-</td>\n<td>减法</td>\n</tr>\n<tr>\n<td>*</td>\n<td>乘法</td>\n</tr>\n<tr>\n<td>/</td>\n<td>除法</td>\n</tr>\n<tr>\n<td>^</td>\n<td>指数</td>\n</tr>\n<tr>\n<td>%</td>\n<td>取模</td>\n</tr>\n</tbody>\n</table>\n<p>实例<br/></p><figure class=\"highlight lua\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/><span class=\"line\">5</span><br/><span class=\"line\">6</span><br/><span class=\"line\">7</span><br/><span class=\"line\">8</span><br/><span class=\"line\">9</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"number\">1</span> + <span class=\"number\">2</span>) </span><br/><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"number\">5</span> / <span class=\"number\">10</span>) <span class=\"comment\">--&gt;打印 0.5。 这是Lua不同于c语言的</span></span><br/><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"number\">5.0</span> / <span class=\"number\">10</span>) <span class=\"comment\">--&gt;打印 0.5。 浮点数相除的结果是浮点数</span></span><br/><span class=\"line\"><span class=\"comment\">-- print(10 / 0) --&gt;注意除数不能为0，计算的结果会出错</span></span><br/><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"number\">2</span> ^ <span class=\"number\">10</span>) <span class=\"comment\">--&gt;打印 1024。 求2的10次方</span></span><br/><span class=\"line\"><span class=\"keyword\">local</span> num = <span class=\"number\">1357</span></span><br/><span class=\"line\"><span class=\"built_in\">print</span>(num % <span class=\"number\">2</span>) <span class=\"comment\">--&gt;打印 1</span></span><br/><span class=\"line\"><span class=\"built_in\">print</span>((num % <span class=\"number\">2</span>) == <span class=\"number\">1</span>) <span class=\"comment\">--&gt;打印 true。 判断num是否为奇数</span></span><br/><span class=\"line\"><span class=\"built_in\">print</span>((num % <span class=\"number\">5</span>) == <span class=\"number\">0</span>) <span class=\"comment\">--&gt;打印 false。判断num是否能被5整数</span></span><br/></pre></td></tr></tbody></table></figure><p></p>\n<h2 id=\"关系表达式\"><a href=\"#关系表达式\" class=\"headerlink\" title=\"关系表达式\"></a>关系表达式</h2><table>\n<thead>\n<tr>\n<th>表达符</th>\n<th>备注</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>&lt;</td>\n<td>小于</td>\n</tr>\n<tr>\n<td>&gt;</td>\n<td>大于</td>\n</tr>\n<tr>\n<td>&lt;=</td>\n<td>小于等于</td>\n</tr>\n<tr>\n<td>&gt;=</td>\n<td>大于等于</td>\n</tr>\n<tr>\n<td>==</td>\n<td>等于</td>\n</tr>\n<tr>\n<td>~=</td>\n<td>不等于</td>\n</tr>\n</tbody>\n</table>\n<figure class=\"highlight lua\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/><span class=\"line\">5</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"number\">1</span> &lt; <span class=\"number\">2</span>) <span class=\"comment\">--&gt;打印 true</span></span><br/><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"number\">1</span> == <span class=\"number\">2</span>) <span class=\"comment\">--&gt;打印 false</span></span><br/><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"number\">1</span> ~= <span class=\"number\">2</span>) <span class=\"comment\">--&gt;打印 true</span></span><br/><span class=\"line\"><span class=\"keyword\">local</span> a, b = <span class=\"literal\">true</span>, <span class=\"literal\">false</span></span><br/><span class=\"line\"><span class=\"built_in\">print</span>(a == b) <span class=\"comment\">--&gt;打印 false</span></span><br/></pre></td></tr></tbody></table></figure>\n<p><strong>特别注意：</strong></p>\n<ol>\n<li>不同于C/C++等语言，lua中的“不等于”是<code>~=</code>而非<code>!=</code>.</li>\n<li>由于 Lua 字符串总是会被“内化”，即相同内容的字符串只会被保存一份，因此 Lua 字符串之间的相等性比较可以简化为其内部存储地址的比较。这意味着 Lua 字符串的相等性比较总是为 O(1). 而在其他编程语言中，字符串的相等性比较则通常为 O(n)，即需要逐个字节（ 或按若干个连续字节） 进行比较。</li>\n<li>在使用“==”做等于判断时，要注意对于 table, userdata 和函数， Lua 是作引用比较的。也就是说，只有当两个变量引用同一个对象时，才认为它们相等。如实例：<figure class=\"highlight lua\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/><span class=\"line\">5</span><br/><span class=\"line\">6</span><br/><span class=\"line\">7</span><br/><span class=\"line\">8</span><br/><span class=\"line\">9</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">local</span> a = { x = <span class=\"number\">1</span>, y = <span class=\"number\">0</span>}</span><br/><span class=\"line\"><span class=\"keyword\">local</span> b = { x = <span class=\"number\">1</span>, y = <span class=\"number\">0</span>}</span><br/><span class=\"line\"><span class=\"keyword\">if</span> a == b <span class=\"keyword\">then</span></span><br/><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#34;a==b&#34;</span>)</span><br/><span class=\"line\"><span class=\"keyword\">else</span></span><br/><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#34;a~=b&#34;</span>)</span><br/><span class=\"line\"><span class=\"keyword\">end</span></span><br/><span class=\"line\"><span class=\"comment\">---output:</span></span><br/><span class=\"line\">a~=b</span><br/></pre></td></tr></tbody></table></figure>\n</li>\n</ol>\n<h2 id=\"逻辑表达式\"><a href=\"#逻辑表达式\" class=\"headerlink\" title=\"逻辑表达式\"></a>逻辑表达式</h2><table>\n<thead>\n<tr>\n<th>表达符</th>\n<th>备注</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>and</td>\n<td>逻辑与</td>\n</tr>\n<tr>\n<td>or</td>\n<td>逻辑或</td>\n</tr>\n<tr>\n<td>not</td>\n<td>逻辑非</td>\n</tr>\n</tbody>\n</table>\n<p>Lua 中的 <code>and</code> 和 <code>or</code> 是不同于C/C++语言的。在C/C++语言中，<code>and</code> 和 <code>or</code> 只得到两个值 1 和 0，其中 1表示真，0 表示假。而 Lua 中 <code>and</code>和<code>or</code> 的执行结果返回的表达式的结果，而非<code>true</code>或者<code>flase</code>这类逻辑结果。也就是说：</p>\n<ol>\n<li><code>a and b</code> 如果 a 为 <code>nil</code>，则返回 a，否则返回 b;</li>\n<li><code>a or b</code> 如果 a 为 <code>nil</code>，则返回 b，否则返回 a。<figure class=\"highlight shell\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/><span class=\"line\">5</span><br/><span class=\"line\">6</span><br/><span class=\"line\">7</span><br/><span class=\"line\">8</span><br/><span class=\"line\">9</span><br/><span class=\"line\">10</span><br/><span class=\"line\">11</span><br/><span class=\"line\">12</span><br/><span class=\"line\">13</span><br/><span class=\"line\">14</span><br/><span class=\"line\">15</span><br/><span class=\"line\">16</span><br/><span class=\"line\">17</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\">local c = nil</span><br/><span class=\"line\">local d = 0</span><br/><span class=\"line\">local e = 100</span><br/><span class=\"line\">print(c and d)</span><br/><span class=\"line\">nil</span><br/><span class=\"line\">print(c and e)</span><br/><span class=\"line\">nil</span><br/><span class=\"line\"><span class=\"meta\">&gt;</span>print(d and e)</span><br/><span class=\"line\">100</span><br/><span class=\"line\"><span class=\"meta\">&gt;</span>print(c or d)</span><br/><span class=\"line\">0</span><br/><span class=\"line\"><span class=\"meta\">&gt;</span>print(c or e)</span><br/><span class=\"line\">100</span><br/><span class=\"line\"><span class=\"meta\">&gt;</span>print(not c)</span><br/><span class=\"line\">true</span><br/><span class=\"line\"><span class=\"meta\">&gt;</span>print(not d)</span><br/><span class=\"line\">false</span><br/></pre></td></tr></tbody></table></figure>\n</li>\n</ol>\n<p><strong>特别注意：</strong></p>\n<ol>\n<li>所有逻辑操作符将 false 和 nil 视作假，其他任何值视作真；</li>\n<li>对于 and 和 or，“短路求值”；</li>\n<li>对于 not，永远只返回 true 或者 false。</li>\n</ol>\n<h2 id=\"优先级\"><a href=\"#优先级\" class=\"headerlink\" title=\"优先级\"></a>优先级</h2><table>\n<thead>\n<tr>\n<th>优先级(由高到低)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>^</td>\n</tr>\n<tr>\n<td>not   # -</td>\n</tr>\n<tr>\n<td>*   /   %</td>\n</tr>\n<tr>\n<td>+   -</td>\n</tr>\n<tr>\n<td>..</td>\n</tr>\n<tr>\n<td>&lt; &gt; &lt;=  &gt;=  ==  ~=</td>\n</tr>\n<tr>\n<td>and</td>\n</tr>\n<tr>\n<td>or</td>\n</tr>\n</tbody>\n</table>\n<figure class=\"highlight lua\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/><span class=\"line\">5</span><br/><span class=\"line\">6</span><br/><span class=\"line\">7</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">local</span> a, b = <span class=\"number\">1</span>, <span class=\"number\">2</span></span><br/><span class=\"line\"><span class=\"keyword\">local</span> x, y = <span class=\"number\">3</span>, <span class=\"number\">4</span></span><br/><span class=\"line\"><span class=\"keyword\">local</span> i = <span class=\"number\">10</span></span><br/><span class=\"line\"><span class=\"keyword\">local</span> res = <span class=\"number\">0</span></span><br/><span class=\"line\">res = a + i &lt; b/<span class=\"number\">2</span> + <span class=\"number\">1</span> <span class=\"comment\">--&gt;等价于res = (a + i) &lt; ((b/2) + 1)</span></span><br/><span class=\"line\">res = <span class=\"number\">5</span> + x^<span class=\"number\">2</span>*<span class=\"number\">8</span> <span class=\"comment\">--&gt;等价于res = 5 + ((x^2) * 8)</span></span><br/><span class=\"line\">res = a &lt; y <span class=\"keyword\">and</span> y &lt;=x <span class=\"comment\">--&gt;等价于res = (a &lt; y) and (y &lt;= x)</span></span><br/></pre></td></tr></tbody></table></figure>\n<p><strong>tips</strong></p>\n<ol>\n<li>若不确定某些操作符的优先级，就应显示地用括号来指定运算顺序。这样做还可以提高代码的可读性。</li>\n</ol>","text":"算术表达式Lua 的算术运算符如下表所示： 表达符 备注 + 加法 - 减法 * 乘法 / 除法 ^ 指数 % 取模 实例123456789print(1 + 2) print(5 / 10) --&gt;打印 0.5。 这是Lua不同于c语言的print(5.0 / 10) -...","link":"","photos":[],"count_time":{"symbolsCount":"2k","symbolsTime":"2 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E7%AE%97%E6%9C%AF%E8%A1%A8%E8%BE%BE%E5%BC%8F\"><span class=\"toc-text\">算术表达式</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%85%B3%E7%B3%BB%E8%A1%A8%E8%BE%BE%E5%BC%8F\"><span class=\"toc-text\">关系表达式</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E9%80%BB%E8%BE%91%E8%A1%A8%E8%BE%BE%E5%BC%8F\"><span class=\"toc-text\">逻辑表达式</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%BC%98%E5%85%88%E7%BA%A7\"><span class=\"toc-text\">优先级</span></a></li></ol>","author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"LuaFramework笔记One","uid":"785eae8982424fd04179c4f85b57c3b9","slug":"zl/2016-01-01-613_LuaFramework笔记One","date":"2024-04-03T03:47:35.840Z","updated":"2024-04-03T03:47:35.840Z","comments":true,"path":"api/articles/zl/2016-01-01-613_LuaFramework笔记One.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":" Contents &lt;/div&gt; &lt;h2 id=&quot;AppConst-DebugMode&quot;&gt;&lt;a href=&quot;#AppConst-DebugMode&quot; class=&quot;headerlink&quot; t...","link":"","photos":[],"count_time":{"symbolsCount":"2.2k","symbolsTime":"2 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"Lua源码分享 Gc篇（三）流程之创建对象","uid":"1dfa68e18bc15f978e17b4ce78c93aaa","slug":"zl/2016-01-01-617_Lua源码分享 Gc篇（三）流程之创建对象","date":"2024-04-03T03:47:35.840Z","updated":"2024-04-03T03:47:35.841Z","comments":true,"path":"api/articles/zl/2016-01-01-617_Lua源码分享 Gc篇（三）流程之创建对象.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":"[TOC] 前面两篇主要介绍一些基础，帮助后面gc流程理解的。像是饭前的开胃菜一般，让你后面容易吃的更多。接下来几篇都是gc流程相关 这里列出几个问题，你可以直接跳过。当然，有所了解的按照自己的理解去回答一下，或许会有一些新的想法。如果你都会回答的很清晰了，那么接下来的系列几乎可...","link":"","photos":[],"count_time":{"symbolsCount":"4.1k","symbolsTime":"4 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}}}