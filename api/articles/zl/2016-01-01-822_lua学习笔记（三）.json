{"title":"lua学习笔记（三）","uid":"a6e7d68214239ff8f600e3be6607e5cf","slug":"zl/2016-01-01-822_lua学习笔记（三）","date":"2024-04-03T03:47:36.071Z","updated":"2024-04-03T03:47:36.072Z","comments":true,"path":"api/articles/zl/2016-01-01-822_lua学习笔记（三）.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","content":"<h2 id=\"Lua函数\"><a href=\"#Lua函数\" class=\"headerlink\" title=\"Lua函数\"></a>Lua函数</h2><h3 id=\"函数定义\"><a href=\"#函数定义\" class=\"headerlink\" title=\"函数定义\"></a>函数定义</h3><figure class=\"highlight lua\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/><span class=\"line\">5</span><br/><span class=\"line\">6</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br/><span class=\"line\">[<span class=\"keyword\">local</span>] <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"params\">(argument1,argument2)</span></span></span><br/><span class=\"line\">    <span class=\"comment\">-- do something</span></span><br/><span class=\"line\">    [<span class=\"keyword\">return</span> result]\t\t<span class=\"comment\">-- 可以返回多个值，每个值以逗号隔开</span></span><br/><span class=\"line\"><span class=\"keyword\">end</span></span><br/><span class=\"line\"><span class=\"comment\">-- 函数名表示该函数的引用，与C/C++的函数指针类似</span></span><br/></pre></td></tr></tbody></table></figure>\n<h3 id=\"可变参数\"><a href=\"#可变参数\" class=\"headerlink\" title=\"可变参数\"></a>可变参数</h3><figure class=\"highlight lua\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/><span class=\"line\">5</span><br/><span class=\"line\">6</span><br/><span class=\"line\">7</span><br/><span class=\"line\">8</span><br/><span class=\"line\">9</span><br/><span class=\"line\">10</span><br/><span class=\"line\">11</span><br/><span class=\"line\">12</span><br/><span class=\"line\">13</span><br/><span class=\"line\">14</span><br/><span class=\"line\">15</span><br/><span class=\"line\">16</span><br/><span class=\"line\">17</span><br/><span class=\"line\">18</span><br/><span class=\"line\">19</span><br/><span class=\"line\">20</span><br/><span class=\"line\">21</span><br/><span class=\"line\">22</span><br/><span class=\"line\">23</span><br/><span class=\"line\">24</span><br/><span class=\"line\">25</span><br/><span class=\"line\">26</span><br/><span class=\"line\">27</span><br/><span class=\"line\">28</span><br/><span class=\"line\">29</span><br/><span class=\"line\">30</span><br/><span class=\"line\">31</span><br/><span class=\"line\">32</span><br/><span class=\"line\">33</span><br/><span class=\"line\">34</span><br/><span class=\"line\">35</span><br/><span class=\"line\">36</span><br/><span class=\"line\">37</span><br/><span class=\"line\">38</span><br/><span class=\"line\">39</span><br/><span class=\"line\">40</span><br/><span class=\"line\">41</span><br/><span class=\"line\">42</span><br/><span class=\"line\">43</span><br/><span class=\"line\">44</span><br/><span class=\"line\">45</span><br/><span class=\"line\">46</span><br/><span class=\"line\">47</span><br/><span class=\"line\">48</span><br/><span class=\"line\">49</span><br/><span class=\"line\">50</span><br/><span class=\"line\">51</span><br/><span class=\"line\">52</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 与C语言类似，在函数参数列表中使用三点...表示函数有可变的参数</span></span><br/><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">add</span><span class=\"params\">(...)</span></span></span><br/><span class=\"line\">    <span class=\"keyword\">local</span> s=<span class=\"number\">0</span></span><br/><span class=\"line\">    <span class=\"keyword\">for</span> i,v <span class=\"keyword\">in</span> <span class=\"built_in\">ipairs</span>{...} <span class=\"keyword\">do</span>\t<span class=\"comment\">-- 注意这里是{}，{...}表示一个由所有变长参数构成的table（这里实质是一个数组）</span></span><br/><span class=\"line\">        s=s+v</span><br/><span class=\"line\">    <span class=\"keyword\">end</span></span><br/><span class=\"line\">    <span class=\"keyword\">return</span> s</span><br/><span class=\"line\"><span class=\"keyword\">end</span></span><br/><span class=\"line\"><span class=\"built_in\">print</span>(add(<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">6</span>,<span class=\"number\">7</span>))\t\t<span class=\"comment\">-- 输出：25</span></span><br/><span class=\"line\"></span><br/><span class=\"line\"><span class=\"comment\">-- 可变参数也可以赋值给一个变量</span></span><br/><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">average</span><span class=\"params\">(...)</span></span></span><br/><span class=\"line\">    result=<span class=\"number\">0</span></span><br/><span class=\"line\">    <span class=\"keyword\">local</span> <span class=\"built_in\">arg</span>={...}\t\t\t\t\t\t\t<span class=\"comment\">-- arg为一个table，局部变量</span></span><br/><span class=\"line\">    <span class=\"keyword\">for</span> i,v <span class=\"keyword\">in</span> <span class=\"built_in\">ipairs</span>(<span class=\"built_in\">arg</span>) <span class=\"keyword\">do</span></span><br/><span class=\"line\">        result=result+v</span><br/><span class=\"line\">    <span class=\"keyword\">end</span></span><br/><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&#34;总共传入 &#34;</span> .. #<span class=\"built_in\">arg</span> .. <span class=\"string\">&#34; 个数&#34;</span>)\t\t<span class=\"comment\">-- #也可以用于计算table中的元素个数</span></span><br/><span class=\"line\">    <span class=\"keyword\">return</span> result/#<span class=\"built_in\">arg</span></span><br/><span class=\"line\"><span class=\"keyword\">end</span></span><br/><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#34;平均值为&#34;</span>,average(<span class=\"number\">10</span>,<span class=\"number\">5</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">6</span>))</span><br/><span class=\"line\"></span><br/><span class=\"line\"><span class=\"comment\">-- 也可以通过select(&#34;#&#34;,...)来获取可变参数的数量</span></span><br/><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">average</span><span class=\"params\">(...)</span></span></span><br/><span class=\"line\">    result = <span class=\"number\">0</span></span><br/><span class=\"line\">    <span class=\"keyword\">local</span> <span class=\"built_in\">arg</span>={...}</span><br/><span class=\"line\">    <span class=\"keyword\">for</span> i,v <span class=\"keyword\">in</span> <span class=\"built_in\">ipairs</span>(<span class=\"built_in\">arg</span>) <span class=\"keyword\">do</span></span><br/><span class=\"line\">        result = result + v</span><br/><span class=\"line\">    <span class=\"keyword\">end</span></span><br/><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&#34;总共传入 &#34;</span> .. <span class=\"built_in\">select</span>(<span class=\"string\">&#34;#&#34;</span>,...) .. <span class=\"string\">&#34; 个数&#34;</span>)\t<span class=\"comment\">-- 等价于#arg</span></span><br/><span class=\"line\">    <span class=\"keyword\">return</span> result/<span class=\"built_in\">select</span>(<span class=\"string\">&#34;#&#34;</span>,...)</span><br/><span class=\"line\"><span class=\"keyword\">end</span></span><br/><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#34;平均值为&#34;</span>,average(<span class=\"number\">10</span>,<span class=\"number\">5</span>,<span class=\"number\">3</span>,<span class=\"number\">4</span>,<span class=\"number\">5</span>,<span class=\"number\">6</span>))</span><br/><span class=\"line\"></span><br/><span class=\"line\"><span class=\"comment\">-- 也可能同时需要固定参数和可变参数</span></span><br/><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">fwrite</span><span class=\"params\">(fmt,...)</span></span></span><br/><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">io</span>.<span class=\"built_in\">write</span>(<span class=\"built_in\">string</span>.<span class=\"built_in\">format</span>(fmt,...))</span><br/><span class=\"line\"><span class=\"keyword\">end</span></span><br/><span class=\"line\"></span><br/><span class=\"line\">fwrite(<span class=\"string\">&#34;ruan&#34;</span>)\t\t\t<span class=\"comment\">-- fmt=&#34;rua&#34;，没有可变参数</span></span><br/><span class=\"line\">fwrite(<span class=\"string\">&#34;%d%dn&#34;</span>,<span class=\"number\">1</span>,<span class=\"number\">2</span>)\t<span class=\"comment\">-- fmt=&#34;%d%d&#34;，可变参数为1和2</span></span><br/><span class=\"line\"></span><br/><span class=\"line\"><span class=\"comment\">-- select函数</span></span><br/><span class=\"line\"><span class=\"keyword\">do</span>  </span><br/><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">foo</span><span class=\"params\">(...)</span></span>  </span><br/><span class=\"line\">        <span class=\"keyword\">for</span> i = <span class=\"number\">1</span>, <span class=\"built_in\">select</span>(<span class=\"string\">&#39;#&#39;</span>, ...) <span class=\"keyword\">do</span>  <span class=\"comment\">-- 获取参数总数</span></span><br/><span class=\"line\">            <span class=\"keyword\">local</span> <span class=\"built_in\">arg</span> = <span class=\"built_in\">select</span>(i, ...); <span class=\"comment\">-- 读取第i个可变实参</span></span><br/><span class=\"line\">            <span class=\"built_in\">print</span>(<span class=\"string\">&#34;arg&#34;</span>, <span class=\"built_in\">arg</span>);</span><br/><span class=\"line\">        <span class=\"keyword\">end</span></span><br/><span class=\"line\">    <span class=\"keyword\">end</span></span><br/><span class=\"line\">    foo(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>);  </span><br/><span class=\"line\"><span class=\"keyword\">end</span></span><br/></pre></td></tr></tbody></table></figure>\n<h2 id=\"Lua运算符\"><a href=\"#Lua运算符\" class=\"headerlink\" title=\"Lua运算符\"></a>Lua运算符</h2><p>Lua运算符类型</p>\n<ul>\n<li>算术运算符</li>\n<li>关系运算符</li>\n<li>逻辑运算符</li>\n<li>其他运算符</li>\n</ul>\n<h3 id=\"算术运算符\"><a href=\"#算术运算符\" class=\"headerlink\" title=\"算术运算符\"></a>算术运算符</h3><p>除了<code>^</code>用于计算幂，其他加、减、乘、除、取余、取反等都与C/C++相同</p>\n<h3 id=\"关系运算符\"><a href=\"#关系运算符\" class=\"headerlink\" title=\"关系运算符\"></a>关系运算符</h3><p>除了不等于号<code>~=</code>，其他等于、大于、小于、大于等于、小于等于等都与C/C++相同</p>\n<h3 id=\"逻辑运算符\"><a href=\"#逻辑运算符\" class=\"headerlink\" title=\"逻辑运算符\"></a>逻辑运算符</h3><figure class=\"highlight lua\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 只有当值为nil或false才是假，其他都为真（0也为真）</span></span><br/><span class=\"line\"><span class=\"keyword\">and</span>\t<span class=\"comment\">-- 类似于C/C++的&amp;&amp;，当为假时返回从左到右表达式第一个为假的值（nil或false），否则返回后者</span></span><br/><span class=\"line\"><span class=\"keyword\">or</span>\t<span class=\"comment\">-- 类似于C/C++的||，当为真时返回从左到右表达式第一个为真的值（非nil和非false），否则返回后者</span></span><br/><span class=\"line\"><span class=\"keyword\">not</span> <span class=\"comment\">-- 类似于C/C++的！</span></span><br/></pre></td></tr></tbody></table></figure>\n<h3 id=\"其他运算符\"><a href=\"#其他运算符\" class=\"headerlink\" title=\"其他运算符\"></a>其他运算符</h3><figure class=\"highlight lua\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\">..\t\t<span class=\"comment\">-- 用于连接两个字符串或非字符串，最终返回一个字符串，注意连接一个number时需要在number与..之间加一个空格</span></span><br/><span class=\"line\">#\t\t<span class=\"comment\">-- 一元运算符，返回string或table的长度</span></span><br/></pre></td></tr></tbody></table></figure>\n<h3 id=\"运算符优先级\"><a href=\"#运算符优先级\" class=\"headerlink\" title=\"运算符优先级\"></a>运算符优先级</h3><table>\n<thead>\n<tr>\n<th style=\"text-align:center\">优先级</th>\n<th style=\"text-align:center\">运算符</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">1</td>\n<td style=\"text-align:center\">^</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">2</td>\n<td style=\"text-align:center\">not、-（负号）</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">3</td>\n<td style=\"text-align:center\">*、/</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">4</td>\n<td style=\"text-align:center\">+、-（减号）</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">5</td>\n<td style=\"text-align:center\">..</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">6</td>\n<td style=\"text-align:center\">&lt;、&gt;、&lt;=、&gt;=、~=、==</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">7</td>\n<td style=\"text-align:center\">and</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">8</td>\n<td style=\"text-align:center\">or</td>\n</tr>\n</tbody>\n</table>\n<p>除了<code>^</code>和<code>..</code>以外，其他所有的<strong><em>二元运算符</em></strong>都是<strong><em>从左向右</em></strong>结合</p>\n<h2 id=\"Lua字符串\"><a href=\"#Lua字符串\" class=\"headerlink\" title=\"Lua字符串\"></a>Lua字符串</h2><h3 id=\"字符串表示方法\"><a href=\"#字符串表示方法\" class=\"headerlink\" title=\"字符串表示方法\"></a>字符串表示方法</h3><figure class=\"highlight lua\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">&#39;a string&#39;</span>\t\t<span class=\"comment\">-- 单引号</span></span><br/><span class=\"line\"><span class=\"string\">&#34;a string&#34;</span>\t\t<span class=\"comment\">-- 双引号</span></span><br/><span class=\"line\"><span class=\"string\">[[a string]]</span>\t<span class=\"comment\">-- 双中括号</span></span><br/></pre></td></tr></tbody></table></figure>\n<h3 id=\"转义字符\"><a href=\"#转义字符\" class=\"headerlink\" title=\"转义字符\"></a>转义字符</h3><p>与C/C++相同</p>\n<h3 id=\"字符串操作\"><a href=\"#字符串操作\" class=\"headerlink\" title=\"字符串操作\"></a>字符串操作</h3><figure class=\"highlight lua\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/><span class=\"line\">5</span><br/><span class=\"line\">6</span><br/><span class=\"line\">7</span><br/><span class=\"line\">8</span><br/><span class=\"line\">9</span><br/><span class=\"line\">10</span><br/><span class=\"line\">11</span><br/><span class=\"line\">12</span><br/><span class=\"line\">13</span><br/><span class=\"line\">14</span><br/><span class=\"line\">15</span><br/><span class=\"line\">16</span><br/><span class=\"line\">17</span><br/><span class=\"line\">18</span><br/><span class=\"line\">19</span><br/><span class=\"line\">20</span><br/><span class=\"line\">21</span><br/><span class=\"line\">22</span><br/><span class=\"line\">23</span><br/><span class=\"line\">24</span><br/><span class=\"line\">25</span><br/><span class=\"line\">26</span><br/><span class=\"line\">27</span><br/><span class=\"line\">28</span><br/><span class=\"line\">29</span><br/><span class=\"line\">30</span><br/><span class=\"line\">31</span><br/><span class=\"line\">32</span><br/><span class=\"line\">33</span><br/><span class=\"line\">34</span><br/><span class=\"line\">35</span><br/><span class=\"line\">36</span><br/><span class=\"line\">37</span><br/><span class=\"line\">38</span><br/><span class=\"line\">39</span><br/><span class=\"line\">40</span><br/><span class=\"line\">41</span><br/><span class=\"line\">42</span><br/><span class=\"line\">43</span><br/><span class=\"line\">44</span><br/><span class=\"line\">45</span><br/><span class=\"line\">46</span><br/><span class=\"line\">47</span><br/><span class=\"line\">48</span><br/><span class=\"line\">49</span><br/><span class=\"line\">50</span><br/><span class=\"line\">51</span><br/><span class=\"line\">52</span><br/><span class=\"line\">53</span><br/><span class=\"line\">54</span><br/><span class=\"line\">55</span><br/><span class=\"line\">56</span><br/><span class=\"line\">57</span><br/><span class=\"line\">58</span><br/><span class=\"line\">59</span><br/><span class=\"line\">60</span><br/><span class=\"line\">61</span><br/><span class=\"line\">62</span><br/><span class=\"line\">63</span><br/><span class=\"line\">64</span><br/><span class=\"line\">65</span><br/><span class=\"line\">66</span><br/><span class=\"line\">67</span><br/><span class=\"line\">68</span><br/><span class=\"line\">69</span><br/><span class=\"line\">70</span><br/><span class=\"line\">71</span><br/><span class=\"line\">72</span><br/><span class=\"line\">73</span><br/><span class=\"line\">74</span><br/><span class=\"line\">75</span><br/><span class=\"line\">76</span><br/><span class=\"line\">77</span><br/><span class=\"line\">78</span><br/><span class=\"line\">79</span><br/><span class=\"line\">80</span><br/><span class=\"line\">81</span><br/><span class=\"line\">82</span><br/><span class=\"line\">83</span><br/><span class=\"line\">84</span><br/><span class=\"line\">85</span><br/><span class=\"line\">86</span><br/><span class=\"line\">87</span><br/><span class=\"line\">88</span><br/><span class=\"line\">89</span><br/><span class=\"line\">90</span><br/><span class=\"line\">91</span><br/><span class=\"line\">92</span><br/><span class=\"line\">93</span><br/><span class=\"line\">94</span><br/><span class=\"line\">95</span><br/><span class=\"line\">96</span><br/><span class=\"line\">97</span><br/><span class=\"line\">98</span><br/><span class=\"line\">99</span><br/><span class=\"line\">100</span><br/><span class=\"line\">101</span><br/><span class=\"line\">102</span><br/><span class=\"line\">103</span><br/><span class=\"line\">104</span><br/><span class=\"line\">105</span><br/><span class=\"line\">106</span><br/><span class=\"line\">107</span><br/><span class=\"line\">108</span><br/><span class=\"line\">109</span><br/><span class=\"line\">110</span><br/><span class=\"line\">111</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">--[[</span></span><br/><span class=\"line\"><span class=\"comment\">作用：字符串全部转为大写字母</span></span><br/><span class=\"line\"><span class=\"comment\">参数列表：</span></span><br/><span class=\"line\"><span class=\"comment\">\targument：原字符串</span></span><br/><span class=\"line\"><span class=\"comment\">返回值：转换为大写后的字符串</span></span><br/><span class=\"line\"><span class=\"comment\">]]</span></span><br/><span class=\"line\"><span class=\"built_in\">string</span>.<span class=\"built_in\">upper</span>(argument)</span><br/><span class=\"line\"></span><br/><span class=\"line\"><span class=\"comment\">--[[</span></span><br/><span class=\"line\"><span class=\"comment\">作用：字符串全部转为小写字母</span></span><br/><span class=\"line\"><span class=\"comment\">参数列表：</span></span><br/><span class=\"line\"><span class=\"comment\">\targument：原字符串</span></span><br/><span class=\"line\"><span class=\"comment\">返回值：转换为小写后的字符串</span></span><br/><span class=\"line\"><span class=\"comment\">]]</span></span><br/><span class=\"line\"><span class=\"built_in\">string</span>.<span class=\"built_in\">lower</span>(argument)</span><br/><span class=\"line\"></span><br/><span class=\"line\"><span class=\"comment\">--[[</span></span><br/><span class=\"line\"><span class=\"comment\">作用：在字符串中替换，相当于其他语言的string.replace</span></span><br/><span class=\"line\"><span class=\"comment\">参数列表：</span></span><br/><span class=\"line\"><span class=\"comment\">\tmainString：要替换的字符串</span></span><br/><span class=\"line\"><span class=\"comment\">\tfindString：被替换的字符串</span></span><br/><span class=\"line\"><span class=\"comment\">\treplaceString：要替换成的字符串</span></span><br/><span class=\"line\"><span class=\"comment\">\tnum：替换次数（忽略表示全部替换）</span></span><br/><span class=\"line\"><span class=\"comment\">返回值：替换后的字符串和实际替换次数</span></span><br/><span class=\"line\"><span class=\"comment\">]]</span></span><br/><span class=\"line\"><span class=\"built_in\">string</span>.<span class=\"built_in\">gsub</span>(mainString,findString,replaceString,num)</span><br/><span class=\"line\"></span><br/><span class=\"line\"><span class=\"comment\">--[[</span></span><br/><span class=\"line\"><span class=\"comment\">作用：查找子串</span></span><br/><span class=\"line\"><span class=\"comment\">参数列表：</span></span><br/><span class=\"line\"><span class=\"comment\">\tstr：目标字符串</span></span><br/><span class=\"line\"><span class=\"comment\">\tsubstr：子串</span></span><br/><span class=\"line\"><span class=\"comment\">\tinit：查找的起始索引</span></span><br/><span class=\"line\"><span class=\"comment\">\tend：查找的末尾索引</span></span><br/><span class=\"line\"><span class=\"comment\">返回值：子串始末字符位置索引，不存在返回nil</span></span><br/><span class=\"line\"><span class=\"comment\">]]</span></span><br/><span class=\"line\"><span class=\"built_in\">string</span>.<span class=\"built_in\">find</span>(str,substr,[init,[<span class=\"keyword\">end</span>]])</span><br/><span class=\"line\"></span><br/><span class=\"line\"><span class=\"comment\">--[[</span></span><br/><span class=\"line\"><span class=\"comment\">作用：字符串反转</span></span><br/><span class=\"line\"><span class=\"comment\">参数列表：</span></span><br/><span class=\"line\"><span class=\"comment\">\targ：原字符串</span></span><br/><span class=\"line\"><span class=\"comment\">返回值：反转后的字符串</span></span><br/><span class=\"line\"><span class=\"comment\">]]</span></span><br/><span class=\"line\"><span class=\"built_in\">string</span>.<span class=\"built_in\">reverse</span>(<span class=\"built_in\">arg</span>)</span><br/><span class=\"line\"></span><br/><span class=\"line\"><span class=\"comment\">--[[</span></span><br/><span class=\"line\"><span class=\"comment\">作用：返回一个类似C语言的printf的格式化字符串</span></span><br/><span class=\"line\"><span class=\"comment\">参数列表：</span></span><br/><span class=\"line\"><span class=\"comment\">\t...：可变参数列表</span></span><br/><span class=\"line\"><span class=\"comment\">返回值：格式化字符串</span></span><br/><span class=\"line\"><span class=\"comment\">]]</span></span><br/><span class=\"line\"><span class=\"built_in\">string</span>.<span class=\"built_in\">format</span>(...)</span><br/><span class=\"line\"><span class=\"comment\">-- 示例</span></span><br/><span class=\"line\"><span class=\"built_in\">string</span>.<span class=\"built_in\">format</span>(<span class=\"string\">&#34;the value is:%d&#34;</span>,<span class=\"number\">4</span>)\t<span class=\"comment\">-- 返回：the value is:4</span></span><br/><span class=\"line\"></span><br/><span class=\"line\"><span class=\"comment\">--[[</span></span><br/><span class=\"line\"><span class=\"comment\">作用：将整型数字转成字符并连接</span></span><br/><span class=\"line\"><span class=\"comment\">参数列表：</span></span><br/><span class=\"line\"><span class=\"comment\">\targ：ASCCI码组成的参数列表</span></span><br/><span class=\"line\"><span class=\"comment\">返回值：一个由ASCCI码对应的字符连接成的字符串</span></span><br/><span class=\"line\"><span class=\"comment\">]]</span></span><br/><span class=\"line\"><span class=\"built_in\">string</span>.<span class=\"built_in\">char</span>(<span class=\"built_in\">arg</span>)</span><br/><span class=\"line\"></span><br/><span class=\"line\"><span class=\"comment\">--[[</span></span><br/><span class=\"line\"><span class=\"comment\">作用：转换字符为整数值</span></span><br/><span class=\"line\"><span class=\"comment\">参数列表：</span></span><br/><span class=\"line\"><span class=\"comment\">\targ：字符串</span></span><br/><span class=\"line\"><span class=\"comment\">\tint：指定字符串某索引位置的字符，默认为第一个字符</span></span><br/><span class=\"line\"><span class=\"comment\">返回值：字符对应的ASCCI码整数值</span></span><br/><span class=\"line\"><span class=\"comment\">]]</span></span><br/><span class=\"line\"><span class=\"built_in\">string</span>.<span class=\"built_in\">byte</span>(<span class=\"built_in\">arg</span>，[int])</span><br/><span class=\"line\"></span><br/><span class=\"line\"><span class=\"comment\">--[[</span></span><br/><span class=\"line\"><span class=\"comment\">作用：计算字符串长度</span></span><br/><span class=\"line\"><span class=\"comment\">参数列表：</span></span><br/><span class=\"line\"><span class=\"comment\">\targ：字符串</span></span><br/><span class=\"line\"><span class=\"comment\">返回值：字符串长度</span></span><br/><span class=\"line\"><span class=\"comment\">]]</span></span><br/><span class=\"line\"><span class=\"built_in\">string</span>.<span class=\"built_in\">len</span>(<span class=\"built_in\">arg</span>)</span><br/><span class=\"line\"></span><br/><span class=\"line\"><span class=\"comment\">--[[</span></span><br/><span class=\"line\"><span class=\"comment\">作用：拷贝并连接n个字符串</span></span><br/><span class=\"line\"><span class=\"comment\">参数列表：</span></span><br/><span class=\"line\"><span class=\"comment\">\tstring：字符串</span></span><br/><span class=\"line\"><span class=\"comment\">\tn：拷贝次数</span></span><br/><span class=\"line\"><span class=\"comment\">返回值：字符串string的n个拷贝连接成的字符串</span></span><br/><span class=\"line\"><span class=\"comment\">]]</span></span><br/><span class=\"line\"><span class=\"built_in\">string</span>.<span class=\"built_in\">rep</span>(<span class=\"built_in\">string</span>,n)</span><br/><span class=\"line\"></span><br/><span class=\"line\"><span class=\"comment\">-- 连接字符串</span></span><br/><span class=\"line\">..</span><br/><span class=\"line\"></span><br/><span class=\"line\"><span class=\"comment\">--[[</span></span><br/><span class=\"line\"><span class=\"comment\">作用：查找下一个匹配的子串</span></span><br/><span class=\"line\"><span class=\"comment\">参数列表：</span></span><br/><span class=\"line\"><span class=\"comment\">\tstr：字符串</span></span><br/><span class=\"line\"><span class=\"comment\">\tpattern：正则匹配表达式</span></span><br/><span class=\"line\"><span class=\"comment\">返回值：一个迭代器函数，每一次调用这个函数，返回一个在字符串 str 找到的下一个符合 pattern 描述的子串，如果没有找到子串，返回nil</span></span><br/><span class=\"line\"><span class=\"comment\">]]</span></span><br/><span class=\"line\"><span class=\"built_in\">string</span>.<span class=\"built_in\">gmatch</span>(str,pattern)</span><br/><span class=\"line\"></span><br/><span class=\"line\"><span class=\"comment\">--[[</span></span><br/><span class=\"line\"><span class=\"comment\">作用：寻找原字符串str中的第一个配对</span></span><br/><span class=\"line\"><span class=\"comment\">参数列表：</span></span><br/><span class=\"line\"><span class=\"comment\">\tstr：字符串</span></span><br/><span class=\"line\"><span class=\"comment\">\tpattern：正则匹配表达式</span></span><br/><span class=\"line\"><span class=\"comment\">\tinit：指定搜寻过程的起点，默认为1</span></span><br/><span class=\"line\"><span class=\"comment\">返回值：配对表达式中的所有捕获结果，即匹配到的字符串</span></span><br/><span class=\"line\"><span class=\"comment\">]]</span></span><br/><span class=\"line\"><span class=\"built_in\">string</span>.<span class=\"built_in\">match</span>(str,pattern,init)</span><br/></pre></td></tr></tbody></table></figure>\n<h3 id=\"字符串格式化\"><a href=\"#字符串格式化\" class=\"headerlink\" title=\"字符串格式化\"></a>字符串格式化</h3><p>除了<code>%q</code>，其余与C语言类似</p>\n<figure class=\"highlight lua\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/><span class=\"line\">5</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- %q接受一个字符串并将其转化为可安全被Lua编译器读入的格式，以下写法输出等价</span></span><br/><span class=\"line\"><span class=\"built_in\">string</span>.<span class=\"built_in\">format</span>(<span class=\"string\">&#34;%q&#34;</span>,<span class=\"string\">&#34;thenLua&#34;</span>)</span><br/><span class=\"line\"><span class=\"comment\">-- 输出以下字符串，与在Lua编辑器下编写换行的字符串等价</span></span><br/><span class=\"line\"><span class=\"string\">&#34;the</span></span><br/><span class=\"line\"><span class=\"string\">Lua&#34;</span></span><br/></pre></td></tr></tbody></table></figure>\n<p><strong><em>注意：</em></strong><code>%x</code>与<code>%X</code>，<code>%e</code>与<code>%E</code>是不同的输出，前者输出都为小写字母，后者输出统一为大写字母</p>\n<figure class=\"highlight lua\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">string</span>.<span class=\"built_in\">format</span>(<span class=\"string\">&#34;%x&#34;</span>,<span class=\"number\">13</span>)\t\t<span class=\"comment\">-- 输出d</span></span><br/><span class=\"line\"><span class=\"built_in\">string</span>.<span class=\"built_in\">format</span>(<span class=\"string\">&#34;%X&#34;</span>,<span class=\"number\">13</span>)\t\t<span class=\"comment\">-- 输出D</span></span><br/><span class=\"line\"><span class=\"built_in\">string</span>.<span class=\"built_in\">format</span>(<span class=\"string\">&#34;%e&#34;</span>,<span class=\"number\">1000</span>)\t<span class=\"comment\">-- 输出1.000000e+03</span></span><br/><span class=\"line\"><span class=\"built_in\">string</span>.<span class=\"built_in\">format</span>(<span class=\"string\">&#34;%E&#34;</span>,<span class=\"number\">1000</span>)\t<span class=\"comment\">-- 输出1.000000E+03</span></span><br/></pre></td></tr></tbody></table></figure>\n<h3 id=\"匹配模式\"><a href=\"#匹配模式\" class=\"headerlink\" title=\"匹配模式\"></a>匹配模式</h3><p><a href=\"https://www.runoob.com/lua/lua-strings.html\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.runoob.com/lua/lua-strings.html</a></p>","text":"Lua函数函数定义123456[local] function (argument1,argument2) -- do something [return result] -- 可以返回多个值，每个值以逗号隔开end-- 函数名表示该函数的引用，与C/C++的函数指针类似 可变参...","link":"","photos":[],"count_time":{"symbolsCount":"4.1k","symbolsTime":"4 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Lua%E5%87%BD%E6%95%B0\"><span class=\"toc-text\">Lua函数</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%87%BD%E6%95%B0%E5%AE%9A%E4%B9%89\"><span class=\"toc-text\">函数定义</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%8F%AF%E5%8F%98%E5%8F%82%E6%95%B0\"><span class=\"toc-text\">可变参数</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Lua%E8%BF%90%E7%AE%97%E7%AC%A6\"><span class=\"toc-text\">Lua运算符</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%AE%97%E6%9C%AF%E8%BF%90%E7%AE%97%E7%AC%A6\"><span class=\"toc-text\">算术运算符</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%85%B3%E7%B3%BB%E8%BF%90%E7%AE%97%E7%AC%A6\"><span class=\"toc-text\">关系运算符</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6\"><span class=\"toc-text\">逻辑运算符</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%85%B6%E4%BB%96%E8%BF%90%E7%AE%97%E7%AC%A6\"><span class=\"toc-text\">其他运算符</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E8%BF%90%E7%AE%97%E7%AC%A6%E4%BC%98%E5%85%88%E7%BA%A7\"><span class=\"toc-text\">运算符优先级</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Lua%E5%AD%97%E7%AC%A6%E4%B8%B2\"><span class=\"toc-text\">Lua字符串</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%A1%A8%E7%A4%BA%E6%96%B9%E6%B3%95\"><span class=\"toc-text\">字符串表示方法</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E8%BD%AC%E4%B9%89%E5%AD%97%E7%AC%A6\"><span class=\"toc-text\">转义字符</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%93%8D%E4%BD%9C\"><span class=\"toc-text\">字符串操作</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%A0%BC%E5%BC%8F%E5%8C%96\"><span class=\"toc-text\">字符串格式化</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%8C%B9%E9%85%8D%E6%A8%A1%E5%BC%8F\"><span class=\"toc-text\">匹配模式</span></a></li></ol></li></ol>","author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"StackExchange.Redis加载Lua脚本进行模糊查询的批量删除和修改","uid":"f637a9bed7edc1a303f75d2f48bec364","slug":"zl/2016-01-01-823_StackExchange.Redis加载Lua脚本进行模糊查询的批量删除和修改","date":"2024-04-03T03:47:36.072Z","updated":"2024-04-03T03:47:36.073Z","comments":true,"path":"api/articles/zl/2016-01-01-823_StackExchange.Redis加载Lua脚本进行模糊查询的批量删除和修改.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":" 通过keys进行模糊查询后的批量操作 对Hash集合下的key进行模糊查询后的批量操作 对Set集合下的值进行模糊查询后的批量操作 注意 通过keys进行模糊查询后的批量操作 var redis = ConnectionMultiplexer.Connect(&#34;127....","link":"","photos":[],"count_time":{"symbolsCount":"3.1k","symbolsTime":"3 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"Lua和C++的交互","uid":"4c0cbe37244e982275e6a931b2589d5a","slug":"zl/2016-01-01-821_Lua和C++的交互 ","date":"2024-04-03T03:47:36.067Z","updated":"2024-04-03T03:47:36.071Z","comments":true,"path":"api/articles/zl/2016-01-01-821_Lua和C++的交互 .json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":"目录 Lua堆栈 Lua堆栈操作 C++调用lua Lua调用C++ There is something beautiful， just to find it. Lua堆栈 要理解Lua和C++的交互，首先要清楚Lua堆栈。简单来说Lua和C++交互是通过一个无处不在的虚拟堆栈...","link":"","photos":[],"count_time":{"symbolsCount":"28k","symbolsTime":"25 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}}}