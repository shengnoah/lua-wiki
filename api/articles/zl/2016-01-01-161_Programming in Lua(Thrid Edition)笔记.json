{"title":"Programming in Lua(Thrid Edition)笔记","uid":"a502732b8dc58224e972b6c53538b8c4","slug":"zl/2016-01-01-161_Programming in Lua(Thrid Edition)笔记","date":"2024-04-03T03:47:33.052Z","updated":"2024-04-03T03:47:33.052Z","comments":true,"path":"api/articles/zl/2016-01-01-161_Programming in Lua(Thrid Edition)笔记.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","content":"<h3 id=\"3-Expressions\"><a href=\"#3-Expressions\" class=\"headerlink\" title=\"3 Expressions\"></a>3 Expressions</h3>\n<ul>\n<li><p><code>a % b == a - math.floor(a / b) * b</code>，可以用于浮点数，<code>x % 1</code>为x的小数部分，<code>x - x % 1</code>为x的整数部分，<code>x-x%0.01</code>可以保留x两位小数，也可以用于角度对360取模和弧度对2PI取模<code>angle%(2*math.pi)</code></p>\n</li>\n<li><p><code>~=</code>与<code>==</code>作用相反</p>\n</li>\n<li><p>Lua可以根据本地字符编码比较字符串大小</p>\n</li>\n<li><p>逻辑操作符<code>and</code>，<code>or</code>，<code>not</code></p>\n</li>\n<li><p><code>x = x or v</code>相当于</p>\n<figure class=\"highlight lua\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> <span class=\"keyword\">not</span> x <span class=\"keyword\">then</span> x = v <span class=\"keyword\">end</span></span><br/></pre></td></tr></tbody></table></figure>\n</li>\n</ul>\n<p>可以在x未被赋值时对其赋值</p>\n<ul>\n<li><p><code>(a and b) or c</code>与C的<code>a ? b : c</code>等价</p>\n<figure class=\"highlight lua\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">max</span> = (x &gt; y) <span class=\"keyword\">and</span> x <span class=\"keyword\">or</span> y</span><br/></pre></td></tr></tbody></table></figure>\n</li>\n<li><p><code>..</code>用于连接字符串</p>\n<figure class=\"highlight lua\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#34;Hello &#34;</span> .. <span class=\"string\">&#34;world&#34;</span>) </span><br/><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"number\">0</span> .. <span class=\"number\">1</span>)              <span class=\"comment\">--&gt; 01</span></span><br/><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"number\">000</span> .. <span class=\"number\">01</span>)           <span class=\"comment\">--&gt; 01</span></span><br/></pre></td></tr></tbody></table></figure>\n</li>\n</ul>\n<p><code>print(000 .. 01)</code>中会先求值，再转换为字符串，再连接</p>\n<ul>\n<li><p><code>a[#a + ] = v</code>把v加到列表a的末尾</p>\n</li>\n<li><p>关于有洞的列表的长度</p>\n<figure class=\"highlight lua\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/><span class=\"line\">5</span><br/><span class=\"line\">6</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\">c = {<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>}</span><br/><span class=\"line\"><span class=\"built_in\">print</span>(#c) <span class=\"comment\">--&gt; 3</span></span><br/><span class=\"line\">c[<span class=\"number\">2</span>] = <span class=\"literal\">nil</span></span><br/><span class=\"line\"><span class=\"built_in\">print</span>(#c) <span class=\"comment\">--&gt; 3</span></span><br/><span class=\"line\">c[<span class=\"number\">3</span>] = <span class=\"literal\">nil</span></span><br/><span class=\"line\"><span class=\"built_in\">print</span>(#c) <span class=\"comment\">--&gt; 1</span></span><br/></pre></td></tr></tbody></table></figure>\n</li>\n<li><p><code>a = &#123;1, 2, 3, nil, nil&#125;</code>与<code>a = &#123;1, 2, 3&#125;</code>相同，长度均为3</p>\n</li>\n<li><p>优先级：</p>\n<figure class=\"highlight lua\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/><span class=\"line\">5</span><br/><span class=\"line\">6</span><br/><span class=\"line\">7</span><br/><span class=\"line\">8</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\">^</span><br/><span class=\"line\"><span class=\"keyword\">not</span> # -(unary)</span><br/><span class=\"line\">* / %</span><br/><span class=\"line\">+ -</span><br/><span class=\"line\">..</span><br/><span class=\"line\">&lt; &gt; &lt;= &gt;= ~= ==</span><br/><span class=\"line\"><span class=\"keyword\">and</span></span><br/><span class=\"line\"><span class=\"keyword\">or</span></span><br/></pre></td></tr></tbody></table></figure>\n</li>\n<li><p><code>a = &#123;x = 10, y = 20&#125;</code>比<code>a = &#123;&#125;; a.x = 10; a.y = 20</code>快一些 </p>\n</li>\n<li><p>混用list风格和record风格构造table</p>\n<figure class=\"highlight lua\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/><span class=\"line\">5</span><br/><span class=\"line\">6</span><br/><span class=\"line\">7</span><br/><span class=\"line\">8</span><br/><span class=\"line\">9</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\">polyline = {</span><br/><span class=\"line\">color = <span class=\"string\">&#34;blue&#34;</span>,</span><br/><span class=\"line\">thickness = <span class=\"number\">2</span>,</span><br/><span class=\"line\">npoints = <span class=\"number\">4</span>,</span><br/><span class=\"line\">{x = <span class=\"number\">0</span>, y = <span class=\"number\">0</span>},   <span class=\"comment\">-- polyline[1]</span></span><br/><span class=\"line\">{x = <span class=\"number\">-10</span>, y = <span class=\"number\">0</span>}, <span class=\"comment\">-- polyline[2]</span></span><br/><span class=\"line\">{x = <span class=\"number\">-10</span>, y = <span class=\"number\">1</span>}, <span class=\"comment\">-- polyline[3]</span></span><br/><span class=\"line\">{x = <span class=\"number\">0</span>, y = <span class=\"number\">1</span>},   <span class=\"comment\">-- polyline[4]</span></span><br/><span class=\"line\">}</span><br/></pre></td></tr></tbody></table></figure>\n</li>\n<li><p>几种特殊的table构造方式：</p>\n<figure class=\"highlight lua\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\">a = {[<span class=\"string\">&#34;+&#34;</span>] = <span class=\"string\">&#34;add&#34;</span>, [<span class=\"string\">&#34;-&#34;</span>] = <span class=\"string\">&#34;sub&#34;</span>,</span><br/><span class=\"line\">     [<span class=\"string\">&#34;*&#34;</span>] = <span class=\"string\">&#34;mul&#34;</span>, [<span class=\"string\">&#34;/&#34;</span>] = <span class=\"string\">&#34;div&#34;</span>}</span><br/><span class=\"line\">b = {[<span class=\"number\">1</span>]=<span class=\"string\">&#34;red&#34;</span>, [<span class=\"number\">2</span>]=<span class=\"string\">&#34;green&#34;</span>, [<span class=\"number\">3</span>]=<span class=\"string\">&#34;blu&#34;</span>,}</span><br/></pre></td></tr></tbody></table></figure>\n</li>\n</ul>\n<p>最后一个entry后的逗号可选</p>\n<ul>\n<li>在table的构造中，可以用分号代替逗号来分隔不同部分，例如list和record</li>\n</ul>","text":"3 Expressions a % b == a - math.floor(a / b) * b，可以用于浮点数，x % 1为x的小数部分，x - x % 1为x的整数部分，x-x%0.01可以保留x两位小数，也可以用于角度对360取模和弧度对2PI取模angle%(2*math...","link":"","photos":[],"count_time":{"symbolsCount":"1.3k","symbolsTime":"1 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#3-Expressions\"><span class=\"toc-text\">3 Expressions</span></a></li></ol>","author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"Lua 学习手记","uid":"ea602d69a91169b1a66e72dc3f4ebe31","slug":"zl/2016-01-01-163_Lua 学习手记","date":"2024-04-03T03:47:33.052Z","updated":"2024-04-03T03:47:33.053Z","comments":true,"path":"api/articles/zl/2016-01-01-163_Lua 学习手记.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":" Lua 语法说明 Lua 语法优化 其他语言调用 Lua 导语 介绍 Lua 的语法和优化细节 Lua 是一种轻量小巧的脚本语言，一个完整的 Lua 解释器不过200k，用标准 C 语言编写并以源代码形式开放。但麻雀虽小五脏俱全，Lua 本身其设计目的就是为了嵌入应用程序中，从...","link":"","photos":[],"count_time":{"symbolsCount":"5.6k","symbolsTime":"5 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"Programming in Lua(Thrid Edition)笔记","uid":"a502732b8dc58224e972b6c53538b8c4","slug":"zl/2016-01-01-159_Programming in Lua(Thrid Edition)笔记","date":"2024-04-03T03:47:33.051Z","updated":"2024-04-03T03:47:33.051Z","comments":true,"path":"api/articles/zl/2016-01-01-159_Programming in Lua(Thrid Edition)笔记.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":"16 Object-oriented Programming 对象和方法1234567891011Account = { balance = 0, withdraw = function (self, v) self.balance = self.balance - v end}...","link":"","photos":[],"count_time":{"symbolsCount":"3.5k","symbolsTime":"3 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}}}