{"title":"lua发送http请求","uid":"b7c6831f3028f6e44410de8bafe4b5e2","slug":"zl/2016-01-01-1095_lua发送http请求","date":"2024-04-03T03:47:32.999Z","updated":"2024-04-03T03:47:32.999Z","comments":true,"path":"api/articles/zl/2016-01-01-1095_lua发送http请求.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","content":"<div id=\"toc\" class=\"toc-article\">\n    <strong class=\"toc-title\">文章目录</strong>\n<pre><code>&lt;/div&gt;\n\n\n&lt;h3 id=&quot;直接发送&quot;&gt;&lt;a href=&quot;#直接发送&quot; class=&quot;headerlink&quot; title=&quot;直接发送&quot;&gt;&lt;/a&gt;直接发送&lt;/h3&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;local http = require(&amp;#34;socket.http&amp;#34;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;local body = http.request(&amp;#34;http://x86.pub&amp;#34;);&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;print(body)&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/figure&gt;\n</code></pre>\n<h3 id=\"获取状态码\"><a href=\"#获取状态码\" class=\"headerlink\" title=\"获取状态码\"></a>获取状态码</h3><figure class=\"highlight plain\"><table><tbody><tr><td class=\"code\"><pre><div class=\"line\">local http = require(&#34;socket.http&#34;);</div><div class=\"line\">local body, code = http.request(&#34;http://x86.pub&#34;);</div><div class=\"line\">print(body)</div><div class=\"line\">print(code)</div></pre></td></tr></tbody></table></figure>\n<h3 id=\"获取-response-header\"><a href=\"#获取-response-header\" class=\"headerlink\" title=\"获取 response header\"></a>获取 response header</h3><figure class=\"highlight plain\"><table><tbody><tr><td class=\"code\"><pre><div class=\"line\">local http = require(&#34;socket.http&#34;);</div><div class=\"line\">local body, code, response_headers = http.request(&#34;http://x86.pub&#34;);</div><div class=\"line\">print_table(response_headers)</div></pre></td></tr></tbody></table></figure>\n<h3 id=\"自定义-http-请求\"><a href=\"#自定义-http-请求\" class=\"headerlink\" title=\"自定义 http 请求\"></a>自定义 http 请求</h3><figure class=\"highlight plain\"><table><tbody><tr><td class=\"code\"><pre><div class=\"line\">local http = require(&#34;socket.http&#34;)</div><div class=\"line\"></div><div class=\"line\">local request_body = [[login=user&amp;password=123]]</div><div class=\"line\">local response_body = {}</div><div class=\"line\">local res, code, response_headers = http.request {</div><div class=\"line\">    url = &#34;http://httpbin.org/post&#34;,</div><div class=\"line\">    method = &#34;POST&#34;,</div><div class=\"line\">    headers = {</div><div class=\"line\">        [&#34;Content-Type&#34;] = &#34;application/x-www-form-urlencoded&#34;;</div><div class=\"line\">        [&#34;Content-Length&#34;] = #request_body;</div><div class=\"line\">    },</div><div class=\"line\">    source = ltn12.source.string(request_body),</div><div class=\"line\">    sink = ltn12.sink.table(response_body),</div><div class=\"line\">}</div><div class=\"line\"></div><div class=\"line\">print(res)</div><div class=\"line\">print(code)</div><div class=\"line\"></div><div class=\"line\">if type(response_headers) == &#34;table&#34; then</div><div class=\"line\">  for k, v in pairs(response_headers) do</div><div class=\"line\">    print(k, v)</div><div class=\"line\">  end</div><div class=\"line\">end</div><div class=\"line\"></div><div class=\"line\">print(&#34;Response body:&#34;)</div><div class=\"line\">if type(response_body) == &#34;table&#34; then</div><div class=\"line\">    print(table.concat(response_body))</div><div class=\"line\">else</div><div class=\"line\">    print(&#34;Not a table:&#34;, type(response_body))</div><div class=\"line\">end</div></pre></td></tr></tbody></table></figure>","text":" 文章目录 &lt;/div&gt; &lt;h3 id=&quot;直接发送&quot;&gt;&lt;a href=&quot;#直接发送&quot; class=&quot;headerlink&quot; title=&quot;直接发送&quot;&gt;&lt;/a&...","link":"","photos":[],"count_time":{"symbolsCount":"1.7k","symbolsTime":"2 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E8%8E%B7%E5%8F%96%E7%8A%B6%E6%80%81%E7%A0%81\"><span class=\"toc-text\">获取状态码</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E8%8E%B7%E5%8F%96-response-header\"><span class=\"toc-text\">获取 response header</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E8%87%AA%E5%AE%9A%E4%B9%89-http-%E8%AF%B7%E6%B1%82\"><span class=\"toc-text\">自定义 http 请求</span></a></li></ol>","author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"lua将json字符串转为table","uid":"5b8e80b35ee9d3a7fdb8cfa65a2b88c6","slug":"zl/2016-01-01-1094_lua将json字符串转为table","date":"2024-04-03T03:47:32.999Z","updated":"2024-04-03T03:47:32.999Z","comments":true,"path":"api/articles/zl/2016-01-01-1094_lua将json字符串转为table.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":" 文章目录 &lt;/div&gt; &lt;h3 id=&quot;json字符串转为table&quot;&gt;&lt;a href=&quot;#json字符串转为table&quot; class=&quot;headerlink&quot; title=&quot;j...","link":"","photos":[],"count_time":{"symbolsCount":"1.3k","symbolsTime":"1 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"原理介绍","uid":"773d3c808ad0668c03faeb77cbc4cbfa","slug":"zl/2016-01-01-1091_[ulua]原理介绍","date":"2024-04-03T03:47:32.998Z","updated":"2024-04-03T03:47:32.998Z","comments":true,"path":"api/articles/zl/2016-01-01-1091_[ulua]原理介绍.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":" 目录详情 ","link":"","photos":[],"count_time":{"symbolsCount":39,"symbolsTime":"1 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}}}