{"title":"lua tutorial","uid":"afe3397b930037cfdd0a57af33e6bbca","slug":"zl/2016-01-01-1173_lua tutorial","date":"2024-04-03T03:47:33.024Z","updated":"2024-04-03T03:47:33.024Z","comments":true,"path":"api/articles/zl/2016-01-01-1173_lua tutorial.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","content":"<hr/>\n    <div id=\"content\">\n      <h2 id=\"what-is-lua-\">What is Lua ?</h2>\n<p><img src=\"https://wenchma.github.io//img/lua.png\" alt=\"\"/></p>\n<p>Lua is a powerful, efficient, lightweight, embeddable scripting language, 用标准C语言编写并以源代码形式开放， 其设计目的是为了嵌入应用程序中，从而为应用程序提供灵活的扩展和定制功能。\nLua 是巴西里约热内卢天主教大学（Pontifical Catholic University of Rio de Janeiro）里的一个研究小组，由Roberto Ierusalimschy、Waldemar Celes 和 Luiz Henrique de Figueiredo所组成并于1993年开发。</p>\n<p>Lua supports procedural programming, object-oriented programming, functional programming, data-driven programming, and data description.</p>\n<h2 id=\"installation\">Installation</h2>\n<div class=\"highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>curl -R -O http://www.lua.org/ftp/lua-5.3.3.tar.gz\ntar zxf lua-5.3.3.tar.gz\ncd lua-5.3.3\n# build Lua\nmake linux\n<h1 id=\"test-your-building\"><a class=\"markdownIt-Anchor\" href=\"#test-your-building\"></a> test your building</h1>\n<p>make test</p>\n<h1 id=\"if-ok\"><a class=\"markdownIt-Anchor\" href=\"#if-ok\"></a> if ok</h1>\n<p>$ sudo make install<br />\ncd src &amp;&amp; mkdir -p /usr/local/bin /usr/local/include /usr/local/lib /usr/local/man/man1 /usr/local/share/lua/5.1 /usr/local/lib/lua/5.1<br />\ncd src &amp;&amp; install -p -m 0755 lua luac /usr/local/bin<br />\ncd src &amp;&amp; install -p -m 0644 lua.h luaconf.h lualib.h lauxlib.h …/etc/lua.hpp /usr/local/include<br />\ncd src &amp;&amp; install -p -m 0644 liblua.a /usr/local/lib<br />\ncd doc &amp;&amp; install -p -m 0644 lua.1 luac.1 /usr/local/man/man1<br />\n$ lua -v<br />\nLua 5.1.5  Copyright © 1994-2012 <a href=\"http://Lua.org\">Lua.org</a>, PUC-Rio<br />\n</code></pre></div></div></p>\n<p>You can also install lua pkg management tool (like python pip, ruby gem):</p>\n<div class=\"highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>$ sudo apt-get install luarocks\n$ sudo luarocks install luasocket\nInstalling http://luarocks.org/repositories/rocks/luasocket-3.0rc1-2.src.rock...\nUsing http://luarocks.org/repositories/rocks/luasocket-3.0rc1-2.src.rock... switching to &#39;build&#39; mode\nArchive:  /tmp/luarocks_luarocks-rock-luasocket-3.0rc1-2-1445/luasocket-3.0rc1-2.src.rock\n  inflating: luasocket-3.0rc1-2.rockspec  \n extracting: v3.0-rc1.zip            \nArchive:  v3.0-rc1.zip\n</code></pre></div></div>\n<blockquote>\n  <p>Note: <code class=\"highlighter-rouge\">make xxx</code>, where xxx is your platform name. eg. linux, macosx, freebsd…</p>\n</blockquote>\n<h2 id=\"lua-tutorial\">Lua Tutorial</h2>\n<h3 id=\"lua-hello-world\">Lua Hello World</h3>\n<ol>\n  <li>Interactive mode:</li>\n</ol>\n<div class=\"highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>$ lua\nLua 5.1.5  Copyright (C) 1994-2012 Lua.org, PUC-Rio\n&gt; print(&#34;hello&#34;..&#34; world&#34;)\nhello world\n&gt;\n</code></pre></div></div>\n<ol>\n  <li>Lua scripts:</li>\n</ol>\n<div class=\"highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"cp\">#!/usr/local/bin/lua</span>\n<p><span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;Hello&quot;</span><span class=\"o\">…</span><span class=\"s2\">&quot; World！&quot;</span><span class=\"p\">)</span></p>\n<p><span class=\"err\">$</span> <span class=\"p\">.</span><span class=\"o\">/</span><span class=\"n\">test</span><span class=\"p\">.</span><span class=\"n\">lua</span><br />\n<span class=\"n\">Hello</span> <span class=\"n\">World</span><span class=\"err\">！</span></p>\n<p><span class=\"err\">$</span> <span class=\"n\">lua</span> <span class=\"n\">test</span><span class=\"p\">.</span><span class=\"n\">lua</span><br />\n<span class=\"n\">Hello</span> <span class=\"n\">World</span><span class=\"err\">！</span><br />\n</code></pre></div></div></p>\n<h3 id=\"example-http-request\">Example: Http Request</h3>\n<div class=\"highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"cp\">#!/usr/bin/env lua</span>\n<span class=\"kd\">local</span> <span class=\"n\">http</span><span class=\"o\">=</span><span class=\"nb\">require</span><span class=\"p\">(</span><span class=\"s2\">&#34;socket.http&#34;</span><span class=\"p\">)</span>\n<span class=\"kd\">local</span> <span class=\"n\">ltn12</span> <span class=\"o\">=</span> <span class=\"nb\">require</span><span class=\"p\">(</span><span class=\"s2\">&#34;ltn12&#34;</span><span class=\"p\">)</span>\n<p><span class=\"kd\">local</span> <span class=\"n\">request_body</span> <span class=\"o\">=</span> <span class=\"s\">[[login=admin&amp;password=pass]]</span><br />\n<span class=\"kd\">local</span> <span class=\"n\">response_body</span> <span class=\"o\">=</span> <span class=\"p\">&#123;&#125;</span><br />\n<span class=\"kd\">local</span> <span class=\"n\">path</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;/v1/users&quot;</span><br />\n<span class=\"kd\">local</span> <span class=\"n\">url</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;<a href=\"http://example.com\">http://example.com</a>&quot;</span><br />\n<span class=\"kd\">local</span> <span class=\"n\">token</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;&quot;</span></p>\n<p><span class=\"kd\">local</span> <span class=\"n\">res</span><span class=\"p\">,</span> <span class=\"n\">code</span><span class=\"p\">,</span> <span class=\"n\">response_headers</span> <span class=\"o\">=</span> <span class=\"n\">http</span><span class=\"p\">.</span><span class=\"n\">request</span><span class=\"p\">&#123;</span><br />\n<span class=\"n\">url</span> <span class=\"o\">=</span> <span class=\"nb\">string.format</span><span class=\"p\">(</span><span class=\"s2\">&quot;%s/%s&quot;</span><span class=\"p\">,</span> <span class=\"n\">url</span><span class=\"p\">,</span> <span class=\"n\">path</span><span class=\"p\">),</span><br />\n<span class=\"n\">method</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;GET&quot;</span><span class=\"p\">,</span><br />\n<span class=\"n\">headers</span> <span class=\"o\">=</span><br />\n<span class=\"p\">&#123;</span><br />\n<span class=\"p\">[</span><span class=\"s2\">&quot;Content-Type&quot;</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"s2\">&quot;application/x-www-form-urlencoded&quot;</span><span class=\"p\">;</span><br />\n<span class=\"p\">&#125;,</span><br />\n<span class=\"n\">source</span> <span class=\"o\">=</span> <span class=\"n\">ltn12</span><span class=\"p\">.</span><span class=\"n\">source</span><span class=\"p\">.</span><span class=\"n\">string</span><span class=\"p\">(</span><span class=\"n\">request_body</span><span class=\"p\">),</span><br />\n<span class=\"n\">sink</span> <span class=\"o\">=</span> <span class=\"n\">ltn12</span><span class=\"p\">.</span><span class=\"n\">sink</span><span class=\"p\">.</span><span class=\"n\">table</span><span class=\"p\">(</span><span class=\"n\">response_body</span><span class=\"p\">),</span><br />\n<span class=\"p\">&#125;</span></p>\n<p><span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">res</span><span class=\"p\">)</span><br />\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">code</span><span class=\"p\">)</span></p>\n<p><span class=\"k\">if</span> <span class=\"nb\">type</span><span class=\"p\">(</span><span class=\"n\">response_headers</span><span class=\"p\">)</span> <span class=\"o\">==</span> <span class=\"s2\">&quot;table&quot;</span> <span class=\"k\">then</span><br />\n<span class=\"k\">for</span> <span class=\"n\">k</span><span class=\"p\">,</span> <span class=\"n\">v</span> <span class=\"k\">in</span> <span class=\"nb\">pairs</span><span class=\"p\">(</span><span class=\"n\">response_headers</span><span class=\"p\">)</span> <span class=\"k\">do</span><br />\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"n\">k</span><span class=\"p\">,</span> <span class=\"n\">v</span><span class=\"p\">)</span><br />\n<span class=\"k\">end</span><br />\n<span class=\"k\">end</span></p>\n<p><span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;Response body:&quot;</span><span class=\"p\">)</span><br />\n<span class=\"k\">if</span> <span class=\"nb\">type</span><span class=\"p\">(</span><span class=\"n\">response_body</span><span class=\"p\">)</span> <span class=\"o\">==</span> <span class=\"s2\">&quot;table&quot;</span> <span class=\"k\">then</span><br />\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"nb\">table.concat</span><span class=\"p\">(</span><span class=\"n\">response_body</span><span class=\"p\">))</span><br />\n<span class=\"k\">else</span><br />\n<span class=\"nb\">print</span><span class=\"p\">(</span><span class=\"s2\">&quot;Not a table:&quot;</span><span class=\"p\">,</span> <span class=\"nb\">type</span><span class=\"p\">(</span><span class=\"n\">response_body</span><span class=\"p\">))</span><br />\n<span class=\"k\">end</span><br />\n</code></pre></div></div></p>\n<blockquote>\n  <p>Note: If for https request, you can use Lua ssl lib. <code class=\"highlighter-rouge\">require(&#34;ssl.https&#34;)</code>.\n  First, install Lua package manager: <code class=\"highlighter-rouge\">sudo apt-get install luarocks</code></p>\n</blockquote>\n<h3 id=\"trouble-shooting\">Trouble Shooting</h3>\n<p>If :</p>\n<div class=\"highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code># luarocks install luasec OPENSSL_LIBDIR=/usr/lib/x86_64-linux-gnu/\nWarning: Failed searching manifest: Failed extracting manifest file\nInstalling https://raw.githubusercontent.com/rocks-moonscript-org/moonrocks-mirror/master/luasec-0.6-1.rockspec...\nUsing https://raw.githubusercontent.com/rocks-moonscript-org/moonrocks-mirror/master/luasec-0.6-1.rockspec... switching to &#39;build&#39; mode\n<p>Error: Could not find expected file openssl/ssl.h, or openssl/ssl.h for OPENSSL – you may have to install OPENSSL in your system and/or pass OPENSSL_DIR<br />\nor OPENSSL_INCDIR to the luarocks command. Example: luarocks install luasec OPENSSL_DIR=/usr/local<br />\n</code></pre></div></div></p>\n<p>It means to install <code class=\"highlighter-rouge\">openssl</code> lib first. To install openssl:\n$ sudo apt-get install  openssl libssl-dev.\nthen,\n<code class=\"highlighter-rouge\">sudo luarocks install luasec OPENSSL_LIBDIR=/usr/lib/x86_64-linux-gnu/</code> or <code class=\"highlighter-rouge\">sudo luarocks install luasec</code>.</p>\n<h3 id=\"reference\">Reference</h3>\n<ul>\n  <li><a href=\"http://www.lua.org/manual/5.3/\">Lua 5.3 Manual</a></li>\n  <li><a href=\"http://www.runoob.com/lua/lua-tutorial.html\">Lua Tutorial</a></li>\n</ul>\n<pre><code>&lt;/div&gt;\n&lt;hr/&gt;\n</code></pre>\n","text":" What is Lua ? Lua is a powerful, efficient, lightweight, embeddable scripting language, 用标准C语言编写并以源代码形式开放， 其设计目的是为了嵌入应用程序中，从而为应用程序提供灵活的扩展和定...","link":"","photos":[],"count_time":{"symbolsCount":"4.1k","symbolsTime":"4 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#what-is-lua-\"><span class=\"toc-text\">What is Lua ?</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#installation\"><span class=\"toc-text\">Installation</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#test-your-building\"><span class=\"toc-text\"> test your building</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#if-ok\"><span class=\"toc-text\"> if ok</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#lua-tutorial\"><span class=\"toc-text\">Lua Tutorial</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#lua-hello-world\"><span class=\"toc-text\">Lua Hello World</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#example-http-request\"><span class=\"toc-text\">Example: Http Request</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#trouble-shooting\"><span class=\"toc-text\">Trouble Shooting</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#reference\"><span class=\"toc-text\">Reference</span></a></li></ol></li></ol>","author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"lua non-preemptive multithreading","uid":"4209e3efeb07621725054217d1ce7edf","slug":"zl/2016-01-01-1172_lua non-preemptive multithreading","date":"2024-04-03T03:47:33.024Z","updated":"2024-04-03T03:47:33.024Z","comments":true,"path":"api/articles/zl/2016-01-01-1172_lua non-preemptive multithreading.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":" Lua Coroutine Lua Coroutine is a kind of collaborative multithreading, equivalent to a thread. A pair yield-resume switches control from on...","link":"","photos":[],"count_time":{"symbolsCount":"6.9k","symbolsTime":"6 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"centos 安装lua 5.3","uid":"c14714e77bf71d580501b56af7e47eb7","slug":"zl/2016-01-01-1174_centos 安装lua 5.3","date":"2024-04-03T03:47:33.024Z","updated":"2024-04-03T03:47:33.024Z","comments":true,"path":"api/articles/zl/2016-01-01-1174_centos 安装lua 5.3.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":"按照官网教程，执行以下命令1234curl -R -O http://www.lua.org/ftp/lua-5.3.3.tar.gztar zxf lua-5.3.3.tar.gzcd lua-5.3.3make linux test 但其实lua并未安装，许多博文都是建立软链...","link":"","photos":[],"count_time":{"symbolsCount":367,"symbolsTime":"1 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}}}