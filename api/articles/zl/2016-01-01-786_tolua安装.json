{"title":"tolua++安装","uid":"0f6d71b477132b063b4c2ff5fbac2c35","slug":"zl/2016-01-01-786_tolua安装","date":"2024-04-03T03:47:36.024Z","updated":"2024-04-03T03:47:36.025Z","comments":true,"path":"api/articles/zl/2016-01-01-786_tolua安装.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","content":"<div class=\"post-nav\">\n          <div class=\"post-nav-next post-nav-item\">\n<pre><code>          &lt;a href=&quot;/2015/11/11/lua_cpp_bind/&quot; rel=&quot;next&quot; title=&quot;C++与Lua本质原始交互API&quot;&gt;\n            &lt;i class=&quot;fa fa-chevron-left&quot;&gt;&lt;/i&gt; \n            &lt;p class=&quot;post-nav-pre-next-title&quot;&gt;\n              C++与Lua本质原始交互API\n            &lt;/p&gt; \n          &lt;/a&gt;\n        \n      &lt;/div&gt;\n\n      &lt;span class=&quot;post-nav-divider&quot;&gt;&lt;/span&gt;\n\n      &lt;div class=&quot;post-nav-prev post-nav-item&quot;&gt;\n        \n          &lt;a href=&quot;/2015/11/11/lua_pairs_ipairs/&quot; rel=&quot;prev&quot; title=&quot;Lua中ipairs和pairs的区别与使用&quot;&gt;\n          &lt;p class=&quot;post-nav-pre-next-title&quot;&gt;\n              Lua中ipairs和pairs的区别与使用\n          &lt;/p&gt; \n          &lt;i class=&quot;fa fa-chevron-right&quot;&gt;&lt;/i&gt;\n          &lt;/a&gt;\n        \n      &lt;/div&gt;\n    &lt;/div&gt;\n  \n\n  \n  \n\n  \n  \n\n  \n    &lt;p&gt;我们用一个例子来说明.&lt;/p&gt;\n</code></pre>\n<p>本文环境为 : </p>\n<ul>\n<li>ubuntu1404</li>\n<li>g++ 4.8.4</li>\n<li>python</li>\n<li>git</li>\n<li>lua5.1( 因为tolua++只支持到5.1, 安装5.1教程看 <a href=\"/2015/11/08/lua_install_tutorial/\" title=\"Lua的win和linux环境简单安装\">Lua的win和linux环境简单安装</a> )</li>\n</ul>\n<p><strong>. . .</strong></p>\n<p>1. git clone <a href=\"mailto:git@github.com\" target=\"_blank\" rel=\"noopener noreferrer\">git@github.com</a>:LuaDist/toluapp.git<br/>2. sudo apt-get install scons<br/>3. cd toluapp/</p>\n<p>4. vi custom.py  然后添加内容 : </p>\n<figure class=\"highlight python\"><figcaption><span>custom.py</span></figcaption><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/><span class=\"line\">5</span><br/><span class=\"line\">6</span><br/><span class=\"line\">7</span><br/><span class=\"line\">8</span><br/><span class=\"line\">9</span><br/><span class=\"line\">10</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br/><span class=\"line\">CCFLAGS = [<span class=\"string\">&#39;-I/usr/include/lua5.1&#39;</span>, <span class=\"string\">&#39;-O2&#39;</span>, <span class=\"string\">&#39;-ansi&#39;</span>]</span><br/><span class=\"line\"><span class=\"comment\"># 自己通过命令 sudo find / -name &#34;*liblua*&#34; 来查静态库.a文件在哪, 然后把路径填到下面</span></span><br/><span class=\"line\">LIBPATH = [<span class=\"string\">&#39;/usr/lib/x86_64-linux-gnu&#39;</span>]</span><br/><span class=\"line\">LIBS = [<span class=\"string\">&#39;lua5.1&#39;</span>, <span class=\"string\">&#39;dl&#39;</span>, <span class=\"string\">&#39;m&#39;</span>]</span><br/><span class=\"line\"><span class=\"comment\">#prefix = &#39;/mingw&#39;</span></span><br/><span class=\"line\"><span class=\"comment\">#build_dev=1</span></span><br/><span class=\"line\">tolua_bin = <span class=\"string\">&#39;tolua++5.1&#39;</span></span><br/><span class=\"line\">tolua_lib = <span class=\"string\">&#39;tolua++5.1&#39;</span></span><br/><span class=\"line\">TOLUAPP = <span class=\"string\">&#39;tolua++5.1&#39;</span></span><br/></pre></td></tr></tbody></table></figure>\n<p>5. scons all<br/>6. scons install</p>\n<h1 id=\"测试\"><a href=\"#测试\" class=\"headerlink\" title=\"测试\"></a>测试</h1><p>用以下五个文件测试, 输入命令 : </p>\n<p>1. tolua++5.1 -o lua_Student.cpp Student.pkg<br/>2. g++ *.cpp -I/usr/include/lua5.1 -llua5.1 -lm -ltolua++5.1<br/>3. 如果执行 <code>./a.out</code> 之后, 打印结果如下则为环境全部安装成功 : </p>\n<pre><code>1\n2\n3\n4\n5\n6\n7\n8\n9\n10\nStudent Run\nStudent Run10\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\nStudent Run\nStudent Run10\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\nStudent Run\nStudent Run10\n...</code></pre><h2 id=\"五个测试文件\"><a href=\"#五个测试文件\" class=\"headerlink\" title=\"五个测试文件\"></a>五个测试文件</h2><figure class=\"highlight c++\"><figcaption><span>Student.h</span></figcaption><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/><span class=\"line\">5</span><br/><span class=\"line\">6</span><br/><span class=\"line\">7</span><br/><span class=\"line\">8</span><br/><span class=\"line\">9</span><br/><span class=\"line\">10</span><br/><span class=\"line\">11</span><br/><span class=\"line\">12</span><br/><span class=\"line\">13</span><br/><span class=\"line\">14</span><br/><span class=\"line\">15</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br/><span class=\"line\"> </span><br/><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;iostream&gt;</span></span></span><br/><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> <span class=\"built_in\">std</span>;</span><br/><span class=\"line\"> </span><br/><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> </span></span><br/><span class=\"line\"><span class=\"class\">{</span></span><br/><span class=\"line\"><span class=\"keyword\">public</span>:</span><br/><span class=\"line\">\tStudent();</span><br/><span class=\"line\">\t~Student();</span><br/><span class=\"line\"> </span><br/><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">Run</span><span class=\"params\">()</span></span>;</span><br/><span class=\"line\"> </span><br/><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">Run</span><span class=\"params\">(<span class=\"keyword\">int</span> a)</span></span>;</span><br/><span class=\"line\">};</span><br/></pre></td></tr></tbody></table></figure>\n<figure class=\"highlight c++\"><figcaption><span>Student.cpp</span></figcaption><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/><span class=\"line\">5</span><br/><span class=\"line\">6</span><br/><span class=\"line\">7</span><br/><span class=\"line\">8</span><br/><span class=\"line\">9</span><br/><span class=\"line\">10</span><br/><span class=\"line\">11</span><br/><span class=\"line\">12</span><br/><span class=\"line\">13</span><br/><span class=\"line\">14</span><br/><span class=\"line\">15</span><br/><span class=\"line\">16</span><br/><span class=\"line\">17</span><br/><span class=\"line\">18</span><br/><span class=\"line\">19</span><br/><span class=\"line\">20</span><br/><span class=\"line\">21</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br/><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&#34;Student.h&#34;</span></span></span><br/><span class=\"line\"> </span><br/><span class=\"line\"> </span><br/><span class=\"line\">Student::Student()</span><br/><span class=\"line\">{</span><br/><span class=\"line\">}</span><br/><span class=\"line\"> </span><br/><span class=\"line\"><span class=\"keyword\">void</span> Student::Run()</span><br/><span class=\"line\">{</span><br/><span class=\"line\">\t<span class=\"built_in\">cout</span> &lt;&lt; <span class=\"string\">&#34;Student Run&#34;</span> &lt;&lt; <span class=\"built_in\">endl</span>;</span><br/><span class=\"line\">}</span><br/><span class=\"line\"> </span><br/><span class=\"line\"><span class=\"keyword\">void</span> Student::Run(<span class=\"keyword\">int</span> a)</span><br/><span class=\"line\">{</span><br/><span class=\"line\">\t<span class=\"built_in\">cout</span> &lt;&lt; <span class=\"string\">&#34;Student Run&#34;</span> &lt;&lt;a&lt;&lt; <span class=\"built_in\">endl</span>;</span><br/><span class=\"line\">}</span><br/><span class=\"line\"> </span><br/><span class=\"line\">Student::~Student()</span><br/><span class=\"line\">{</span><br/><span class=\"line\">}</span><br/></pre></td></tr></tbody></table></figure>\n<figure class=\"highlight plain\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/><span class=\"line\">5</span><br/><span class=\"line\">6</span><br/><span class=\"line\">7</span><br/><span class=\"line\">8</span><br/><span class=\"line\">9</span><br/><span class=\"line\">10</span><br/><span class=\"line\">11</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\">$#include&#34;Student.h&#34;</span><br/><span class=\"line\"> </span><br/><span class=\"line\">class Student</span><br/><span class=\"line\">{</span><br/><span class=\"line\">public:</span><br/><span class=\"line\">\tStudent();</span><br/><span class=\"line\">\t~Student();</span><br/><span class=\"line\"> </span><br/><span class=\"line\">\tvoid Run();</span><br/><span class=\"line\">\tvoid Run @ Run2(int a);</span><br/><span class=\"line\">};</span><br/></pre></td></tr></tbody></table></figure>\n<figure class=\"highlight lua\"><figcaption><span>test.lua</span></figcaption><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/><span class=\"line\">5</span><br/><span class=\"line\">6</span><br/><span class=\"line\">7</span><br/><span class=\"line\">8</span><br/><span class=\"line\">9</span><br/><span class=\"line\">10</span><br/><span class=\"line\">11</span><br/><span class=\"line\">12</span><br/><span class=\"line\">13</span><br/><span class=\"line\">14</span><br/><span class=\"line\">15</span><br/><span class=\"line\">16</span><br/><span class=\"line\">17</span><br/><span class=\"line\">18</span><br/><span class=\"line\">19</span><br/><span class=\"line\">20</span><br/><span class=\"line\">21</span><br/><span class=\"line\">22</span><br/><span class=\"line\">23</span><br/><span class=\"line\">24</span><br/><span class=\"line\">25</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br/><span class=\"line\">studentB=Student:new() <span class=\"comment\">--实例化Student全局对象</span></span><br/><span class=\"line\"> </span><br/><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Run</span><span class=\"params\">()</span></span></span><br/><span class=\"line\">\tstudentB:Run();</span><br/><span class=\"line\"><span class=\"keyword\">end</span></span><br/><span class=\"line\"> </span><br/><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">Run2</span><span class=\"params\">(a)</span></span></span><br/><span class=\"line\">\tstudentB:Run2(a);</span><br/><span class=\"line\"><span class=\"keyword\">end</span></span><br/><span class=\"line\"> </span><br/><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">show</span><span class=\"params\">()</span></span>  </span><br/><span class=\"line\">\t<span class=\"keyword\">local</span> b = {}  </span><br/><span class=\"line\">\t<span class=\"keyword\">local</span> index  </span><br/><span class=\"line\">\t  </span><br/><span class=\"line\">\t<span class=\"keyword\">for</span> index = <span class=\"number\">1</span>,<span class=\"number\">10</span>,<span class=\"number\">1</span> <span class=\"keyword\">do</span>  </span><br/><span class=\"line\">\t\t<span class=\"built_in\">print</span>(index)  </span><br/><span class=\"line\">\t<span class=\"keyword\">end</span>  </span><br/><span class=\"line\"><span class=\"keyword\">end</span>  </span><br/><span class=\"line\">  </span><br/><span class=\"line\">show()  </span><br/><span class=\"line\"> </span><br/><span class=\"line\">Run()</span><br/><span class=\"line\"> </span><br/><span class=\"line\">Run2(<span class=\"number\">10</span>)</span><br/></pre></td></tr></tbody></table></figure>\n<figure class=\"highlight c++\"><figcaption><span>main.cpp</span></figcaption><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/><span class=\"line\">5</span><br/><span class=\"line\">6</span><br/><span class=\"line\">7</span><br/><span class=\"line\">8</span><br/><span class=\"line\">9</span><br/><span class=\"line\">10</span><br/><span class=\"line\">11</span><br/><span class=\"line\">12</span><br/><span class=\"line\">13</span><br/><span class=\"line\">14</span><br/><span class=\"line\">15</span><br/><span class=\"line\">16</span><br/><span class=\"line\">17</span><br/><span class=\"line\">18</span><br/><span class=\"line\">19</span><br/><span class=\"line\">20</span><br/><span class=\"line\">21</span><br/><span class=\"line\">22</span><br/><span class=\"line\">23</span><br/><span class=\"line\">24</span><br/><span class=\"line\">25</span><br/><span class=\"line\">26</span><br/><span class=\"line\">27</span><br/><span class=\"line\">28</span><br/><span class=\"line\">29</span><br/><span class=\"line\">30</span><br/><span class=\"line\">31</span><br/><span class=\"line\">32</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;stdio.h&gt;</span></span></span><br/><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;unistd.h&gt;</span></span></span><br/><span class=\"line\"></span><br/><span class=\"line\"><span class=\"keyword\">extern</span> <span class=\"string\">&#34;C&#34;</span></span><br/><span class=\"line\">{</span><br/><span class=\"line\">        <span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&#34;lua.h&#34;</span></span></span><br/><span class=\"line\">        <span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&#34;lualib.h&#34;</span></span></span><br/><span class=\"line\">        <span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&#34;lauxlib.h&#34;</span></span></span><br/><span class=\"line\">        <span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&#34;luaconf.h&#34;</span></span></span><br/><span class=\"line\">}</span><br/><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&#34;tolua++.h&#34;</span></span></span><br/><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&#34;Student.h&#34;</span></span></span><br/><span class=\"line\"></span><br/><span class=\"line\"><span class=\"function\"><span class=\"keyword\">extern</span> <span class=\"keyword\">int</span> <span class=\"title\">tolua_Student_open</span><span class=\"params\">(lua_State* tolua_S)</span></span>;</span><br/><span class=\"line\"></span><br/><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span>* argv[])</span></span></span><br/><span class=\"line\"><span class=\"function\"></span>{</span><br/><span class=\"line\"></span><br/><span class=\"line\">        <span class=\"keyword\">while</span>(<span class=\"number\">1</span>)</span><br/><span class=\"line\">        {</span><br/><span class=\"line\">            sleep(<span class=\"number\">2</span>);</span><br/><span class=\"line\"></span><br/><span class=\"line\">            lua_State* L = luaL_newstate();</span><br/><span class=\"line\">            luaL_openlibs(L);</span><br/><span class=\"line\"></span><br/><span class=\"line\">            tolua_Student_open(L);</span><br/><span class=\"line\"></span><br/><span class=\"line\">            luaL_dofile(L, <span class=\"string\">&#34;./test.lua&#34;</span>);</span><br/><span class=\"line\">            lua_close(L);</span><br/><span class=\"line\">        }</span><br/><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br/><span class=\"line\">}</span><br/></pre></td></tr></tbody></table></figure>\n<p><strong>在运行的时候</strong>把test.lua文件的<code>Run2(10)</code> 改为 <code>Run2(99)</code> 之后,<br/>打印也会跟着变为 : </p>\n<pre><code>1\n2\n3\n4\n5\n6\n7\n8\n9\n10\nStudent Run\nStudent Run10\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\nStudent Run\nStudent Run99\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\nStudent Run\nStudent Run99\n...</code></pre>","text":" &lt;a href=&quot;/2015/11/11/lua_cpp_bind/&quot; rel=&quot;next&quot; title=&quot;C++与Lua本质原始交互API&quot;&gt; &lt;i class=&quot;fa fa-chevro...","link":"","photos":[],"count_time":{"symbolsCount":"3.6k","symbolsTime":"3 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E6%B5%8B%E8%AF%95\"><span class=\"toc-text\">测试</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%BA%94%E4%B8%AA%E6%B5%8B%E8%AF%95%E6%96%87%E4%BB%B6\"><span class=\"toc-text\">五个测试文件</span></a></li></ol></li></ol>","author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"lua之运算符","uid":"1e80f66d3215934d26ab06a86f32143c","slug":"zl/2016-01-01-785_lua之运算符","date":"2024-04-03T03:47:36.024Z","updated":"2024-04-03T03:47:36.024Z","comments":true,"path":"api/articles/zl/2016-01-01-785_lua之运算符.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":"lua运算符 算术运算符 +，-，*（乘），/（除），%（取余），^(乘幂)，-（负号） 关系运算符 ==（等于），~=（不等于），&gt;，&lt;，&gt;=，&lt;= 逻辑运算符 and，or，not 其它运算符 ..（连接符），#（一元运算符，返回字符串或表的长度） 运...","link":"","photos":[],"count_time":{"symbolsCount":448,"symbolsTime":"1 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"Lua","uid":"15b0cdc6d03f6c3f6bf8d3a7ff197317","slug":"zl/2016-01-01-784_Lua","date":"2024-04-03T03:47:36.023Z","updated":"2024-04-03T03:47:36.024Z","comments":true,"path":"api/articles/zl/2016-01-01-784_Lua.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":"table 操作 函数 解释 table.concat (table [, step [, start [, end]]]) 函数列出参数中指定table的数组部分从start位置到end位置的所有元素, 元素间以指定的分隔符(step)隔开 table.insert (tabl...","link":"","photos":[],"count_time":{"symbolsCount":"2.5k","symbolsTime":"2 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}}}