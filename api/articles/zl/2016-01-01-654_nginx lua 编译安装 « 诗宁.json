{"title":"nginx lua 编译安装 « 诗宁","uid":"47d85599ba5132364a2046c6149d4ae7","slug":"zl/2016-01-01-654_nginx lua 编译安装 « 诗宁","date":"2024-04-03T03:47:35.876Z","updated":"2024-04-03T03:47:35.877Z","comments":true,"path":"api/articles/zl/2016-01-01-654_nginx lua 编译安装 « 诗宁.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","content":"<ul id=\"markdown-toc\">\n  <li><a href=\"#编译安装脚本\" id=\"markdown-toc-编译安装脚本\">编译安装脚本</a></li>\n  <li><a href=\"#主配置文件\" id=\"markdown-toc-主配置文件\">主配置文件</a></li>\n  <li><a href=\"#systemd启动配置\" id=\"markdown-toc-systemd启动配置\">systemd启动配置</a></li>\n  <li><a href=\"#启动脚本\" id=\"markdown-toc-启动脚本\">启动脚本</a></li>\n</ul>\n<h2 id=\"编译安装脚本\">编译安装脚本</h2>\n<blockquote>\n  <p>nginx-lua-build.sh</p>\n</blockquote>\n<div class=\"highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c\">#!/bin/bash</span>\n<span class=\"c\">#Date:2018-09-03</span>\n<span class=\"c\">#Written by magic5650.</span>\n<span class=\"c\">#Readme:install nginx + lua.</span>\n<p><span class=\"c\">#step 0</span><br />\nmkdir /usr/local/nginx<br />\nmkdir nginx_lua_build</p>\n<p><span class=\"c\">#step 1</span><br />\nwget <span class=\"nt\">-q</span> <a href=\"http://nginx.org/download/nginx-1.13.6.tar.gz\">http://nginx.org/download/nginx-1.13.6.tar.gz</a><br />\n<span class=\"nb\">tar </span>xf nginx-1.13.6.tar.gz</p>\n<p><span class=\"c\">#step 2</span><br />\nwget <span class=\"nt\">-q</span> <a href=\"https://www.openssl.org/source/openssl-1.1.0i.tar.gz\">https://www.openssl.org/source/openssl-1.1.0i.tar.gz</a><br />\n<span class=\"nb\">tar </span>xf openssl-1.1.0i.tar.gz</p>\n<p>wget <span class=\"nt\">-q</span> <a href=\"https://sourceforge.mirrorservice.org/p/pc/pcre/pcre/8.38/pcre-8.38.tar.gz\">https://sourceforge.mirrorservice.org/p/pc/pcre/pcre/8.38/pcre-8.38.tar.gz</a><br />\n<span class=\"nb\">tar </span>xf pcre-8.38.tar.gz</p>\n<p>wget <span class=\"nt\">-q</span> <a href=\"https://nchc.dl.sourceforge.net/project/libpng/zlib/1.2.11/zlib-1.2.11.tar.gz\">https://nchc.dl.sourceforge.net/project/libpng/zlib/1.2.11/zlib-1.2.11.tar.gz</a><br />\n<span class=\"nb\">tar </span>xf zlib-1.2.11.tar.gz</p>\n<p><span class=\"c\">#step 3</span><br />\nwget <span class=\"nt\">-q</span> <a href=\"http://luajit.org/download/LuaJIT-2.1.0-beta3.zip\">http://luajit.org/download/LuaJIT-2.1.0-beta3.zip</a><br />\nunzip LuaJIT-2.1.0-beta3.zip <span class=\"o\">&gt;&gt;</span> /dev/null<br />\n<span class=\"nb\">cd </span>LuaJIT-2.1.0-beta3<br />\n<span class=\"c\">#modify Makefile</span><br />\nsed <span class=\"nt\">-i</span> <span class=\"s1\">'/^export PREFIX=/s//usr/local//usr/local/nginx/luajit-2.1.0/'</span> Makefile<br />\nmake<br />\nmake install <span class=\"nv\">PREFIX</span><span class=\"o\">=</span>/usr/local/nginx/luajit-2.1.0<br />\nln <span class=\"nt\">-sf</span> /usr/local/nginx/luajit-2.1.0/bin/luajit-2.1.0-beta3 /usr/local/nginx/luajit-2.1.0/bin/luajit<br />\n/usr/local/nginx/luajit-2.1.0/bin/luajit <span class=\"nt\">-e</span> <span class=\"s2\">&quot;print(package.cpath)&quot;</span> | sed <span class=\"nt\">-n</span> <span class=\"s1\">'s/;/;n/gp'</span><br />\n<span class=\"nb\">cd</span> -</p>\n<p><span class=\"c\">#step 4</span><br />\nwget <span class=\"nt\">-q</span> <a href=\"https://github.com/simplresty/ngx_devel_kit/archive/v0.3.1rc1.tar.gz\">https://github.com/simplresty/ngx_devel_kit/archive/v0.3.1rc1.tar.gz</a><br />\n<span class=\"nb\">tar </span>xf v0.3.1rc1.tar.gz</p>\n<p>git clone <a href=\"https://github.com/openresty/lua-nginx-module.git\">https://github.com/openresty/lua-nginx-module.git</a><br />\nmv lua-nginx-module lua-nginx-module-0.10.14</p>\n<p>wget <span class=\"nt\">-q</span> <a href=\"https://github.com/openresty/stream-lua-nginx-module/archive/v0.0.5.tar.gz\">https://github.com/openresty/stream-lua-nginx-module/archive/v0.0.5.tar.gz</a><br />\n<span class=\"nb\">tar </span>xf v0.0.5.tar.gz</p>\n<p>git clone <a href=\"https://github.com/wdaike/ngx_upstream_jdomain.git\">https://github.com/wdaike/ngx_upstream_jdomain.git</a></p>\n<p><span class=\"c\">#step 5</span><br />\n<span class=\"nb\">cd </span>nginx-1.13.6<br />\n<span class=\"nb\">export </span><span class=\"nv\">LUAJIT_LIB</span><span class=\"o\">=</span>/usr/local/nginx/luajit-2.1.0/lib<br />\n<span class=\"nb\">export </span><span class=\"nv\">LUAJIT_INC</span><span class=\"o\">=</span>/usr/local/nginx/luajit-2.1.0/include/luajit-2.1</p>\n<p>./configure <span class=\"se\"></span><br />\n<span class=\"nt\">–prefix</span><span class=\"o\">=</span>/usr/local/nginx <span class=\"se\"></span><br />\n<span class=\"nt\">–with-file-aio</span> <span class=\"se\"></span><br />\n<span class=\"nt\">–with-http_v2_module</span> <span class=\"se\"></span><br />\n<span class=\"nt\">–with-http_dav_module</span> <span class=\"se\"></span><br />\n<span class=\"nt\">–with-http_realip_module</span> <span class=\"se\"></span><br />\n<span class=\"nt\">–with-http_flv_module</span> <span class=\"se\"></span><br />\n<span class=\"nt\">–with-http_mp4_module</span> <span class=\"se\"></span><br />\n<span class=\"nt\">–with-http_sub_module</span> <span class=\"se\"></span><br />\n<span class=\"nt\">–with-http_stub_status_module</span> <span class=\"se\"></span><br />\n<span class=\"nt\">–with-http_gzip_static_module</span> <span class=\"se\"></span><br />\n<span class=\"nt\">–with-http_ssl_module</span> <span class=\"se\"></span><br />\n<span class=\"nt\">–with-openssl</span><span class=\"o\">=</span>…/openssl-1.1.0i <span class=\"se\"></span><br />\n<span class=\"nt\">–with-zlib</span><span class=\"o\">=</span>…/zlib-1.2.11 <span class=\"se\"></span><br />\n<span class=\"nt\">–with-pcre</span><span class=\"o\">=</span>…/pcre-8.38 <span class=\"se\"></span><br />\n<span class=\"nt\">–with-pcre-jit</span> <span class=\"se\"></span><br />\n<span class=\"nt\">–with-stream</span> <span class=\"se\"></span><br />\n<span class=\"nt\">–with-stream_ssl_module</span> <span class=\"se\"></span><br />\n<span class=\"nt\">–with-ld-opt</span><span class=\"o\">=</span><span class=\"nt\">-Wl</span>,-rpath,/usr/local/nginx/luajit-2.1.0/lib <span class=\"se\"></span><br />\n<span class=\"nt\">–add-module</span><span class=\"o\">=</span>…/ngx_devel_kit-0.3.1rc1 <span class=\"se\"></span><br />\n<span class=\"nt\">–add-module</span><span class=\"o\">=</span>…/lua-nginx-module-0.10.14 <span class=\"se\"></span><br />\n<span class=\"nt\">–add-module</span><span class=\"o\">=</span>…/stream-lua-nginx-module-0.0.5 <span class=\"se\"></span><br />\n<span class=\"nt\">–add-module</span><span class=\"o\">=</span>…/ngx_upstream_jdomain</p>\n<p>make <span class=\"nt\">-j2</span><br />\nmake install</p>\n<p><span class=\"c\">#step 6</span><br />\n<span class=\"nb\">cd</span> -<br />\ngit clone <a href=\"https://github.com/openresty/lua-cjson.git\">https://github.com/openresty/lua-cjson.git</a><br />\n<span class=\"nb\">cd </span>lua-cjson<br />\nmake<br />\nmake install <span class=\"nv\">LUA_CMODULE_DIR</span><span class=\"o\">=</span>/usr/local/nginx/luajit-2.1.0/lib/lua/5.1 <span class=\"nv\">LUA_INCLUDE_DIR</span><span class=\"o\">=</span>/usr/local/nginx/luajit-2.1.0/include/luajit-2.1<br />\n<span class=\"nb\">ls</span> <span class=\"nt\">-l</span> /usr/local/nginx/luajit-2.1.0/lib/lua/5.1/cjson.so<br />\n<span class=\"nb\">cd</span> -</p>\n<p><span class=\"c\">#step 7</span><br />\ngit clone <a href=\"https://github.com/openresty/lua-resty-core\">https://github.com/openresty/lua-resty-core</a><br />\ngit clone <a href=\"https://github.com/openresty/lua-resty-lrucache\">https://github.com/openresty/lua-resty-lrucache</a><br />\ngit clone <a href=\"https://github.com/openresty/lua-resty-limit-traffic\">https://github.com/openresty/lua-resty-limit-traffic</a></p>\n<p>mkdir /usr/local/nginx/lualib/<br />\n<span class=\"nb\">cd </span>lua-resty-core/lib<br />\ncp <span class=\"nt\">-r</span> <span class=\"nb\">.</span> /usr/local/nginx/lualib/<br />\ntree <span class=\"nt\">-L</span> 2 /usr/local/nginx/lualib<br />\n<span class=\"nb\">cd</span> -<br />\n<span class=\"nb\">cd </span>lua-resty-lrucache/lib<br />\ncp <span class=\"nt\">-r</span> <span class=\"nb\">.</span> /usr/local/nginx/lualib/<br />\ntree <span class=\"nt\">-L</span> 2 /usr/local/nginx/lualib<br />\n<span class=\"nb\">cd</span> -<br />\n<span class=\"nb\">cd </span>lua-resty-limit-traffic/lib<br />\ncp <span class=\"nt\">-r</span> <span class=\"nb\">.</span> /usr/local/nginx/lualib/<br />\ntree <span class=\"nt\">-L</span> 2 /usr/local/nginx/lualib<br />\n<span class=\"nb\">cd</span> -</p>\n<p><span class=\"c\">#at last</span><br />\n<span class=\"nb\">cd</span> /usr/local/nginx<br />\ntree <span class=\"nt\">-L</span> 2<br />\n/usr/local/nginx/sbin/nginx <span class=\"nt\">-V</span><br />\n</code></pre></div></div></p>\n<p>查看</p>\n<blockquote>\n  <p>/usr/local/nginx/sbin/nginx -V</p>\n</blockquote>\n<div class=\"highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>nginx version: nginx/1.13.6\nbuilt by gcc 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.10) \nbuilt with OpenSSL 1.1.0i  14 Aug 2018\nTLS SNI support enabled\nconfigure arguments: --prefix=/usr/local/nginx --with-file-aio --with-http_v2_module --with-http_dav_module --with-http_realip_module --with-http_flv_module --with-http_mp4_module --with-http_sub_module --with-http_stub_status_module --with-http_gzip_static_module --with-http_ssl_module --with-openssl=../openssl-1.1.0i --with-zlib=../zlib-1.2.11 --with-pcre=../pcre-8.38 --with-pcre-jit --with-stream --with-stream_ssl_module --with-ld-opt=-Wl,-rpath,/usr/local/nginx/luajit-2.1.0/lib --add-module=../ngx_devel_kit-0.3.1rc1 --add-module=../lua-nginx-module-0.10.14 --add-module=../stream-lua-nginx-module-0.0.5 --add-module=../ngx_upstream_jdomain\n</code></pre></div></div>\n<h2 id=\"主配置文件\">主配置文件</h2>\n<blockquote>\n  <p>nginx.conf</p>\n</blockquote>\n<div class=\"highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>user www-data;\nworker_processes 4;\nworker_rlimit_nofile 262140;\nerror_log  logs/error.log warn;\npid  run/nginx.pid; #需跟nginx.service里面定义一致\n<p>events<br />\n&#123;<br />\nuse epoll;<br />\nworker_connections  65535;<br />\n&#125;</p>\n<p>http<br />\n&#123;<br />\ninclude mime.types;<br />\ndefault_type application/octet-stream;<br />\n# Update charset_types due to updated mime.types<br />\ncharset_types text/xml text/plain text/vnd.wap.wml application/x-javascript application/rss+xml text/css application/javascript application/json;</p>\n<pre><code>sendfile on;\naio on;\ndirectio 512;\noutput_buffers 1 128k;\nlog_not_found off;\nkeepalive_timeout  60;\nserver_tokens off;\n\n# Compression\ngzip on;\n\n# Setup gzip http version 1.0 \ngzip_http_version 1.0;\n\n# Disable gzip compression for IE6, because IE6 supports gzip not friendly.\ngzip_disable     &amp;#34;MSIE [1-6].(?!.*SV1)&amp;#34;;\n\n# Compression level (1-9).\n# 5 is a perfect compromise between size and cpu usage, offering about\n# 75% reduction for most ascii files (almost identical to level 9).\ngzip_comp_level 5;\n\n# Don’t compress anything that’s already small and unlikely to shrink much\n# if at all (the default is 20 bytes, which is bad as that usually leads to\n# larger files after gzipping).\ngzip_min_length  1k;\ngzip_buffers     4 8k;\n\n# Compress data even for clients that are connecting to us via proxies\n# identified by the “Via” header (required for CloudFront).\ngzip_proxied any;\n\n# Tell proxies to cache both the gzipped and regular version of a resource\n# whenever the client’s Accept-Encoding capabilities header varies;\n# Avoids the issue where a non-gzip capable client (which is extremely rare\n# today) would display gibberish if their proxy gave them the gzipped version.\ngzip_vary on;\n\n# Compress all output labeled with one of the following MIME-types.\ngzip_types application/atom+xml application/javascript application/json application/rss+xml application/vnd.ms-fontobject application/x-font-ttf application/x-web-app-manifest+json application/xhtml+xml application/xml font/opentype image/svg+xml image/x-icon text/css text/plain text/x-component;\n# text/html is always compressed by HttpGzipModule\n\nlog_format main &amp;#39;$remote_addr - $remote_user [$time_local] &amp;#34;$request&amp;#34; $status $body_bytes_sent &amp;#34;$http_referer&amp;#34; &amp;#34;$http_user_agent&amp;#34; &amp;#34;$request_time&amp;#34; &amp;#34;$upstream_response_time&amp;#34; &amp;#34;$http_x_forwarded_for&amp;#34;&amp;#39;;\n\naccess_log logs/$&#123;server_name&#125;.access.log main;\n\nfastcgi_intercept_errors on;\nerror_page   500 502 503 504  /50x.html;\n\nserver_names_hash_max_size 4096;\n\ngeo $allow &#123;\n\tdefault\t0;\n\t\n\t127.0.0.1 1;\n\t10.0.0.0/8 1;\n\t192.168.0.0/16 1;\n\t172.16.0.0/12 1;\n&#125;\n\nserver \n&#123;\n\tlisten 80 default_server;\n\tserver_name  _;\n\taccess_log off;\n\t\n\t# use for health check\n\tlocation / \n\t&#123;\n\t\tif ($allow = 1) &#123;\n\t\t\treturn 200;\n\t\t&#125;\n\t\tif ($allow = 0) &#123;\n\t\t\treturn 403;\n\t\t&#125;\n\t&#125;\n\t# use for monitor\n\tlocation /nginx_status\n\t&#123;\n\t\tstub_status on;\n\t\taccess_log off;\n\t\tallow 127.0.0.1;\n\t\tdeny all;\n\t&#125;\n&#125;\n\nserver \n&#123;\n\tlisten 8080 default_server;\n\tserver_name  _;\n\taccess_log off;\n\t\n\t# use for health check\n\tlocation / \n\t&#123;\n\t\tif ($allow = 1) &#123;\n\t\t\treturn 200;\n\t\t&#125;\n\t\tif ($allow = 0) &#123;\n\t\t\treturn 403;\n\t\t&#125;\n\t&#125;\n\t# use for monitor\n\tlocation /nginx_status\n\t&#123;\n\t\tstub_status on;\n\t\taccess_log off;\n\t\tallow 127.0.0.1;\n\t\tdeny all;\n\t&#125;\n&#125;\n\n# set search paths for pure Lua external libraries (&amp;#39;;;&amp;#39; is the default path):\nlua_package_path &amp;#34;/usr/local/nginx/lualib/?.lua;;&amp;#34;;\n# set search paths for Lua external libraries written in C (can also use &amp;#39;;;&amp;#39;);\nlua_package_cpath &amp;#39;/usr/local/nginx/luajit-2.1.0/lib/lua/5.1/?.so;;&amp;#39;;\n\nlua_shared_dict limit_req_store 100m;\nlua_shared_dict cc_req_store 100m;\n\ninclude /data/services/nginx_vhost/*.conf;\n</code></pre>\n<p>}<br />\n</code></pre></div></div></p>\n<h2 id=\"systemd启动配置\">systemd启动配置</h2>\n<blockquote>\n  <p>nginx.service</p>\n</blockquote>\n<div class=\"highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>[Unit]\nDescription=The NGINX HTTP and reverse proxy server\nAfter=syslog.target network.target remote-fs.target nss-lookup.target\n<p>[Service]<br />\nType=forking<br />\nPIDFile=/usr/local/nginx/run/nginx.pid<br />\nExecStartPre=/usr/local/nginx/sbin/nginx -t<br />\nExecStart=/usr/local/nginx/sbin/nginx<br />\nExecStartPost=/bin/sleep 0.1<br />\nExecReload=/usr/local/nginx/sbin/nginx -s reload<br />\n#ExecReload=/bin/kill -s HUP $MAINPID<br />\nExecStop=/bin/kill -s QUIT $MAINPID<br />\nExecStopPost=<br />\nRestart=on-failure<br />\n#RestartSec=1<br />\nPrivateTmp=true</p>\n<p>[Install]<br />\nWantedBy=multi-user.target<br />\n</code></pre></div></div></p>\n<h2 id=\"启动脚本\">启动脚本</h2>\n<p>低版本的linux使用，需要安装 start-stop-daemon</p>\n<blockquote>\n  <p>nginx.sh</p>\n</blockquote>\n<div class=\"highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c\">#! /bin/sh</span>\n<p><span class=\"c\">### BEGIN INIT INFO</span><br />\n<span class=\"c\"># Provides:          nginx</span><br />\n<span class=\"c\"># Required-Start:    $local_fs $remote_fs $network $syslog</span><br />\n<span class=\"c\"># Required-Stop:     $local_fs $remote_fs $network $syslog</span><br />\n<span class=\"c\"># Default-Start:     2 3 4 5</span><br />\n<span class=\"c\"># Default-Stop:      0 1 6</span><br />\n<span class=\"c\"># Short-Description: starts the nginx web server</span><br />\n<span class=\"c\"># Description:       starts nginx using start-stop-daemon</span><br />\n<span class=\"c\">### END INIT INFO</span></p>\n<p><span class=\"nv\">PATH</span><span class=\"o\">=</span>/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin<br />\n<span class=\"nv\">DAEMON</span><span class=\"o\">=</span>/usr/local/nginx/sbin/nginx<br />\n<span class=\"nv\">LOCK_FILE</span><span class=\"o\">=</span><span class=\"s2\">&quot;/usr/local/nginx/run/auto_restart_when_stop&quot;</span><br />\n<span class=\"nv\">NAME</span><span class=\"o\">=</span>nginx<br />\n<span class=\"nv\">DESC</span><span class=\"o\">=</span>nginx</p>\n<p><span class=\"nb\">test</span> <span class=\"nt\">-x</span> <span class=\"nv\">$DAEMON</span> <span class=\"o\">||</span> <span class=\"nb\">exit </span>255</p>\n<p><span class=\"nb\">set</span> <span class=\"nt\">-e</span></p>\n<p><span class=\"nb\">.</span> /lib/lsb/init-functions</p>\n<p>test_nginx_config<span class=\"o\">()</span> <span class=\"o\">&#123;</span><br />\n<span class=\"k\">if</span> <span class=\"nv\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>D</mi><mi>A</mi><mi>E</mi><mi>M</mi><mi>O</mi><mi>N</mi><mo>&lt;</mo><mi mathvariant=\"normal\">/</mi><mi>s</mi><mi>p</mi><mi>a</mi><mi>n</mi><mo>&gt;</mo><mo>&lt;</mo><mi>s</mi><mi>p</mi><mi>a</mi><mi>n</mi><mi>c</mi><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi><mo>=</mo><mi mathvariant=\"normal\">&quot;</mi><mi>n</mi><mi>t</mi><mi mathvariant=\"normal\">&quot;</mi><mo>&gt;</mo><mo>−</mo><mi>t</mi><mo>&lt;</mo><mi mathvariant=\"normal\">/</mi><mi>s</mi><mi>p</mi><mi>a</mi><mi>n</mi><mo>&gt;</mo><mo>&lt;</mo><mi>s</mi><mi>p</mi><mi>a</mi><mi>n</mi><mi>c</mi><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi><mo>=</mo><mi mathvariant=\"normal\">&quot;</mi><mi>n</mi><mi>v</mi><mi mathvariant=\"normal\">&quot;</mi><mo>&gt;</mo></mrow><annotation encoding=\"application/x-tex\">DAEMON&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"strut\" style=\"height:0.75em;\"></span><span class=\"strut bottom\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"base textstyle uncramped\"><span class=\"mord mathit\" style=\"margin-right:0.02778em;\">D</span><span class=\"mord mathit\">A</span><span class=\"mord mathit\" style=\"margin-right:0.05764em;\">E</span><span class=\"mord mathit\" style=\"margin-right:0.10903em;\">M</span><span class=\"mord mathit\" style=\"margin-right:0.02778em;\">O</span><span class=\"mord mathit\" style=\"margin-right:0.10903em;\">N</span><span class=\"mrel\">&lt;</span><span class=\"mord mathrm\">/</span><span class=\"mord mathit\">s</span><span class=\"mord mathit\">p</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">n</span><span class=\"mrel\">&gt;</span><span class=\"mrel\">&lt;</span><span class=\"mord mathit\">s</span><span class=\"mord mathit\">p</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">n</span><span class=\"mord mathit\">c</span><span class=\"mord mathit\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">s</span><span class=\"mord mathit\">s</span><span class=\"mrel\">=</span><span class=\"mord mathrm\">&quot;</span><span class=\"mord mathit\">n</span><span class=\"mord mathit\">t</span><span class=\"mord mathrm\">&quot;</span><span class=\"mrel\">&gt;</span><span class=\"mord\">−</span><span class=\"mord mathit\">t</span><span class=\"mrel\">&lt;</span><span class=\"mord mathrm\">/</span><span class=\"mord mathit\">s</span><span class=\"mord mathit\">p</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">n</span><span class=\"mrel\">&gt;</span><span class=\"mrel\">&lt;</span><span class=\"mord mathit\">s</span><span class=\"mord mathit\">p</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">n</span><span class=\"mord mathit\">c</span><span class=\"mord mathit\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">s</span><span class=\"mord mathit\">s</span><span class=\"mrel\">=</span><span class=\"mord mathrm\">&quot;</span><span class=\"mord mathit\">n</span><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathrm\">&quot;</span><span class=\"mrel\">&gt;</span></span></span></span>DAEMON_OPTS</span><br />\n<span class=\"k\">then<br />\nreturn </span>0<br />\n<span class=\"k\">else<br />\nreturn</span> <span class=\"nv\">$?</span><br />\n<span class=\"k\">fi</span><br />\n<span class=\"o\">&#125;</span></p>\n<p><span class=\"k\">case</span> <span class=\"s2\">&quot;</span><span class=\"nv\">1</span><span class=\"s2\">&#34;</span> <span class=\"k\">in\n  </span>start<span class=\"p\">)</span>\n        <span class=\"nb\">echo</span> <span class=\"nt\">-n</span> <span class=\"s2\">&#34;Starting </span><span class=\"nv\">DESC</span><span class=\"s2\">: &quot;</span><br />\ntest_nginx_config<br />\nstart-stop-daemon <span class=\"nt\">–start</span> <span class=\"nt\">–quiet</span> <span class=\"nt\">–pidfile</span> /usr/local/nginx/run/<span class=\"nv\">NAME</span>.pid <span class=\"se\"></span>\n                <span class=\"nt\">--exec</span> <span class=\"nv\">DAEMON</span> <span class=\"nt\">–</span> <span class=\"nv\">DAEMON_OPTS</span> <span class=\"o\">||</span> <span class=\"nb\">true\n        echo</span> <span class=\"s2\">&#34;</span><span class=\"nv\">NAME</span><span class=\"s2\">.&quot;</span><br />\ntouch <span class=\"nv\">LOCK_FILE</span>\n        <span class=\"p\">;;</span>\n  stop<span class=\"p\">)</span>\n        <span class=\"nb\">echo</span> <span class=\"nt\">-n</span> <span class=\"s2\">&#34;Stopping </span><span class=\"nv\">DESC</span><span class=\"s2\">: &quot;</span><br />\nstart-stop-daemon <span class=\"nt\">–stop</span> <span class=\"nt\">–quiet</span> <span class=\"nt\">–pidfile</span> /usr/local/nginx/run/<span class=\"nv\">NAME</span>.pid <span class=\"se\"></span>\n                <span class=\"nt\">--exec</span> <span class=\"nv\">DAEMON</span> <span class=\"o\">||</span> <span class=\"nb\">true<br />\necho</span> <span class=\"s2\">&quot;</span><span class=\"nv\">NAME</span><span class=\"s2\">.&#34;</span>\n\t\trm <span class=\"nt\">-f</span> <span class=\"nv\">LOCK_FILE</span><br />\n<span class=\"p\">;;</span><br />\nrestart|force-reload<span class=\"p\">)</span><br />\n<span class=\"nb\">echo</span> <span class=\"nt\">-n</span> <span class=\"s2\">&quot;Restarting </span><span class=\"nv\">DESC</span><span class=\"s2\">: &#34;</span>\n        start-stop-daemon <span class=\"nt\">--stop</span> <span class=\"nt\">--quiet</span> <span class=\"nt\">--pidfile</span> <span class=\"se\"></span>\n                /usr/local/nginx/run/<span class=\"nv\">NAME</span>.pid <span class=\"nt\">–exec</span> <span class=\"nv\">DAEMON</span> <span class=\"o\">||</span> <span class=\"nb\">true\n        </span>sleep 1\n        test_nginx_config\n        start-stop-daemon <span class=\"nt\">--start</span> <span class=\"nt\">--quiet</span> <span class=\"nt\">--pidfile</span> <span class=\"se\"></span>\n                /usr/local/nginx/run/<span class=\"nv\">NAME</span>.pid <span class=\"nt\">–exec</span> <span class=\"nv\">DAEMON</span> <span class=\"nt\">--</span> <span class=\"nv\">DAEMON_OPTS</span> <span class=\"o\">||</span> <span class=\"nb\">true<br />\n</span>touch <span class=\"nv\">LOCK_FILE</span>\n        <span class=\"nb\">echo</span> <span class=\"s2\">&#34;</span><span class=\"nv\">NAME</span><span class=\"s2\">.&quot;</span><br />\n<span class=\"p\">;;</span><br />\nreload<span class=\"p\">)</span><br />\n<span class=\"nb\">echo</span> <span class=\"nt\">-n</span> <span class=\"s2\">&quot;Reloading </span><span class=\"nv\">DESC</span><span class=\"s2\"> configuration: &#34;</span>\n        test_nginx_config\n        start-stop-daemon <span class=\"nt\">--stop</span> <span class=\"nt\">--signal</span> HUP <span class=\"nt\">--quiet</span> <span class=\"nt\">--pidfile</span> /usr/local/nginx/run/<span class=\"nv\">NAME</span>.pid <span class=\"se\"></span><br />\n<span class=\"nt\">–exec</span> <span class=\"nv\">DAEMON</span> <span class=\"o\">||</span> <span class=\"nb\">true\n        echo</span> <span class=\"s2\">&#34;</span><span class=\"nv\">NAME</span><span class=\"s2\">.&quot;</span><br />\n<span class=\"p\">;;</span><br />\nconfigtest<span class=\"p\">)</span><br />\n<span class=\"nb\">echo</span> <span class=\"nt\">-n</span> <span class=\"s2\">&quot;Testing </span><span class=\"nv\">DESC</span><span class=\"s2\"> configuration: &#34;</span>\n        <span class=\"k\">if </span>test_nginx_config\n        <span class=\"k\">then\n          </span><span class=\"nb\">echo</span> <span class=\"s2\">&#34;</span><span class=\"nv\">NAME</span><span class=\"s2\">.&quot;</span><br />\n<span class=\"k\">else<br />\n</span><span class=\"nb\">exit</span> <span class=\"nv\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mo>?</mo><mo>&lt;</mo><mi mathvariant=\"normal\">/</mi><mi>s</mi><mi>p</mi><mi>a</mi><mi>n</mi><mo>&gt;</mo><mo>&lt;</mo><mi>s</mi><mi>p</mi><mi>a</mi><mi>n</mi><mi>c</mi><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi><mo>=</mo><mi mathvariant=\"normal\">&quot;</mi><mi>k</mi><mi mathvariant=\"normal\">&quot;</mi><mo>&gt;</mo><mi>f</mi><mi>i</mi><mo>&lt;</mo><mi mathvariant=\"normal\">/</mi><mi>s</mi><mi>p</mi><mi>a</mi><mi>n</mi><mo>&gt;</mo><mo>&lt;</mo><mi>s</mi><mi>p</mi><mi>a</mi><mi>n</mi><mi>c</mi><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi><mo>=</mo><mi mathvariant=\"normal\">&quot;</mi><mi>p</mi><mi mathvariant=\"normal\">&quot;</mi><mo>&gt;</mo><mo separator=\"true\">;</mo><mo separator=\"true\">;</mo><mo>&lt;</mo><mi mathvariant=\"normal\">/</mi><mi>s</mi><mi>p</mi><mi>a</mi><mi>n</mi><mo>&gt;</mo><mi>s</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>u</mi><mi>s</mi><mo>&lt;</mo><mi>s</mi><mi>p</mi><mi>a</mi><mi>n</mi><mi>c</mi><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi><mo>=</mo><mi mathvariant=\"normal\">&quot;</mi><mi>p</mi><mi mathvariant=\"normal\">&quot;</mi><mo>&gt;</mo><mo>)</mo><mo>&lt;</mo><mi mathvariant=\"normal\">/</mi><mi>s</mi><mi>p</mi><mi>a</mi><mi>n</mi><mo>&gt;</mo><mi>s</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>u</mi><msub><mi>s</mi><mi>o</mi></msub><msub><mi>f</mi><mi>p</mi></msub><mi>r</mi><mi>o</mi><mi>c</mi><mo>&lt;</mo><mi>s</mi><mi>p</mi><mi>a</mi><mi>n</mi><mi>c</mi><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi><mo>=</mo><mi mathvariant=\"normal\">&quot;</mi><mi>n</mi><mi>t</mi><mi mathvariant=\"normal\">&quot;</mi><mo>&gt;</mo><mo>−</mo><mi>p</mi><mo>&lt;</mo><mi mathvariant=\"normal\">/</mi><mi>s</mi><mi>p</mi><mi>a</mi><mi>n</mi><mo>&gt;</mo><mi mathvariant=\"normal\">/</mi><mi>u</mi><mi>s</mi><mi>r</mi><mi mathvariant=\"normal\">/</mi><mi>l</mi><mi>o</mi><mi>c</mi><mi>a</mi><mi>l</mi><mi mathvariant=\"normal\">/</mi><mi>n</mi><mi>g</mi><mi>i</mi><mi>n</mi><mi>x</mi><mi mathvariant=\"normal\">/</mi><mi>r</mi><mi>u</mi><mi>n</mi><mi mathvariant=\"normal\">/</mi><mo>&lt;</mo><mi>s</mi><mi>p</mi><mi>a</mi><mi>n</mi><mi>c</mi><mi>l</mi><mi>a</mi><mi>s</mi><mi>s</mi><mo>=</mo><mi mathvariant=\"normal\">&quot;</mi><mi>n</mi><mi>v</mi><mi mathvariant=\"normal\">&quot;</mi><mo>&gt;</mo></mrow><annotation encoding=\"application/x-tex\">?&lt;/span&gt;\n        &lt;span class=&quot;k&quot;&gt;fi&lt;/span&gt;\n        &lt;span class=&quot;p&quot;&gt;;;&lt;/span&gt;\n  status&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;\n        status_of_proc &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; /usr/local/nginx/run/&lt;span class=&quot;nv&quot;&gt;</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"strut\" style=\"height:0.75em;\"></span><span class=\"strut bottom\" style=\"height:1.036108em;vertical-align:-0.286108em;\"></span><span class=\"base textstyle uncramped\"><span class=\"mclose\">?</span><span class=\"mrel\">&lt;</span><span class=\"mord mathrm\">/</span><span class=\"mord mathit\">s</span><span class=\"mord mathit\">p</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">n</span><span class=\"mrel\">&gt;</span><span class=\"mrel\">&lt;</span><span class=\"mord mathit\">s</span><span class=\"mord mathit\">p</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">n</span><span class=\"mord mathit\">c</span><span class=\"mord mathit\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">s</span><span class=\"mord mathit\">s</span><span class=\"mrel\">=</span><span class=\"mord mathrm\">&quot;</span><span class=\"mord mathit\" style=\"margin-right:0.03148em;\">k</span><span class=\"mord mathrm\">&quot;</span><span class=\"mrel\">&gt;</span><span class=\"mord mathit\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord mathit\">i</span><span class=\"mrel\">&lt;</span><span class=\"mord mathrm\">/</span><span class=\"mord mathit\">s</span><span class=\"mord mathit\">p</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">n</span><span class=\"mrel\">&gt;</span><span class=\"mrel\">&lt;</span><span class=\"mord mathit\">s</span><span class=\"mord mathit\">p</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">n</span><span class=\"mord mathit\">c</span><span class=\"mord mathit\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">s</span><span class=\"mord mathit\">s</span><span class=\"mrel\">=</span><span class=\"mord mathrm\">&quot;</span><span class=\"mord mathit\">p</span><span class=\"mord mathrm\">&quot;</span><span class=\"mrel\">&gt;</span><span class=\"mpunct\">;</span><span class=\"mpunct\">;</span><span class=\"mrel\">&lt;</span><span class=\"mord mathrm\">/</span><span class=\"mord mathit\">s</span><span class=\"mord mathit\">p</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">n</span><span class=\"mrel\">&gt;</span><span class=\"mord mathit\">s</span><span class=\"mord mathit\">t</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">t</span><span class=\"mord mathit\">u</span><span class=\"mord mathit\">s</span><span class=\"mrel\">&lt;</span><span class=\"mord mathit\">s</span><span class=\"mord mathit\">p</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">n</span><span class=\"mord mathit\">c</span><span class=\"mord mathit\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">s</span><span class=\"mord mathit\">s</span><span class=\"mrel\">=</span><span class=\"mord mathrm\">&quot;</span><span class=\"mord mathit\">p</span><span class=\"mord mathrm\">&quot;</span><span class=\"mrel\">&gt;</span><span class=\"mclose\">)</span><span class=\"mrel\">&lt;</span><span class=\"mord mathrm\">/</span><span class=\"mord mathit\">s</span><span class=\"mord mathit\">p</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">n</span><span class=\"mrel\">&gt;</span><span class=\"mord mathit\">s</span><span class=\"mord mathit\">t</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">t</span><span class=\"mord mathit\">u</span><span class=\"mord\"><span class=\"mord mathit\">s</span><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:0em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped\"><span class=\"mord mathit\">o</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span><span class=\"mord\"><span class=\"mord mathit\" style=\"margin-right:0.10764em;\">f</span><span class=\"vlist\"><span style=\"top:0.15em;margin-right:0.05em;margin-left:-0.10764em;\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span><span class=\"reset-textstyle scriptstyle cramped\"><span class=\"mord mathit\">p</span></span></span><span class=\"baseline-fix\"><span class=\"fontsize-ensurer reset-size5 size5\"><span style=\"font-size:0em;\">​</span></span>​</span></span></span><span class=\"mord mathit\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathit\">o</span><span class=\"mord mathit\">c</span><span class=\"mrel\">&lt;</span><span class=\"mord mathit\">s</span><span class=\"mord mathit\">p</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">n</span><span class=\"mord mathit\">c</span><span class=\"mord mathit\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">s</span><span class=\"mord mathit\">s</span><span class=\"mrel\">=</span><span class=\"mord mathrm\">&quot;</span><span class=\"mord mathit\">n</span><span class=\"mord mathit\">t</span><span class=\"mord mathrm\">&quot;</span><span class=\"mrel\">&gt;</span><span class=\"mord\">−</span><span class=\"mord mathit\">p</span><span class=\"mrel\">&lt;</span><span class=\"mord mathrm\">/</span><span class=\"mord mathit\">s</span><span class=\"mord mathit\">p</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">n</span><span class=\"mrel\">&gt;</span><span class=\"mord mathrm\">/</span><span class=\"mord mathit\">u</span><span class=\"mord mathit\">s</span><span class=\"mord mathit\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathrm\">/</span><span class=\"mord mathit\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathit\">o</span><span class=\"mord mathit\">c</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathrm\">/</span><span class=\"mord mathit\">n</span><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathit\">i</span><span class=\"mord mathit\">n</span><span class=\"mord mathit\">x</span><span class=\"mord mathrm\">/</span><span class=\"mord mathit\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathit\">u</span><span class=\"mord mathit\">n</span><span class=\"mord mathrm\">/</span><span class=\"mrel\">&lt;</span><span class=\"mord mathit\">s</span><span class=\"mord mathit\">p</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">n</span><span class=\"mord mathit\">c</span><span class=\"mord mathit\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathit\">a</span><span class=\"mord mathit\">s</span><span class=\"mord mathit\">s</span><span class=\"mrel\">=</span><span class=\"mord mathrm\">&quot;</span><span class=\"mord mathit\">n</span><span class=\"mord mathit\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord mathrm\">&quot;</span><span class=\"mrel\">&gt;</span></span></span></span>NAME</span>.pid <span class=\"s2\">&quot;</span><span class=\"nv\">DAEMON</span><span class=\"s2\">&#34;</span> nginx <span class=\"o\">&amp;&amp;</span> <span class=\"nb\">exit </span>0 <span class=\"o\">||</span> <span class=\"nb\">exit</span> <span class=\"nv\">?</span><br />\n<span class=\"p\">;;</span><br />\n<span class=\"k\">*</span><span class=\"p\">)</span><br />\n<span class=\"nb\">echo</span> <span class=\"s2\">&quot;Usage: </span><span class=\"nv\">$NAME</span><span class=\"s2\"> &#123;start|stop|restart|reload|force-reload|status|configtest&#125;&quot;</span> <span class=\"o\">&gt;</span>&amp;2<br />\n<span class=\"nb\">exit </span>1<br />\n<span class=\"p\">;;</span><br />\n<span class=\"k\">esac</span></p>\n<p><span class=\"nb\">exit </span>0</p>\n<p></code></pre></div></div></p>\n","text":" 编译安装脚本 主配置文件 systemd启动配置 启动脚本 编译安装脚本 nginx-lua-build.sh #!/bin/bash #Date:2018-09-03 #Written by magic5650. #Readme:install nginx + lua. #s...","link":"","photos":[],"count_time":{"symbolsCount":"12k","symbolsTime":"11 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85%E8%84%9A%E6%9C%AC\"><span class=\"toc-text\">编译安装脚本</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%B8%BB%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6\"><span class=\"toc-text\">主配置文件</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#systemd%E5%90%AF%E5%8A%A8%E9%85%8D%E7%BD%AE\"><span class=\"toc-text\">systemd启动配置</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%90%AF%E5%8A%A8%E8%84%9A%E6%9C%AC\"><span class=\"toc-text\">启动脚本</span></a></li></ol>","author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"150. Evaluate Reverse Polish Notation","uid":"a3c66f1145fcdbb9f5cecca2e489dca0","slug":"zl/2016-01-01-656_150. Evaluate Reverse Polish Notation","date":"2024-04-03T03:47:35.877Z","updated":"2024-04-03T03:47:35.878Z","comments":true,"path":"api/articles/zl/2016-01-01-656_150. Evaluate Reverse Polish Notation.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":"每日一题 2019 - 05 - 12 题目：Evaluate the value of an arithmetic expression in Reverse Polish Notation. Valid operators are +, -, *, /. Each opera...","link":"","photos":[],"count_time":{"symbolsCount":"3.5k","symbolsTime":"3 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"基于Nginx Lua 和Netflix Eureka的微服务网关","uid":"8e32dba5b3f21244d1fa5adf8939b7d6","slug":"zl/2016-01-01-653_基于Nginx Lua 和Netflix Eureka的微服务网关","date":"2024-04-03T03:47:35.873Z","updated":"2024-04-03T03:47:35.873Z","comments":true,"path":"api/articles/zl/2016-01-01-653_基于Nginx Lua 和Netflix Eureka的微服务网关.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":"依赖：lua-resty-http 基于Nginx&amp;Lua 和Netflix Eureka的微服务网关。 重新架构了内部组件，采用插件模式。 服务发现 Eureka Discovery 抽象discovery，用来支持多种服务发现？规划中… 动态路由 负载均衡 加权轮询 ...","link":"","photos":[],"count_time":{"symbolsCount":"2.5k","symbolsTime":"2 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}}}