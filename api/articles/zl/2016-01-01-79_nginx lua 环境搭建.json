{"title":"nginx lua 环境搭建","uid":"9c62419b09a2ccfc7762b82f5abc8c16","slug":"zl/2016-01-01-79_nginx lua 环境搭建","date":"2024-04-03T03:47:36.042Z","updated":"2024-04-03T03:47:36.042Z","comments":true,"path":"api/articles/zl/2016-01-01-79_nginx lua 环境搭建.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","content":"<p>\n\t\t<!--\nauthor: wngn123\ndate: 2016-08-24\ntitle: nginx lua 环境搭建\ntags: lua\ncategory: Lua\nstatus: publish\nsummary: nginx lua 环境搭建\n-->\n</p><h2>目录结构</h2>\n<pre><code>drwxr-xr-x. 6 wang wang     93 May 15  2015 LuaJIT-2.0.4\n-rw-r--r--. 1 root root 847615 Jun  6 21:16 LuaJIT-2.0.4.tar.gz\ndrwxrwxr-x. 9 root root   4096 May 26 10:41 lua-nginx-module-0.10.5\n-rw-r--r--. 1 root root 579793 Jun  6 21:35 lua-nginx-module-0.10.5.tar.gz\ndrwxr-xr-x. 9 work work   4096 Jun  6 21:25 nginx-1.10.1\n-rw-r--r--. 1 root root 909077 Jun  6 21:17 nginx-1.10.1.tar.gz\ndrwxrwxr-x. 9 root root   4096 May 10 05:28 ngx_devel_kit-0.3.0\n-rw-r--r--. 1 root root  66455 Jun  6 21:34 ngx_devel_kit-0.3.0.tar.gz</code></pre>\n<h2>安装依赖</h2>\n<pre><code class=\"language-shell\">#使用root用户登录\nyum -y install gcc gcc-c++ autoconf automake\nyum -y install zlib zlib-devel openssl openssl-devel pcre-devel</code></pre>\n<h2>下载解压安装文件</h2>\n<pre><code class=\"language-shell\">cd /usr/local/src\nwget http://nginx.org/download/nginx-1.10.1.tar.gz\nwget http://luajit.org/download/LuaJIT-2.0.4.tar.gz\nwget https://github.com/chaoslawful/lua-nginx-module/archive/v1.10.5.tar.gz\nwget https://github.com/simpl/ngx_devel_kit/releases/tag/v0.3.0\ntar -zxvf LuaJIT-2.0.4.tar.gz\ntar -zxvf nginx-1.10.1.tar.gz\n<p>tar -zxvf lua-nginx-module-0.10.5.tar.gz<br />\ntar -zxvf ngx_devel_kit-0.3.0.tar.gz<br />\ntar -zxvf echo-nginx-module-0.59</p>\n<p>tar -zxvf v0.59<br />\ntar -zxvf v1.10.5.tar.gz<br />\ntar -zxvf v0.3.0.tar.gz</code></pre></p>\n<h2>安装LuaJIT</h2>\n<pre><code class=\"language-shell\">cd /usr/local/src/LuaJIT-2.0.4\nmake\nmake install\nexport LUAJIT_LIB=/usr/local/lib\nexport LUAJIT_INC=/usr/local/include/luajit-2.0\nln -s /usr/local/lib/libluajit-5.1.so.2 /lib64/libluajit-5.1.so.2</code></pre>\n<h2>安装NGINX</h2>\n<pre><code class=\"language-shell\">cd /usr/local/src/nginx-1.10.1\n./configure --add-module=/usr/local/src/lua-nginx-module-0.10.5 --add-module=/usr/local/src/ngx_devel_kit-0.3.0\n./configure --add-module=/usr/local/src/lua-nginx-module-0.10.5 --add-module=/usr/local/src/ngx_devel_kit-0.3.0 --add-module=/usr/local/src/echo-nginx-module-0.59 \nmake -j2\nmake install</code></pre>\n<h2>配置NGINX</h2>\n<pre><code class=\"language-shell\">cp /usr/local/nginx/conf/nginx.conf /usr/local/nginx/conf/nginx.conf.bak\nvi /usr/local/nginx/conf/nginx.conf\n<p>location ~* ^/2328(/.*) &#123;<br />\ndefault_type 'text/plain';<br />\ncontent_by_lua 'ngx.say(&quot;hello, ttlsa lua&quot;)';<br />\n&#125;</code></pre></p>\n<h2>启动NGINX</h2>\n<pre><code class=\"language-shell\">/usr/local/nginx/sbin/nginx -v\n/usr/local/nginx/sbin/nginx</code></pre>\n<h2>测试NGINX</h2>\n<pre><code class=\"language-shell\">curl http://localhost/2328/</code></pre>\n<h2>注</h2>\n<ol>\n<li>echo命令只能放在url请求中，如果放在url请求外，会报错 如果报[emerg]: &#34;echo&#34; directive is not allowed here in  ，请检查echo放置的位置</li>\n<li>一次url请求，echo 只能打印一行，如果有逻辑判断，且判断成功，则echo会执行判断成功里边的echo，否则执行最后一句echo（此处不一定正确，在测试中发现是此现象）</li>\n<li>如果echo后边有配置return 或者配置 proxy_pass，则echo的输出会被覆盖，即浏览器无法看到echo的内容</li>\n<li>echo的内容不是写在nginx的配置文件中，而是输出到浏览器中，所以echo的打印字符的查看请在浏览器中查看</li>\n</ol>\n<h2>参考</h2>\n<p><a href=\"http://www.ttlsa.com/nginx/nginx-modules-ngx_lua/\"></a><a href=\"http://www.ttlsa.com/nginx/nginx-modules-ngx_lua\">http://www.ttlsa.com/nginx/nginx-modules-ngx_lua</a></p>\n\t\t<p></p>","text":" 目录结构 drwxr-xr-x. 6 wang wang 93 May 15 2015 LuaJIT-2.0.4 -rw-r--r--. 1 root root 847615 Jun 6 21:16 LuaJIT-2.0.4.tar.gz drwxrwxr-x. 9 root ...","link":"","photos":[],"count_time":{"symbolsCount":"2.4k","symbolsTime":"2 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\"><span class=\"toc-text\">目录结构</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\"><span class=\"toc-text\">安装依赖</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\"><span class=\"toc-text\">下载解压安装文件</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\"><span class=\"toc-text\">安装LuaJIT</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\"><span class=\"toc-text\">安装NGINX</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\"><span class=\"toc-text\">配置NGINX</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\"><span class=\"toc-text\">启动NGINX</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\"><span class=\"toc-text\">测试NGINX</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\"><span class=\"toc-text\">注</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\"><span class=\"toc-text\">参考</span></a></li></ol>","author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"Lua","uid":"15b0cdc6d03f6c3f6bf8d3a7ff197317","slug":"zl/2016-01-01-801_[Lua","date":"2024-04-03T03:47:36.044Z","updated":"2024-04-03T03:47:36.048Z","comments":true,"path":"api/articles/zl/2016-01-01-801_[Lua.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":"读书笔记： Programming in Lua, 4th Edition. 正常函数调用 print(8*9, 9/8) a = math.sin(3) + math.cos(10) print(os.date()) -- add the elements of sequenc...","link":"","photos":[],"count_time":{"symbolsCount":"5.9k","symbolsTime":"5 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"System Center Virtual Machine Manager 2012 RCampndash Evaluation开放下载","uid":"00d86abad8d20397ddc608a40e4329d0","slug":"zl/2016-01-01-7_System Center Virtual Machine Manager 2012 RCamp","date":"2024-04-03T03:47:36.042Z","updated":"2024-04-03T03:47:36.043Z","comments":true,"path":"api/articles/zl/2016-01-01-7_System Center Virtual Machine Manager 2012 RCamp.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":" &lt;p&gt;System Center Virtual Machine Manager 2012 RC– Evaluation开放下载&lt;/p&gt; &lt;br /&gt; &lt;p&gt;System Center Virtual Machine Manage...","link":"","photos":[],"count_time":{"symbolsCount":"6.2k","symbolsTime":"6 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}}}