{"title":"lua学习笔记（二）","uid":"e07778deeaf81d4e352e39b31a6e0149","slug":"zl/2016-01-01-841_lua学习笔记（二）","date":"2024-04-03T03:47:36.093Z","updated":"2024-04-03T03:47:36.094Z","comments":true,"path":"api/articles/zl/2016-01-01-841_lua学习笔记（二）.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","content":"<h2 id=\"Lua变量\"><a href=\"#Lua变量\" class=\"headerlink\" title=\"Lua变量\"></a>Lua变量</h2><figure class=\"highlight lua\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/><span class=\"line\">5</span><br/><span class=\"line\">6</span><br/><span class=\"line\">7</span><br/><span class=\"line\">8</span><br/><span class=\"line\">9</span><br/><span class=\"line\">10</span><br/><span class=\"line\">11</span><br/><span class=\"line\">12</span><br/><span class=\"line\">13</span><br/><span class=\"line\">14</span><br/><span class=\"line\">15</span><br/><span class=\"line\">16</span><br/><span class=\"line\">17</span><br/><span class=\"line\">18</span><br/><span class=\"line\">19</span><br/><span class=\"line\">20</span><br/><span class=\"line\">21</span><br/><span class=\"line\">22</span><br/><span class=\"line\">23</span><br/><span class=\"line\">24</span><br/><span class=\"line\">25</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br/><span class=\"line\"><span class=\"comment\">Lua变量三种类型：全局变量（储存在名称为_G的table中）、局部变量、table中的域</span></span><br/><span class=\"line\"><span class=\"comment\">Lua中的变量全都是全局变量，即使在语句块或函数里，除非用local显式声明为局部变量</span></span><br/><span class=\"line\"><span class=\"comment\">局部变量作用域与C/C++概念相同</span></span><br/><span class=\"line\"><span class=\"comment\">变量默认值为nil</span></span><br/><span class=\"line\"><span class=\"comment\">]]</span></span><br/><span class=\"line\"><span class=\"comment\">-- test.lua文件脚本</span></span><br/><span class=\"line\">a=<span class=\"number\">1</span>\t\t\t<span class=\"comment\">-- 全局变量</span></span><br/><span class=\"line\"><span class=\"keyword\">local</span> b=<span class=\"number\">2</span>\t<span class=\"comment\">-- 文件内局部变量</span></span><br/><span class=\"line\"> </span><br/><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"params\">()</span></span></span><br/><span class=\"line\">    c=<span class=\"number\">5</span>\t\t\t<span class=\"comment\">-- 全局变量</span></span><br/><span class=\"line\">    <span class=\"keyword\">local</span> d=<span class=\"number\">6</span>\t<span class=\"comment\">-- 局部变量</span></span><br/><span class=\"line\"><span class=\"keyword\">end</span></span><br/><span class=\"line\"></span><br/><span class=\"line\">rua()</span><br/><span class=\"line\"><span class=\"built_in\">print</span>(c,d)\t\t<span class=\"comment\">--输出:5 nil</span></span><br/><span class=\"line\"></span><br/><span class=\"line\"><span class=\"keyword\">do</span></span><br/><span class=\"line\">    <span class=\"keyword\">local</span> a=<span class=\"number\">6</span>\t<span class=\"comment\">-- 局部变量，这里局部变量覆盖了全局变量，引用外部全局变量时可以用_G.a来引用，类似于C/C++的::a</span></span><br/><span class=\"line\">    b=<span class=\"number\">6</span>\t\t\t<span class=\"comment\">-- 对局部变量重新赋值</span></span><br/><span class=\"line\">    <span class=\"built_in\">print</span>(a,b)\t<span class=\"comment\">-- 输出：6 6</span></span><br/><span class=\"line\"><span class=\"keyword\">end</span></span><br/><span class=\"line\"></span><br/><span class=\"line\"><span class=\"built_in\">print</span>(a,b)\t\t<span class=\"comment\">-- 输出：5 6</span></span><br/></pre></td></tr></tbody></table></figure>\n<h3 id=\"赋值语句\"><a href=\"#赋值语句\" class=\"headerlink\" title=\"赋值语句\"></a>赋值语句</h3><figure class=\"highlight lua\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/><span class=\"line\">5</span><br/><span class=\"line\">6</span><br/><span class=\"line\">7</span><br/><span class=\"line\">8</span><br/><span class=\"line\">9</span><br/><span class=\"line\">10</span><br/><span class=\"line\">11</span><br/><span class=\"line\">12</span><br/><span class=\"line\">13</span><br/><span class=\"line\">14</span><br/><span class=\"line\">15</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 赋值可以改变一个变量的值和表域</span></span><br/><span class=\"line\">a=<span class=\"string\">&#34;hello&#34;</span> .. <span class=\"string\">&#34;world&#34;</span></span><br/><span class=\"line\">t.n=t.n+<span class=\"number\">1</span></span><br/><span class=\"line\"><span class=\"comment\">-- 可以对多个变量同时赋值</span></span><br/><span class=\"line\">a,b=<span class=\"number\">10</span>,<span class=\"number\">2</span>*x\t\t<span class=\"comment\">-- a=10,b=2*x</span></span><br/><span class=\"line\"><span class=\"comment\">-- 赋值语句会先计算右边所有的值，然后再执行赋值操作</span></span><br/><span class=\"line\"><span class=\"comment\">-- 交换变量写法</span></span><br/><span class=\"line\">x,y=y,x</span><br/><span class=\"line\"></span><br/><span class=\"line\"><span class=\"comment\">变量和值个数不一致:</span></span><br/><span class=\"line\"><span class=\"comment\">变量个数&gt;值的个数\t\t按变量个数补足nil</span></span><br/><span class=\"line\"><span class=\"comment\">变量个数&lt;值的个数\t\t多余的值被忽略</span></span><br/><span class=\"line\"><span class=\"comment\">]]</span> </span><br/><span class=\"line\">a,b,c=<span class=\"number\">0</span></span><br/><span class=\"line\"><span class=\"built_in\">print</span>(a,b,c)\t<span class=\"comment\">-- 输出：0 nil nil</span></span><br/></pre></td></tr></tbody></table></figure>\n<h3 id=\"索引\"><a href=\"#索引\" class=\"headerlink\" title=\"索引\"></a>索引</h3><figure class=\"highlight lua\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- table的索引使用方括号[]和点.的操作</span></span><br/><span class=\"line\">t[i]</span><br/><span class=\"line\">t.i\t\t\t\t\t<span class=\"comment\">-- 当索引为字符串类型时的一种简化写法</span></span><br/><span class=\"line\">gettable_event(t,i)\t<span class=\"comment\">-- 采用索引访问本质上是一个类似这样的函数调用</span></span><br/></pre></td></tr></tbody></table></figure>\n<h2 id=\"Lua循环\"><a href=\"#Lua循环\" class=\"headerlink\" title=\"Lua循环\"></a>Lua循环</h2><h3 id=\"while循环\"><a href=\"#while循环\" class=\"headerlink\" title=\"while循环\"></a>while循环</h3><figure class=\"highlight lua\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">while</span>(condition) <span class=\"keyword\">do</span></span><br/><span class=\"line\">    <span class=\"comment\">-- do something</span></span><br/><span class=\"line\"><span class=\"keyword\">end</span></span><br/></pre></td></tr></tbody></table></figure>\n<h3 id=\"数值for循环\"><a href=\"#数值for循环\" class=\"headerlink\" title=\"数值for循环\"></a>数值for循环</h3><figure class=\"highlight lua\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- var从exp1变化到exp2，每次变化以exp3为步长，可选，不指定默认为1</span></span><br/><span class=\"line\"><span class=\"keyword\">for</span> var=exp1,exp2,[exp3] <span class=\"keyword\">do</span></span><br/><span class=\"line\">    <span class=\"comment\">-- do something</span></span><br/><span class=\"line\"><span class=\"keyword\">end</span></span><br/></pre></td></tr></tbody></table></figure>\n<h3 id=\"泛型for循环\"><a href=\"#泛型for循环\" class=\"headerlink\" title=\"泛型for循环\"></a>泛型for循环</h3><figure class=\"highlight lua\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/><span class=\"line\">5</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 相当于foreach</span></span><br/><span class=\"line\">a={<span class=\"string\">&#34;a&#34;</span>,<span class=\"string\">&#34;b&#34;</span>,<span class=\"string\">&#34;c&#34;</span>}</span><br/><span class=\"line\"><span class=\"keyword\">for</span> i,v <span class=\"keyword\">in</span> <span class=\"built_in\">ipairs</span>(a) <span class=\"keyword\">do</span></span><br/><span class=\"line\">    <span class=\"built_in\">print</span>(i,v)</span><br/><span class=\"line\"><span class=\"keyword\">end</span></span><br/></pre></td></tr></tbody></table></figure>\n<h3 id=\"repeat…until循环\"><a href=\"#repeat…until循环\" class=\"headerlink\" title=\"repeat…until循环\"></a>repeat…until循环</h3><figure class=\"highlight lua\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 相当于C/C++的do...while</span></span><br/><span class=\"line\"><span class=\"keyword\">repeat</span></span><br/><span class=\"line\">    <span class=\"comment\">-- do something</span></span><br/><span class=\"line\"><span class=\"keyword\">until</span>(condition)</span><br/></pre></td></tr></tbody></table></figure>\n<h3 id=\"break语句\"><a href=\"#break语句\" class=\"headerlink\" title=\"break语句\"></a>break语句</h3><figure class=\"highlight lua\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- Lua仅支持break，不支持continue，同其他语言</span></span><br/><span class=\"line\"><span class=\"keyword\">while</span>(condition) <span class=\"keyword\">do</span></span><br/><span class=\"line\">    <span class=\"keyword\">break</span></span><br/><span class=\"line\"><span class=\"keyword\">end</span></span><br/></pre></td></tr></tbody></table></figure>\n<h2 id=\"Lua流程控制\"><a href=\"#Lua流程控制\" class=\"headerlink\" title=\"Lua流程控制\"></a>Lua流程控制</h2><h3 id=\"if语句\"><a href=\"#if语句\" class=\"headerlink\" title=\"if语句\"></a>if语句</h3><figure class=\"highlight lua\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span>(condition) <span class=\"keyword\">then</span></span><br/><span class=\"line\">    <span class=\"comment\">-- do something</span></span><br/><span class=\"line\"><span class=\"keyword\">end</span></span><br/></pre></td></tr></tbody></table></figure>\n<h3 id=\"if…else语句\"><a href=\"#if…else语句\" class=\"headerlink\" title=\"if…else语句\"></a>if…else语句</h3><figure class=\"highlight lua\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/><span class=\"line\">5</span><br/><span class=\"line\">6</span><br/><span class=\"line\">7</span><br/><span class=\"line\">8</span><br/><span class=\"line\">9</span><br/><span class=\"line\">10</span><br/><span class=\"line\">11</span><br/><span class=\"line\">12</span><br/><span class=\"line\">13</span><br/><span class=\"line\">14</span><br/><span class=\"line\">15</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 两条分支</span></span><br/><span class=\"line\"><span class=\"keyword\">if</span>(condition) <span class=\"keyword\">then</span></span><br/><span class=\"line\">    <span class=\"comment\">-- do something</span></span><br/><span class=\"line\"><span class=\"keyword\">else</span></span><br/><span class=\"line\">    <span class=\"comment\">-- do something</span></span><br/><span class=\"line\"><span class=\"keyword\">end</span></span><br/><span class=\"line\"></span><br/><span class=\"line\"><span class=\"comment\">-- 多条分支</span></span><br/><span class=\"line\"><span class=\"keyword\">if</span>(condition1) <span class=\"keyword\">then</span></span><br/><span class=\"line\">    <span class=\"comment\">-- do something</span></span><br/><span class=\"line\"><span class=\"keyword\">elseif</span>(condition2) <span class=\"keyword\">then</span></span><br/><span class=\"line\">    <span class=\"comment\">-- do something</span></span><br/><span class=\"line\"><span class=\"keyword\">else</span></span><br/><span class=\"line\">    <span class=\"comment\">-- do something</span></span><br/><span class=\"line\"><span class=\"keyword\">end</span></span><br/></pre></td></tr></tbody></table></figure>","text":"Lua变量12345678910111213141516171819202122232425Lua变量三种类型：全局变量（储存在名称为_G的table中）、局部变量、table中的域Lua中的变量全都是全局变量，即使在语句块或函数里，除非用local显式声明为局部变量局部变量作用...","link":"","photos":[],"count_time":{"symbolsCount":"1.5k","symbolsTime":"1 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Lua%E5%8F%98%E9%87%8F\"><span class=\"toc-text\">Lua变量</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E8%B5%8B%E5%80%BC%E8%AF%AD%E5%8F%A5\"><span class=\"toc-text\">赋值语句</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E7%B4%A2%E5%BC%95\"><span class=\"toc-text\">索引</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Lua%E5%BE%AA%E7%8E%AF\"><span class=\"toc-text\">Lua循环</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#while%E5%BE%AA%E7%8E%AF\"><span class=\"toc-text\">while循环</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%95%B0%E5%80%BCfor%E5%BE%AA%E7%8E%AF\"><span class=\"toc-text\">数值for循环</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%B3%9B%E5%9E%8Bfor%E5%BE%AA%E7%8E%AF\"><span class=\"toc-text\">泛型for循环</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#repeat%E2%80%A6until%E5%BE%AA%E7%8E%AF\"><span class=\"toc-text\">repeat…until循环</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#break%E8%AF%AD%E5%8F%A5\"><span class=\"toc-text\">break语句</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Lua%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6\"><span class=\"toc-text\">Lua流程控制</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#if%E8%AF%AD%E5%8F%A5\"><span class=\"toc-text\">if语句</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#if%E2%80%A6else%E8%AF%AD%E5%8F%A5\"><span class=\"toc-text\">if…else语句</span></a></li></ol></li></ol>","author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"Lua学习笔记——时间和日期","uid":"3c6c860a219c59b8db2e893adbe18723","slug":"zl/2016-01-01-843_Lua学习笔记——时间和日期","date":"2024-04-03T03:47:36.094Z","updated":"2024-04-03T03:47:36.094Z","comments":true,"path":"api/articles/zl/2016-01-01-843_Lua学习笔记——时间和日期.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":"思维导图首先我们看一张思维导图： 备注： 1. 纪元：一个固定日期，在 POSIX 和 Windows 平台中这个固定日期是 Jan 01, 1970, 00:00 UTC。 2. 日期表：在 lua 中表示时间的一种方式，这个表具有以下几个重要字段：year、month、day...","link":"","photos":[],"count_time":{"symbolsCount":"1.4k","symbolsTime":"1 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"nginx与lua的执行顺序和步骤说明","uid":"36864ebe1c02cd87187d51d88aaf35e2","slug":"zl/2016-01-01-83_nginx与lua的执行顺序和步骤说明 ","date":"2024-04-03T03:47:36.092Z","updated":"2024-04-03T03:47:36.092Z","comments":true,"path":"api/articles/zl/2016-01-01-83_nginx与lua的执行顺序和步骤说明 .json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":"一. nginx执行步骤 nginx在处理每一个用户请求时，都是按照若干个不同的阶段依次处理的，与配置文件上的顺序没有关系，详细内容可以阅读《深入理解nginx:模块开发与架构解析》这本书，这里只做简单介绍； 1. post-read 读取请求内容阶段，nginx读取并解析完请求...","link":"","photos":[],"count_time":{"symbolsCount":"12k","symbolsTime":"11 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}}}