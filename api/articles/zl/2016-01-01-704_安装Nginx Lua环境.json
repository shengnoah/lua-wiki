{"title":"安装Nginx Lua环境","uid":"8de7654a0c1f82f79006d329ee36718f","slug":"zl/2016-01-01-704_安装Nginx Lua环境","date":"2024-04-03T03:47:35.938Z","updated":"2024-04-03T03:47:35.938Z","comments":true,"path":"api/articles/zl/2016-01-01-704_安装Nginx Lua环境.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","content":"<h2 id=\"环境准备\">环境准备：</h2>\n<blockquote>\n<p>$ yum -y install pcre-devel</p>\n<p>$ yum -y install openssl openssl-devel</p>\n</blockquote>\n<h3 id=\"下载所需文件\">下载所需文件</h3>\n<p>亦可参考官方安装指南：<a href=\"https://github.com/openresty/lua-nginx-module#installation\">lua-nginx-module Installation</a></p>\n<p>这是我总结的安装，供参考：</p>\n<p>需要最新版的Nginx，LuaJIT，ngx_devel_kit，lua-nginx-module等安装文件:</p>\n<ul>\n<li><a href=\"http://nginx.org/en/download.html\">Nginx</a></li>\n<li><a href=\"http://luajit.org/download.html\">LuaJIT</a> Lua或者LuaJIT都是可以的，但是出于性能的考虑，推荐安装LuaJIT</li>\n<li><a href=\"https://github.com/simpl/ngx_devel_kit/tags\">ngx_devel_kit</a></li>\n<li><a href=\"https://github.com/openresty/lua-nginx-module/tags\">lua-nginx-module</a></li>\n</ul>\n<p>参考命令下载：</p>\n<blockquote>\n<p>$ curl -O <a href=\"http://nginx.org/download/nginx-1.10.1.tar.gz\">http://nginx.org/download/nginx-1.10.1.tar.gz</a></p>\n<p>$ curl -O <a href=\"http://luajit.org/download/LuaJIT-2.1.0-beta2.tar.gz\">http://luajit.org/download/LuaJIT-2.1.0-beta2.tar.gz</a></p>\n<p>$ curl -L -O <a href=\"https://github.com/simpl/ngx_devel_kit/archive/v0.2.19.tar.gz\">https://github.com/simpl/ngx_devel_kit/archive/v0.2.19.tar.gz</a></p>\n<p>$ curl -L -O <a href=\"https://github.com/openresty/lua-nginx-module/archive/v0.10.5.tar.gz\">https://github.com/openresty/lua-nginx-module/archive/v0.10.5.tar.gz</a></p>\n</blockquote>\n<h2 id=\"安装luajit\">安装LuaJIT</h2>\n<blockquote>\n<p>$ wget <a href=\"http://luajit.org/download/LuaJIT-\">http://luajit.org/download/LuaJIT-</a><version>.tar.gz</version></p>\n<p>$ tar zxvf LuaJIT-<version>.tar.gz</version></p>\n<p>$ cd LuaJIT-<version></version></p>\n<p>$ make</p>\n<p>$ sudo make install</p>\n</blockquote>\n<h2 id=\"编译安装lua-nginx-module\">编译安装lua-nginx-module</h2>\n<div class=\"highlight\"><div class=\"chroma\">\n<table class=\"lntable\"><tbody><tr><td class=\"lntd\">\n<pre class=\"chroma\"><span class=\"lnt\">1\n</span><span class=\"lnt\">2\n</span><span class=\"lnt\">3\n</span><span class=\"lnt\">4\n</span><span class=\"lnt\">5\n</span><span class=\"lnt\">6\n</span><span class=\"lnt\">7\n</span></pre></td>\n<td class=\"lntd\">\n<pre class=\"chroma\">export LUAJIT_LIB=/usr/local/lib\nexport LUAJIT_INC=/usr/local/include/luajit-2.1\n<p>cd nginx-1.10.1<br />\n./configure --prefix=/opt/nginx  --with-ld-opt=&quot;-Wl,-rpath,/usr/local/lib&quot;  --add-module=/path/to/ngx_devel_kit-0.3.0  --add-module=/path/to/nginx/lua-nginx-module-0.10.5<br />\nmake<br />\nmake install</pre></td></tr></tbody></table></p>\n</div>\n</div>\n<h2 id=\"动态module方式\">动态module方式</h2>\n<p>Nginx 1.9.11 开始可以编译module为一个动态module，在执行./configure命令时用–add-dynamic-module=PATH替换–add-module=PATH。编译后可以在nginx.conf配置中使用 load_module 来动态加载这个module：</p>\n<blockquote>\n<p>load_module /path/to/modules/ndk_http_module.so;</p>\n<p>load_module /path/to/modules/ngx_http_lua_module.so;</p>\n</blockquote>\n<h2 id=\"lua-cjson-install\">lua cjson install</h2>\n<p>Eureka Zuul 网关\n  安装编译cjson需要lua运行时，编译前需要修改MakeFile中的LUA_VERSION、LUA_INCLUDE_DIR、LUA_CMODULE_DIR参数，让cjson模块知道lua库文件和头文件目录，才可以正常编译安装。</p>\n<p>下载解压：</p>\n<div class=\"highlight\"><div class=\"chroma\">\n<table class=\"lntable\"><tbody><tr><td class=\"lntd\">\n<pre class=\"chroma\"><span class=\"lnt\">1\n</span><span class=\"lnt\">2\n</span><span class=\"lnt\">3\n</span></pre></td>\n<td class=\"lntd\">\n<pre class=\"chroma\">wget http://www.kyne.com.au/~mark/software/download/lua-cjson-2.1.0.tar.gz\ntar -zxvf cjson-2.1.0.tar.gz\ncd cjson-2.1.0</pre></td></tr></tbody></table>\n</div>\n</div>\n<p>修改MakeFile：</p>\n<div class=\"highlight\"><div class=\"chroma\">\n<table class=\"lntable\"><tbody><tr><td class=\"lntd\">\n<pre class=\"chroma\"><span class=\"lnt\">1\n</span><span class=\"lnt\">2\n</span><span class=\"lnt\">3\n</span><span class=\"lnt\">4\n</span><span class=\"lnt\">5\n</span><span class=\"lnt\">6\n</span><span class=\"lnt\">7\n</span></pre></td>\n<td class=\"lntd\">\n<pre class=\"chroma\">LUA_VERSION =  luajit-2.1\nLUA_INCLUDE_DIR =   $(PREFIX)/include/$(LUA_VERSION)\nLUA_CMODULE_DIR =   $(PREFIX)/lib\n<p>make &amp; sudo make install<br />\nsudo cp <a href=\"http://cjson.so\">cjson.so</a> /usr/local/lib/lua/5.1/</pre></td></tr></tbody></table></p>\n</div>\n</div>","text":"环境准备： $ yum -y install pcre-devel $ yum -y install openssl openssl-devel 下载所需文件 亦可参考官方安装指南：lua-nginx-module Installation 这是我总结的安装，供参考： 需要最新版...","link":"","photos":[],"count_time":{"symbolsCount":"1.8k","symbolsTime":"2 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87\"><span class=\"toc-text\">环境准备：</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E4%B8%8B%E8%BD%BD%E6%89%80%E9%9C%80%E6%96%87%E4%BB%B6\"><span class=\"toc-text\">下载所需文件</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%AE%89%E8%A3%85luajit\"><span class=\"toc-text\">安装LuaJIT</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85lua-nginx-module\"><span class=\"toc-text\">编译安装lua-nginx-module</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%8A%A8%E6%80%81module%E6%96%B9%E5%BC%8F\"><span class=\"toc-text\">动态module方式</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#lua-cjson-install\"><span class=\"toc-text\">lua cjson install</span></a></li></ol>","author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"Write Redis Lua Script with ZeroBrane Studio","uid":"46d4a4f4da0fcaa00cb957564aa82400","slug":"zl/2016-01-01-703_Write Redis Lua Script with ZeroBrane Studio","date":"2024-04-03T03:47:35.938Z","updated":"2024-04-03T03:47:35.938Z","comments":true,"path":"api/articles/zl/2016-01-01-703_Write Redis Lua Script with ZeroBrane Studio.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":"分享如何使用 ZeroBrane Studio 協助 Redis 的 Lua Script 開發與除錯。Lua 是一個輕量級程式語言，是在1993年被發行出來，因為體積小、啟動效能快而後很廣泛的被使用在遊戲腳本、硬體腳本語言與任何與腳本相關的場合中。其他詳細內容可以參考https...","link":"","photos":[],"count_time":{"symbolsCount":"1.8k","symbolsTime":"2 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"lua中的基本概念","uid":"501f874513f6ef944f38b0a8a177b5c7","slug":"zl/2016-01-01-705_lua中的基本概念","date":"2024-04-03T03:47:35.938Z","updated":"2024-04-03T03:47:35.939Z","comments":true,"path":"api/articles/zl/2016-01-01-705_lua中的基本概念.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":"lua中的基本概念包括：值和类型，环境变量及全局环境变量，错误处理，元表及元方法，垃圾回收，协程等。以前从来没有看过，现在仔细的深入了解一下。文章来源，lua官方文档第二章 Lua是一个动态类型语言。也就是说值变量没有类型；只有值有。语言中没有类型定义。所有的值携带了自身类型。 ...","link":"","photos":[],"count_time":{"symbolsCount":428,"symbolsTime":"1 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}}}