{"title":"Lua循环优化 · 花生肉泥","uid":"e7557bbcd2e75ad72345f4517406155f","slug":"zl/2016-01-01-508_Lua循环优化 · 花生肉泥","date":"2024-04-03T03:47:35.784Z","updated":"2024-04-03T03:47:35.784Z","comments":true,"path":"api/articles/zl/2016-01-01-508_Lua循环优化 · 花生肉泥.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","content":"<h3 id=\"关于大量字符串连接-（速度提升100倍）\"><a href=\"#关于大量字符串连接-（速度提升100倍）\" class=\"headerlink\" title=\"关于大量字符串连接 （速度提升100倍）\"></a>关于大量字符串连接 （速度提升100倍）</h3><figure class=\"highlight lua\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/><span class=\"line\">5</span><br/><span class=\"line\">6</span><br/><span class=\"line\">7</span><br/><span class=\"line\">8</span><br/><span class=\"line\">9</span><br/><span class=\"line\">10</span><br/><span class=\"line\">11</span><br/><span class=\"line\">12</span><br/><span class=\"line\">13</span><br/><span class=\"line\">14</span><br/><span class=\"line\">15</span><br/><span class=\"line\">16</span><br/><span class=\"line\">17</span><br/><span class=\"line\">18</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br/><span class=\"line\">a = <span class=\"built_in\">os</span>.<span class=\"built_in\">clock</span>()</span><br/><span class=\"line\"><span class=\"keyword\">local</span> s = <span class=\"string\">&#39;&#39;</span></span><br/><span class=\"line\"><span class=\"keyword\">for</span> i=<span class=\"number\">1</span>,<span class=\"number\">100000</span> <span class=\"keyword\">do</span></span><br/><span class=\"line\">    s = s .. <span class=\"string\">&#39;a&#39;</span></span><br/><span class=\"line\"><span class=\"keyword\">end</span></span><br/><span class=\"line\">b = <span class=\"built_in\">os</span>.<span class=\"built_in\">clock</span>()</span><br/><span class=\"line\"><span class=\"built_in\">print</span>(b-a)    <span class=\"comment\">-- 1.708秒</span></span><br/><span class=\"line\"></span><br/><span class=\"line\">a = <span class=\"built_in\">os</span>.<span class=\"built_in\">clock</span>()</span><br/><span class=\"line\"><span class=\"keyword\">local</span> s = <span class=\"string\">&#39;&#39;</span></span><br/><span class=\"line\"><span class=\"keyword\">local</span> t = {}</span><br/><span class=\"line\"><span class=\"keyword\">for</span> i=<span class=\"number\">1</span>,<span class=\"number\">100000</span> <span class=\"keyword\">do</span></span><br/><span class=\"line\">    t[#t+<span class=\"number\">1</span>] = <span class=\"string\">&#39;a&#39;</span></span><br/><span class=\"line\"><span class=\"keyword\">end</span></span><br/><span class=\"line\">s = <span class=\"built_in\">table</span>.<span class=\"built_in\">concat</span>(t,<span class=\"string\">&#39;&#39;</span>)</span><br/><span class=\"line\">b = <span class=\"built_in\">os</span>.<span class=\"built_in\">clock</span>()</span><br/><span class=\"line\"><span class=\"built_in\">print</span>(b-a)    <span class=\"comment\">-- 0.011秒</span></span><br/></pre></td></tr></tbody></table></figure>\n<h3 id=\"关于创建大量小size的表（大概速度提升1倍）\"><a href=\"#关于创建大量小size的表（大概速度提升1倍）\" class=\"headerlink\" title=\"关于创建大量小size的表（大概速度提升1倍）\"></a>关于创建大量小size的表（大概速度提升1倍）</h3><figure class=\"highlight lua\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/><span class=\"line\">5</span><br/><span class=\"line\">6</span><br/><span class=\"line\">7</span><br/><span class=\"line\">8</span><br/><span class=\"line\">9</span><br/><span class=\"line\">10</span><br/><span class=\"line\">11</span><br/><span class=\"line\">12</span><br/><span class=\"line\">13</span><br/><span class=\"line\">14</span><br/><span class=\"line\">15</span><br/><span class=\"line\">16</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">-- 创建大量小size表时，应该先填充好表的大小</span></span><br/><span class=\"line\">a = <span class=\"built_in\">os</span>.<span class=\"built_in\">clock</span>()</span><br/><span class=\"line\"><span class=\"keyword\">for</span> i=<span class=\"number\">1</span>,<span class=\"number\">2000000</span> <span class=\"keyword\">do</span></span><br/><span class=\"line\">    <span class=\"keyword\">local</span> a = {}</span><br/><span class=\"line\">    a[<span class=\"number\">1</span>] = <span class=\"number\">1</span>;a[<span class=\"number\">2</span>] = <span class=\"number\">2</span>;a[<span class=\"number\">3</span>] = <span class=\"number\">3</span></span><br/><span class=\"line\"><span class=\"keyword\">end</span></span><br/><span class=\"line\">b = <span class=\"built_in\">os</span>.<span class=\"built_in\">clock</span>()</span><br/><span class=\"line\"><span class=\"built_in\">print</span>(b-a)    <span class=\"comment\">-- 1.361秒</span></span><br/><span class=\"line\"></span><br/><span class=\"line\">a = <span class=\"built_in\">os</span>.<span class=\"built_in\">clock</span>()</span><br/><span class=\"line\"><span class=\"keyword\">for</span> i=<span class=\"number\">1</span>,<span class=\"number\">2000000</span> <span class=\"keyword\">do</span></span><br/><span class=\"line\">    <span class=\"keyword\">local</span> a = {<span class=\"number\">0</span>,<span class=\"number\">0</span>,<span class=\"number\">0</span>}</span><br/><span class=\"line\">    a[<span class=\"number\">1</span>] = <span class=\"number\">1</span>;a[<span class=\"number\">2</span>] = <span class=\"number\">2</span>;a[<span class=\"number\">3</span>] = <span class=\"number\">3</span></span><br/><span class=\"line\"><span class=\"keyword\">end</span></span><br/><span class=\"line\">b = <span class=\"built_in\">os</span>.<span class=\"built_in\">clock</span>()</span><br/><span class=\"line\"><span class=\"built_in\">print</span>(b-a)    <span class=\"comment\">-- 0.623秒</span></span><br/></pre></td></tr></tbody></table></figure>","text":"关于大量字符串连接 （速度提升100倍）123456789101112131415161718a = os.clock()local s = &#39;&#39;for i=1,100000 do s = s .. &#39;a&#39;endb = os.clock()prin...","link":"","photos":[],"count_time":{"symbolsCount":633,"symbolsTime":"1 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%85%B3%E4%BA%8E%E5%A4%A7%E9%87%8F%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BF%9E%E6%8E%A5-%EF%BC%88%E9%80%9F%E5%BA%A6%E6%8F%90%E5%8D%87100%E5%80%8D%EF%BC%89\"><span class=\"toc-text\">关于大量字符串连接 （速度提升100倍）</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%85%B3%E4%BA%8E%E5%88%9B%E5%BB%BA%E5%A4%A7%E9%87%8F%E5%B0%8Fsize%E7%9A%84%E8%A1%A8%EF%BC%88%E5%A4%A7%E6%A6%82%E9%80%9F%E5%BA%A6%E6%8F%90%E5%8D%871%E5%80%8D%EF%BC%89\"><span class=\"toc-text\">关于创建大量小size的表（大概速度提升1倍）</span></a></li></ol>","author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"tolua++安装","uid":"0f6d71b477132b063b4c2ff5fbac2c35","slug":"zl/2016-01-01-50_tolua++安装","date":"2024-04-03T03:47:35.787Z","updated":"2024-04-03T03:47:35.788Z","comments":true,"path":"api/articles/zl/2016-01-01-50_tolua++安装.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":" &lt;a href=&quot;/2015/11/11/lua_cpp_bind/&quot; rel=&quot;next&quot; title=&quot;C++与Lua本质原始交互API&quot;&gt; &lt;i class=&quot;fa fa-chevro...","link":"","photos":[],"count_time":{"symbolsCount":"3.6k","symbolsTime":"3 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"Lua脚本式编程","uid":"fd9872c3854aacedec1686eaf11a15c4","slug":"zl/2016-01-01-509_Lua脚本式编程","date":"2024-04-03T03:47:35.784Z","updated":"2024-04-03T03:47:35.787Z","comments":true,"path":"api/articles/zl/2016-01-01-509_Lua脚本式编程.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":"1.基本语法单行注释：–多行注释：–[[ 内容–]] lua最好不要使用下划线加大字母的标识符，因为lua的保留字是这样的。lua不允许使用特殊字符如@$%来定义标志符。 默认情况下，变量总是认为全局。删除全局变量，只需要将变量赋值nil . lua的数据类型：nil 、bool...","link":"","photos":[],"count_time":{"symbolsCount":"1.5k","symbolsTime":"1 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}}}