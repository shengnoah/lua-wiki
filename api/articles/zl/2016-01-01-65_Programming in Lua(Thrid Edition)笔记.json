{"title":"Programming in Lua(Thrid Edition)笔记","uid":"a502732b8dc58224e972b6c53538b8c4","slug":"zl/2016-01-01-65_Programming in Lua(Thrid Edition)笔记","date":"2024-04-03T03:47:35.884Z","updated":"2024-04-03T03:47:35.884Z","comments":true,"path":"api/articles/zl/2016-01-01-65_Programming in Lua(Thrid Edition)笔记.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","content":"<h3 id=\"4-Statements\"><a href=\"#4-Statements\" class=\"headerlink\" title=\"4 Statements\"></a>4 Statements</h3>\n<ul>\n<li><p>多重赋值：先求出所有值，再赋值</p>\n</li>\n<li><p>交换两值</p>\n<figure class=\"highlight lua\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\">x, y = y, x</span><br/></pre></td></tr></tbody></table></figure>\n</li>\n<li><p>多余的变量赋nil，多余的值丢弃</p>\n</li>\n<li><p>用局部变量保护全局变量</p>\n<figure class=\"highlight lua\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">local</span> foo = foo</span><br/></pre></td></tr></tbody></table></figure>\n</li>\n<li><p><code>if-then-elseif-else-end</code>充当<code>switch</code></p>\n<figure class=\"highlight lua\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/><span class=\"line\">5</span><br/><span class=\"line\">6</span><br/><span class=\"line\">7</span><br/><span class=\"line\">8</span><br/><span class=\"line\">9</span><br/><span class=\"line\">10</span><br/><span class=\"line\">11</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> op == <span class=\"string\">&#34;+&#34;</span> <span class=\"keyword\">then</span></span><br/><span class=\"line\">\tr = a + b</span><br/><span class=\"line\"><span class=\"keyword\">elseif</span> op == <span class=\"string\">&#34;-&#34;</span> <span class=\"keyword\">then</span></span><br/><span class=\"line\">\tr = a - b</span><br/><span class=\"line\"><span class=\"keyword\">elseif</span> op == <span class=\"string\">&#34;*&#34;</span> <span class=\"keyword\">then</span></span><br/><span class=\"line\">\tr = a * b</span><br/><span class=\"line\"><span class=\"keyword\">elseif</span> op == <span class=\"string\">&#34;/&#34;</span> <span class=\"keyword\">then</span></span><br/><span class=\"line\">\tr = a / b</span><br/><span class=\"line\"><span class=\"keyword\">else</span></span><br/><span class=\"line\">\t<span class=\"built_in\">error</span>(<span class=\"string\">&#34;invalid operation&#34;</span>)</span><br/><span class=\"line\"><span class=\"keyword\">end</span></span><br/></pre></td></tr></tbody></table></figure>\n</li>\n<li><p><code>numeric for</code></p>\n<figure class=\"highlight lua\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> var = exp1, exp2, exp3 <span class=\"keyword\">do</span></span><br/><span class=\"line\">\t&lt;somethin&gt;</span><br/><span class=\"line\"><span class=\"keyword\">end</span></span><br/></pre></td></tr></tbody></table></figure>\n</li>\n</ul>\n<p>exp3可选，为变量的增量<br/></p><figure class=\"highlight lua\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> i= <span class=\"number\">10</span>， <span class=\"number\">1</span>， <span class=\"number\">-1</span> <span class=\"keyword\">do</span> <span class=\"built_in\">print</span>(i) <span class=\"keyword\">end</span></span><br/></pre></td></tr></tbody></table></figure><p></p>\n<ul>\n<li><p><code>math.huge</code>用作无穷大</p>\n<figure class=\"highlight lua\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/><span class=\"line\">5</span><br/><span class=\"line\">6</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> i = <span class=\"number\">1</span>, <span class=\"built_in\">math</span>.<span class=\"built_in\">huge</span> <span class=\"keyword\">do</span></span><br/><span class=\"line\">\t<span class=\"keyword\">if</span>(<span class=\"number\">0.3</span>*i^<span class=\"number\">3</span> - <span class=\"number\">20</span>*i^<span class=\"number\">2</span> - <span class=\"number\">500</span> &gt;= <span class=\"number\">0</span>) <span class=\"keyword\">then</span></span><br/><span class=\"line\">\t\t<span class=\"built_in\">print</span>(i)</span><br/><span class=\"line\">\t\t<span class=\"keyword\">break</span></span><br/><span class=\"line\">\t<span class=\"keyword\">end</span></span><br/><span class=\"line\"><span class=\"keyword\">end</span></span><br/></pre></td></tr></tbody></table></figure>\n</li>\n<li><p>for循环的表达式只求值一次，变量为局部变量</p>\n</li>\n<li><p><code>generic for</code></p>\n<figure class=\"highlight lua\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> k, v <span class=\"keyword\">in</span> <span class=\"built_in\">pairs</span>(t) <span class=\"keyword\">do</span> <span class=\"built_in\">print</span>(k, v) <span class=\"keyword\">end</span></span><br/></pre></td></tr></tbody></table></figure>\n</li>\n<li><p>用<code>generic for</code>和迭代器建立反向表</p>\n<figure class=\"highlight lua\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/><span class=\"line\">5</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\">days = {<span class=\"string\">&#34;Sunday&#34;</span>, <span class=\"string\">&#34;Monday&#34;</span>, <span class=\"string\">&#34;Tuesday&#34;</span>, <span class=\"string\">&#34;Wednesday&#34;</span>, <span class=\"string\">&#34;Thursday&#34;</span>， <span class=\"string\">&#34;Friday&#34;</span>, <span class=\"string\">&#34;Saturday&#34;</span>}</span><br/><span class=\"line\">revDays = {}</span><br/><span class=\"line\"><span class=\"keyword\">for</span> k, v <span class=\"keyword\">in</span> <span class=\"built_in\">pairs</span>(days) <span class=\"keyword\">do</span></span><br/><span class=\"line\">\trevDays[v] = k</span><br/><span class=\"line\"><span class=\"keyword\">end</span></span><br/></pre></td></tr></tbody></table></figure>\n</li>\n<li><p><code>goto</code>实现<code>redo</code>和<code>continue</code></p>\n<figure class=\"highlight lua\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/><span class=\"line\">5</span><br/><span class=\"line\">6</span><br/><span class=\"line\">7</span><br/><span class=\"line\">8</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">while</span> some_condition <span class=\"keyword\">do</span></span><br/><span class=\"line\">\t::redo::</span><br/><span class=\"line\">\t<span class=\"keyword\">if</span> some_other_condition <span class=\"keyword\">then</span> <span class=\"keyword\">goto</span> continue</span><br/><span class=\"line\">\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> yet_another_condition <span class=\"keyword\">then</span> <span class=\"keyword\">goto</span> redo</span><br/><span class=\"line\">\t<span class=\"keyword\">end</span></span><br/><span class=\"line\">\t&lt;some code&gt;</span><br/><span class=\"line\">\t::continue::</span><br/><span class=\"line\"><span class=\"keyword\">end</span></span><br/></pre></td></tr></tbody></table></figure>\n</li>\n<li><p><code>goto</code>的域</p>\n<figure class=\"highlight lua\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/><span class=\"line\">5</span><br/><span class=\"line\">6</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">while</span> some_condition <span class=\"keyword\">do</span></span><br/><span class=\"line\">\t<span class=\"keyword\">if</span> some_other_condition <span class=\"keyword\">then</span> <span class=\"keyword\">goto</span> continue <span class=\"keyword\">end</span></span><br/><span class=\"line\">\t<span class=\"keyword\">local</span> var = something</span><br/><span class=\"line\">\t&lt;some code&gt;</span><br/><span class=\"line\">\t::continue::</span><br/><span class=\"line\"><span class=\"keyword\">end</span></span><br/></pre></td></tr></tbody></table></figure>\n</li>\n</ul>\n<p>局部变量的域结束在最后一个非空语句，<code>continue</code>标签出现在最后一个非空语句之后，所以<code>goto</code>并没有跳入<code>var</code>的域。</p>\n<ul>\n<li><code>goto</code>不能从一个函数内跳到函数外</li>\n</ul>","text":"4 Statements 多重赋值：先求出所有值，再赋值 交换两值 1x, y = y, x 多余的变量赋nil，多余的值丢弃 用局部变量保护全局变量 1local foo = foo if-then-elseif-else-end充当switch 1234567891011if...","link":"","photos":[],"count_time":{"symbolsCount":"1.3k","symbolsTime":"1 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#4-Statements\"><span class=\"toc-text\">4 Statements</span></a></li></ol>","author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"Lua入门教程：编译、执行和错误","uid":"4ae02dbeefb32d47e6d19e874dd82a9f","slug":"zl/2016-01-01-660_Lua入门教程：编译、执行和错误","date":"2024-04-03T03:47:35.884Z","updated":"2024-04-03T03:47:35.885Z","comments":true,"path":"api/articles/zl/2016-01-01-660_Lua入门教程：编译、执行和错误.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":"dofile 与 loadfile 函数dofile 是一个辅助函数，函数 loadfile 才完成了真正的核心工作。 两个函数都是从文件中加载 Lua 代码，但它不会运行，只是编译代码，然后把编译后的代码作为函数返回。与 dofile 不同，loadfile 不会抛出异常，只会...","link":"","photos":[],"count_time":{"symbolsCount":"1.9k","symbolsTime":"2 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"LUA 与 C","uid":"d2fdb69df2548aac5f06fae8b66d3deb","slug":"zl/2016-01-01-658_LUA 与 C","date":"2024-04-03T03:47:35.879Z","updated":"2024-04-03T03:47:35.879Z","comments":true,"path":"api/articles/zl/2016-01-01-658_LUA 与 C.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":"栈 使用栈进行lua和C数据交换 要将一个值传给lua，需要先将该值压入栈，然后调用lua api函数，lua会从栈中获取该值并从栈中弹出 入栈API 123456void lua_pushnil(lua_State *);void lua_pushboolean(lua_Sta...","link":"","photos":[],"count_time":{"symbolsCount":"1.9k","symbolsTime":"2 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}}}