{"title":"uva 11724 - evaluate the expression","uid":"3e1c66c8e29fd25ce731092bb35e166a","slug":"zl/2016-01-01-1176_uva 11724 - evaluate the expression","date":"2024-04-03T03:47:33.025Z","updated":"2024-04-03T03:47:33.025Z","comments":true,"path":"api/articles/zl/2016-01-01-1176_uva 11724 - evaluate the expression.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","content":"<div id=\"toc\" class=\"toc-article\">\n              <h2 class=\"toc-title\"><span>contents</span></h2>\n<pre><code>          &lt;/div&gt;\n      \n    \n      &lt;h2 id=&quot;Problem&quot;&gt;Problem&lt;/h2&gt;\n</code></pre>\n<p>每個變數皆為正整數，給定一個算術表達式和變數之間的大小關係，請問最少產生出來的答案為何。</p>\n<h2 id=\"Sample_Input\">Sample Input</h2>\n<figure class=\"highlight\"><table><tbody><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"number\">3</span></div><div class=\"line\"><span class=\"operator\">a</span>+b*c</div><div class=\"line\"><span class=\"number\">2</span></div><div class=\"line\"><span class=\"operator\">a</span>&gt;b</div><div class=\"line\">c&gt;b</div><div class=\"line\">z*(x+y)</div><div class=\"line\"><span class=\"number\">3</span></div><div class=\"line\">z&gt;x</div><div class=\"line\">x&gt;y</div><div class=\"line\">z&gt;y</div><div class=\"line\"><span class=\"operator\">a</span>+b+c+<span class=\"operator\">a</span></div><div class=\"line\"><span class=\"number\">0</span></div></pre></td></tr></tbody></table></figure>\n<h2 id=\"Sample_Output\">Sample Output</h2>\n<figure class=\"highlight\"><table><tbody><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">Case</span> <span class=\"number\">1</span>: <span class=\"number\">4</span></div><div class=\"line\"><span class=\"keyword\">Case</span> <span class=\"number\">2</span>: <span class=\"number\">9</span></div><div class=\"line\"><span class=\"keyword\">Case</span> <span class=\"number\">3</span>: <span class=\"number\">4</span></div></pre></td></tr></tbody></table></figure>\n<h2 id=\"Solution\">Solution</h2>\n<p>先使用 spfa 找到根據 greedy 策略分配的變數值，如果發生負環情況直接輸出 <code>-1</code>。</p>\n<p>然後使用矩陣鏈乘積的 DP 方法進行找到最小答案。</p>\n<figure class=\"highlight cpp\"><table><tbody><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div><div class=\"line\">86</div><div class=\"line\">87</div><div class=\"line\">88</div><div class=\"line\">89</div><div class=\"line\">90</div><div class=\"line\">91</div><div class=\"line\">92</div><div class=\"line\">93</div><div class=\"line\">94</div><div class=\"line\">95</div><div class=\"line\">96</div><div class=\"line\">97</div><div class=\"line\">98</div><div class=\"line\">99</div><div class=\"line\">100</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"preprocessor\">#<span class=\"keyword\">include</span> &lt;stdio.h&gt; </span></div><div class=\"line\"><span class=\"preprocessor\">#<span class=\"keyword\">include</span> &lt;vector&gt;</span></div><div class=\"line\"><span class=\"preprocessor\">#<span class=\"keyword\">include</span> &lt;queue&gt;</span></div><div class=\"line\"><span class=\"preprocessor\">#<span class=\"keyword\">include</span> &lt;string.h&gt;</span></div><div class=\"line\"><span class=\"preprocessor\">#<span class=\"keyword\">include</span> &lt;algorithm&gt;</span></div><div class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> <span class=\"built_in\">std</span>;</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">char</span> <span class=\"built_in\">exp</span>[<span class=\"number\">1024</span>], cond[<span class=\"number\">1024</span>];</div><div class=\"line\"><span class=\"keyword\">int</span> val[<span class=\"number\">26</span>];</div><div class=\"line\"><span class=\"keyword\">int</span> spfa(<span class=\"stl_container\"><span class=\"built_in\">vector</span>&lt;<span class=\"keyword\">int</span>&gt;</span> g[]) {</div><div class=\"line\">\t<span class=\"stl_container\"><span class=\"built_in\">queue</span>&lt;<span class=\"keyword\">int</span>&gt;</span> Q;</div><div class=\"line\">\t<span class=\"keyword\">int</span> inq[<span class=\"number\">26</span>] = {}, dist[<span class=\"number\">26</span>] = {};</div><div class=\"line\">\t<span class=\"keyword\">int</span> cnt[<span class=\"number\">26</span>] = {};</div><div class=\"line\">\t<span class=\"keyword\">int</span> u, v;</div><div class=\"line\">\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">26</span>; i++) {</div><div class=\"line\">\t\tQ.push(i), dist[i] = <span class=\"number\">1</span>;</div><div class=\"line\">\t}</div><div class=\"line\">\t<span class=\"keyword\">while</span> (!Q.empty()) {</div><div class=\"line\">\t\tu = Q.front(), Q.pop();</div><div class=\"line\">\t\tinq[u] = <span class=\"number\">0</span>;</div><div class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; g[u].size(); i++) {</div><div class=\"line\">\t\t\tv = g[u][i];</div><div class=\"line\">\t\t\t<span class=\"keyword\">if</span> (dist[v] &lt; dist[u] + <span class=\"number\">1</span>) {</div><div class=\"line\">\t\t\t\tdist[v] = dist[u] + <span class=\"number\">1</span>;</div><div class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (!inq[v]) {</div><div class=\"line\">\t\t\t\t\tinq[v] = <span class=\"number\">1</span>, Q.push(v);</div><div class=\"line\">\t\t\t\t\t<span class=\"keyword\">if</span> (++cnt[v] &gt; <span class=\"number\">26</span>)</div><div class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</div><div class=\"line\">\t\t\t\t}</div><div class=\"line\">\t\t\t}</div><div class=\"line\">\t\t}</div><div class=\"line\">\t}</div><div class=\"line\">\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">26</span>; i++)</div><div class=\"line\">\t\tval[i] = dist[i];</div><div class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">1</span>;</div><div class=\"line\">}</div><div class=\"line\"></div><div class=\"line\"><span class=\"keyword\">int</span> used[<span class=\"number\">512</span>][<span class=\"number\">512</span>];</div><div class=\"line\"><span class=\"keyword\">long</span> <span class=\"keyword\">long</span> dp[<span class=\"number\">512</span>][<span class=\"number\">512</span>];</div><div class=\"line\"><span class=\"keyword\">long</span> <span class=\"keyword\">long</span> dfs(<span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r) {</div><div class=\"line\">\t<span class=\"keyword\">if</span> (used[l][r])</div><div class=\"line\">\t\t<span class=\"keyword\">return</span> dp[l][r];</div><div class=\"line\">\t<span class=\"keyword\">if</span> (l == r)</div><div class=\"line\">\t\t<span class=\"keyword\">return</span> val[<span class=\"built_in\">exp</span>[l] - <span class=\"string\">&#39;a&#39;</span>];</div><div class=\"line\">\tused[l][r] = <span class=\"number\">1</span>;</div><div class=\"line\">\t<span class=\"keyword\">long</span> <span class=\"keyword\">long</span> &amp;ret = dp[l][r];</div><div class=\"line\">\tret = <span class=\"number\">1L</span>L&lt;&lt;<span class=\"number\">60</span>;</div><div class=\"line\">\t<span class=\"keyword\">int</span> p = <span class=\"number\">0</span>, test = <span class=\"number\">0</span>;</div><div class=\"line\">\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = l; i &lt;= r; i++) {</div><div class=\"line\">\t\t<span class=\"keyword\">if</span> (<span class=\"built_in\">exp</span>[i] == <span class=\"string\">&#39;(&#39;</span>)\tp++;</div><div class=\"line\">\t\t<span class=\"keyword\">if</span> (<span class=\"built_in\">exp</span>[i] == <span class=\"string\">&#39;)&#39;</span>)\tp--;</div><div class=\"line\">\t\t<span class=\"keyword\">if</span> (p == <span class=\"number\">0</span> &amp;&amp; <span class=\"built_in\">exp</span>[i] == <span class=\"string\">&#39;+&#39;</span>) {</div><div class=\"line\">\t\t\tret = min(ret, dfs(l, i-<span class=\"number\">1</span>) + dfs(i+<span class=\"number\">1</span>, r));</div><div class=\"line\">\t\t\ttest++;</div><div class=\"line\">\t\t}</div><div class=\"line\">\t\t<span class=\"keyword\">if</span> (p == <span class=\"number\">0</span> &amp;&amp; <span class=\"built_in\">exp</span>[i] == <span class=\"string\">&#39;*&#39;</span>) {</div><div class=\"line\">\t\t\tret = min(ret, dfs(l, i-<span class=\"number\">1</span>) * dfs(i+<span class=\"number\">1</span>, r));</div><div class=\"line\">\t\t\ttest++;</div><div class=\"line\">\t\t}</div><div class=\"line\">\t}</div><div class=\"line\">\t<span class=\"keyword\">if</span> (test == <span class=\"number\">0</span>)</div><div class=\"line\">\t\tret = min(ret, dfs(l+<span class=\"number\">1</span>, r-<span class=\"number\">1</span>));</div><div class=\"line\">\t<span class=\"keyword\">return</span> ret;</div><div class=\"line\">}</div><div class=\"line\"><span class=\"keyword\">int</span> main() {</div><div class=\"line\">\t<span class=\"keyword\">int</span> testcase, cases = <span class=\"number\">0</span>;</div><div class=\"line\">\t<span class=\"keyword\">int</span> n;</div><div class=\"line\">\t<span class=\"built_in\">scanf</span>(<span class=\"string\">&#34;%d&#34;</span>, &amp;testcase);</div><div class=\"line\">\t<span class=\"keyword\">while</span> (testcase--) {</div><div class=\"line\">\t\t<span class=\"built_in\">scanf</span>(<span class=\"string\">&#34;%s&#34;</span>, <span class=\"built_in\">exp</span>);</div><div class=\"line\">\t\t<span class=\"built_in\">scanf</span>(<span class=\"string\">&#34;%d&#34;</span>, &amp;n);</div><div class=\"line\">\t\t<span class=\"stl_container\"><span class=\"built_in\">vector</span>&lt;<span class=\"keyword\">int</span>&gt;</span> g[<span class=\"number\">26</span>];</div><div class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; n; i++) {</div><div class=\"line\">\t\t\t<span class=\"built_in\">scanf</span>(<span class=\"string\">&#34;%s&#34;</span>, cond);</div><div class=\"line\">\t\t\tg[cond[<span class=\"number\">2</span>]-<span class=\"string\">&#39;a&#39;</span>].push_back(cond[<span class=\"number\">0</span>]-<span class=\"string\">&#39;a&#39;</span>);</div><div class=\"line\">\t\t}</div><div class=\"line\">\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&#34;Case %d: &#34;</span>, ++cases);</div><div class=\"line\">\t\t<span class=\"keyword\">if</span>(!spfa(g)) {</div><div class=\"line\">\t\t\t<span class=\"built_in\">puts</span>(<span class=\"string\">&#34;-1&#34;</span>);</div><div class=\"line\">\t\t} <span class=\"keyword\">else</span> {</div><div class=\"line\">\t\t\t<span class=\"built_in\">memset</span>(used, <span class=\"number\">0</span>, <span class=\"keyword\">sizeof</span>(used));</div><div class=\"line\">\t\t\t<span class=\"built_in\">printf</span>(<span class=\"string\">&#34;%lldn&#34;</span>, dfs(<span class=\"number\">0</span>, <span class=\"built_in\">strlen</span>(<span class=\"built_in\">exp</span>) - <span class=\"number\">1</span>));</div><div class=\"line\">\t\t}</div><div class=\"line\">\t}</div><div class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</div><div class=\"line\">}</div><div class=\"line\"></div><div class=\"line\">3</div><div class=\"line\">a+b*c</div><div class=\"line\">2</div><div class=\"line\">a&gt;b</div><div class=\"line\">c&gt;b</div><div class=\"line\">z*(x+y)</div><div class=\"line\">3</div><div class=\"line\">z&gt;x</div><div class=\"line\">x&gt;y</div><div class=\"line\">z&gt;y</div><div class=\"line\">a+b+c+a</div><div class=\"line\">0</div><div class=\"line\">*/</div></pre></td></tr></tbody></table></figure>","text":" contents &lt;/div&gt; &lt;h2 id=&quot;Problem&quot;&gt;Problem&lt;/h2&gt; 每個變數皆為正整數，給定一個算術表達式和變數之間的大小關係，請問最少產生出來的答案為何。 Sample Input 1234567...","link":"","photos":[],"count_time":{"symbolsCount":"2.4k","symbolsTime":"2 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#toc\"><span class=\"toc-text\">contents</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Sample_Input\"><span class=\"toc-text\">Sample Input</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Sample_Output\"><span class=\"toc-text\">Sample Output</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Solution\"><span class=\"toc-text\">Solution</span></a></li></ol>","author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"19. Partial Evaluation","uid":"dd3308a0175861c9228db4dcb8396a94","slug":"zl/2016-01-01-1175_「编程语言基础」 19. Partial Evaluation","date":"2024-04-03T03:47:33.025Z","updated":"2024-04-03T03:47:33.025Z","comments":true,"path":"api/articles/zl/2016-01-01-1175_「编程语言基础」 19. Partial Evaluation.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":"TBD &lt;hr style=&quot;visibility: hidden;&quot;/&gt; &lt;hr style=&quot;visibility: hidden;&quot;/&gt; ","link":"","photos":[],"count_time":{"symbolsCount":142,"symbolsTime":"1 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"lua学习笔记","uid":"329726c67d21b0b62fc4af0c5b68cfed","slug":"zl/2016-01-01-1177_lua学习笔记","date":"2024-04-03T03:47:33.025Z","updated":"2024-04-03T03:47:33.025Z","comments":true,"path":"api/articles/zl/2016-01-01-1177_lua学习笔记.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":"输出、注释、全局变量12345678910print(&#34;hello world&#34;)--[[abcd is hhhasdassadd]]--print(b) --nilb=10print(b) --10 数据类型12345678nil --相当于其他语言的null（...","link":"","photos":[],"count_time":{"symbolsCount":330,"symbolsTime":"1 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}}}