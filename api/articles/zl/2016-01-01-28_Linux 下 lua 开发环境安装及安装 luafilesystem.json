{"title":"Linux下lua开发环境安装及安装luafilesystem","uid":"3f5fc0e8fdd43ef37c7942dee66a8753","slug":"zl/2016-01-01-28_Linux 下 lua 开发环境安装及安装 luafilesystem","date":"2024-04-03T03:47:33.146Z","updated":"2024-04-03T03:47:33.146Z","comments":true,"path":"api/articles/zl/2016-01-01-28_Linux 下 lua 开发环境安装及安装 luafilesystem.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","content":"<p>火云邪神语录：天下武功，无坚不破，唯快不破！Nginx 的看家本领就是速度，Lua 的拿手好戏亦是速度，这两者的结合在速度上无疑有基因上的优势。</p>\n<p><img src=\"https://img.dazhuanlan.com/2019/11/27/5dde43d365d47.gif\" alt=\"\"/><br/><br/>最近一直再折腾这个，干脆就稍微整理下。以防后面继续跳坑！</p>\n<p>安装：</p>\n<h3 id=\"1-先安装-lua-的相关依赖\"><a href=\"#1-先安装-lua-的相关依赖\" class=\"headerlink\" title=\"1.先安装 lua 的相关依赖\"></a>1.先安装 lua 的相关依赖</h3><p>安装 C 开发环境<br/>由于 gcc 包需要依赖 binutils 和 cpp 包，另外 make 包也是在编译中常用的，所以一共需要 9 个包来完成安装，因此我们只需要执行 9 条指令即可：</p>\n<figure class=\"highlight plain\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/><span class=\"line\">5</span><br/><span class=\"line\">6</span><br/><span class=\"line\">7</span><br/><span class=\"line\">8</span><br/><span class=\"line\">9</span><br/><span class=\"line\">10</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\">gcc：命令未找到（解决方法）</span><br/><span class=\"line\">yum install cpp</span><br/><span class=\"line\">yum install binutils</span><br/><span class=\"line\">yum install glibc</span><br/><span class=\"line\">yum install glibc-kernheaders</span><br/><span class=\"line\">yum install glibc-common</span><br/><span class=\"line\">yum install glibc-devel</span><br/><span class=\"line\">yum install gcc</span><br/><span class=\"line\">yum install make</span><br/><span class=\"line\">yum install readline-devel</span><br/></pre></td></tr></tbody></table></figure>\n<h3 id=\"2-安装-lua5-1-5\"><a href=\"#2-安装-lua5-1-5\" class=\"headerlink\" title=\"2.安装  lua5.1.5\"></a>2.安装  lua5.1.5</h3><p>下载地址：<a href=\"http://www.lua.org/ftp/\" target=\"_blank\" rel=\"noopener noreferrer\">http://www.lua.org/ftp/</a></p>\n<figure class=\"highlight plain\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/><span class=\"line\">5</span><br/><span class=\"line\">6</span><br/><span class=\"line\">7</span><br/><span class=\"line\">8</span><br/><span class=\"line\">9</span><br/><span class=\"line\">10</span><br/><span class=\"line\">11</span><br/><span class=\"line\">12</span><br/><span class=\"line\">13</span><br/><span class=\"line\">14</span><br/><span class=\"line\">15</span><br/><span class=\"line\">16</span><br/><span class=\"line\">17</span><br/><span class=\"line\">18</span><br/><span class=\"line\">19</span><br/><span class=\"line\">20</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\">tar -zxvf lua-5.1.5.tar.gz</span><br/><span class=\"line\">cd lua-5.1.5</span><br/><span class=\"line\">vi Makefile</span><br/><span class=\"line\">设置 INSTALL_TOP= /usr/local/lua</span><br/><span class=\"line\">make linux</span><br/><span class=\"line\">make test</span><br/><span class=\"line\">make install</span><br/><span class=\"line\">rm -rf  /usr/bin/lua</span><br/><span class=\"line\">ln -s /usr/local/lua/bin/lua /usr/bin/lua</span><br/><span class=\"line\">ln -s /usr/local/lua/share/lua /usr/share/lua</span><br/><span class=\"line\"></span><br/><span class=\"line\">设置环境变量：</span><br/><span class=\"line\">vim /etc/profile</span><br/><span class=\"line\"></span><br/><span class=\"line\">添加：</span><br/><span class=\"line\">export LUA_HOME=/usr/local/lua</span><br/><span class=\"line\">export PATH=$PATH:$LUA_HOME/bin</span><br/><span class=\"line\"></span><br/><span class=\"line\">环境变量生效：</span><br/><span class=\"line\">source /etc/profile</span><br/></pre></td></tr></tbody></table></figure>\n<h3 id=\"3、安装-luarocks\"><a href=\"#3、安装-luarocks\" class=\"headerlink\" title=\"3、安装  luarocks\"></a>3、安装  luarocks</h3><p>是一个 Lua 包管理器，基于 Lua 语言开发，提供一个命令行的方式来管理 Lua 包依赖、安装第三方 Lua 包等。</p>\n<p>地址： <a href=\"https://github.com/luarocks/luarocks\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/luarocks/luarocks</a></p>\n<figure class=\"highlight plain\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/><span class=\"line\">5</span><br/><span class=\"line\">6</span><br/><span class=\"line\">7</span><br/><span class=\"line\">8</span><br/><span class=\"line\">9</span><br/><span class=\"line\">10</span><br/><span class=\"line\">11</span><br/><span class=\"line\">12</span><br/><span class=\"line\">13</span><br/><span class=\"line\">14</span><br/><span class=\"line\">15</span><br/><span class=\"line\">16</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\">使用 luarocks-2.2.1 版本在我机器上没有问题，但是使用 luarocks-2.4.2 出现问题</span><br/><span class=\"line\"></span><br/><span class=\"line\">wget http://luarocks.org/releases/luarocks-2.2.1.tar.gz</span><br/><span class=\"line\"></span><br/><span class=\"line\">tar -zxvf luarocks-2.2.1.tar.gz</span><br/><span class=\"line\"></span><br/><span class=\"line\">cd luarocks-2.2.1</span><br/><span class=\"line\"></span><br/><span class=\"line\">./configure --with-lua=/usr/local --with-lua-include=/usr/local/lua/include</span><br/><span class=\"line\"></span><br/><span class=\"line\">设置环境变量：</span><br/><span class=\"line\"></span><br/><span class=\"line\">export LUA_LUAROCKS_PATH=/usr/local/luarocks-2.2.1</span><br/><span class=\"line\">export PATH=$PATH:$LUA_LUAROCKS_PATH</span><br/><span class=\"line\"></span><br/><span class=\"line\">make &amp; make install</span><br/></pre></td></tr></tbody></table></figure>\n<h3 id=\"4、安装-luafilesystem\"><a href=\"#4、安装-luafilesystem\" class=\"headerlink\" title=\"4、安装  luafilesystem\"></a>4、安装  luafilesystem</h3><p>是一个用于 lua 进行文件访问的库，可以支持 lua 5.1 和 lua5.2，且是跨平台的，在为 lua 安装 lfs 之前需要先安装luarocks。因为自己的需求刚好需要这模块。</p>\n<p>地址：<a href=\"https://github.com/keplerproject/luafilesystem\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/keplerproject/luafilesystem</a></p>\n<p>文档： <a href=\"http://keplerproject.github.io/luafilesystem/index.html\" target=\"_blank\" rel=\"noopener noreferrer\">http://keplerproject.github.io/luafilesystem/index.html</a></p>\n<figure class=\"highlight plain\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\">luarocks install luafilesystem</span><br/></pre></td></tr></tbody></table></figure>\n<h3 id=\"5、测试\"><a href=\"#5、测试\" class=\"headerlink\" title=\"5、测试\"></a>5、测试</h3><p>测试 lua 是否安装成功</p>\n<p><code>lua -v</code></p>\n<p>结果：</p>\n<figure class=\"highlight plain\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\">Lua 5.1.5  Copyright (C) 1994-2012 Lua.org, PUC-Rio</span><br/></pre></td></tr></tbody></table></figure>\n<p>测试 luafilesystem 是否安装成功</p>\n<p>a.lua</p>\n<figure class=\"highlight plain\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/><span class=\"line\">5</span><br/><span class=\"line\">6</span><br/><span class=\"line\">7</span><br/><span class=\"line\">8</span><br/><span class=\"line\">9</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\">local lfs = require&#34;lfs&#34;</span><br/><span class=\"line\"></span><br/><span class=\"line\">function Rreturn(filePath)</span><br/><span class=\"line\">        local time = os.date(&#34;%a, %d %b %Y %X GMT&#34;, lfs.attributes(filePath).modification)</span><br/><span class=\"line\">        --打印文件的修改时间</span><br/><span class=\"line\">        print(time)</span><br/><span class=\"line\">end</span><br/><span class=\"line\"></span><br/><span class=\"line\">Rreturn(&#34;/opt/lua/a.txt&#34;)</span><br/></pre></td></tr></tbody></table></figure>\n<p>a.txt</p>\n<figure class=\"highlight plain\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\">a</span><br/><span class=\"line\">b</span><br/><span class=\"line\">c</span><br/></pre></td></tr></tbody></table></figure>\n<p>运行：</p>\n<figure class=\"highlight plain\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\">lua  a.lua</span><br/></pre></td></tr></tbody></table></figure>\n<p>结果：</p>\n<figure class=\"highlight plain\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\">Tue, 12 Sep 2017 18:43:13 GMT</span><br/></pre></td></tr></tbody></table></figure>\n<p>出现打印出时间的结果就意味着已经安装好了。</p>\n<hr/>\n<p>当然以上这是在 Linux 安装的， Windows 上的其实比这还简单了，但是安装 luafilesystem 的话需要自己去下载个 lfs.dll ，然后把这个放到 lua 的安装路径去。很简单的，这里就不细说了。</p>\n<h3 id=\"出现过的错误：\"><a href=\"#出现过的错误：\" class=\"headerlink\" title=\"出现过的错误：\"></a>出现过的错误：</h3><figure class=\"highlight plain\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/><span class=\"line\">5</span><br/><span class=\"line\">6</span><br/><span class=\"line\">7</span><br/><span class=\"line\">8</span><br/><span class=\"line\">9</span><br/><span class=\"line\">10</span><br/><span class=\"line\">11</span><br/><span class=\"line\">12</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\">[root@n1 lua-5.1.5]# make linux test</span><br/><span class=\"line\">cd src &amp;&amp; make linux</span><br/><span class=\"line\">make[1]: Entering directory `/opt/lua-5.1.5/src&#39;</span><br/><span class=\"line\">make all MYCFLAGS=-DLUA_USE_LINUX MYLIBS=&#34;-Wl,-E -ldl -lreadline -lhistory -lncurses&#34;</span><br/><span class=\"line\">make[2]: Entering directory `/opt/lua-5.1.5/src&#39;</span><br/><span class=\"line\">gcc -O2 -Wall -DLUA_USE_LINUX   -c -o lapi.o lapi.c</span><br/><span class=\"line\">make[2]: gcc：命令未找到</span><br/><span class=\"line\">make[2]: *** [lapi.o] 错误 127</span><br/><span class=\"line\">make[2]: Leaving directory `/opt/lua-5.1.5/src&#39;</span><br/><span class=\"line\">make[1]: *** [linux] 错误 2</span><br/><span class=\"line\">make[1]: Leaving directory `/opt/lua-5.1.5/src&#39;</span><br/><span class=\"line\">make: *** [linux] 错误 2</span><br/></pre></td></tr></tbody></table></figure>\n<p><strong>原因</strong>：最开始的那些依赖没安装</p>\n<p><img src=\"https://img.dazhuanlan.com/2019/11/27/5dde43d44bee1.jpg\" alt=\"\"/></p>\n<pre><code>  &lt;!-- &lt;div&gt;\n\t\t\n\t&lt;/div&gt; --&gt;\n</code></pre>\n","text":"火云邪神语录：天下武功，无坚不破，唯快不破！Nginx 的看家本领就是速度，Lua 的拿手好戏亦是速度，这两者的结合在速度上无疑有基因上的优势。 最近一直再折腾这个，干脆就稍微整理下。以防后面继续跳坑！ 安装： 1.先安装 lua 的相关依赖安装 C 开发环境由于 gcc 包需要...","link":"","photos":[],"count_time":{"symbolsCount":"2.7k","symbolsTime":"2 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#1-%E5%85%88%E5%AE%89%E8%A3%85-lua-%E7%9A%84%E7%9B%B8%E5%85%B3%E4%BE%9D%E8%B5%96\"><span class=\"toc-text\">1.先安装 lua 的相关依赖</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#2-%E5%AE%89%E8%A3%85-lua5-1-5\"><span class=\"toc-text\">2.安装  lua5.1.5</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#3%E3%80%81%E5%AE%89%E8%A3%85-luarocks\"><span class=\"toc-text\">3、安装  luarocks</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#4%E3%80%81%E5%AE%89%E8%A3%85-luafilesystem\"><span class=\"toc-text\">4、安装  luafilesystem</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#5%E3%80%81%E6%B5%8B%E8%AF%95\"><span class=\"toc-text\">5、测试</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%87%BA%E7%8E%B0%E8%BF%87%E7%9A%84%E9%94%99%E8%AF%AF%EF%BC%9A\"><span class=\"toc-text\">出现过的错误：</span></a></li></ol>","author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"C# 与 Lua","uid":"c4823e345a6d3773abfe476da6a9aec3","slug":"zl/2016-01-01-289_C# 与 Lua ","date":"2024-04-03T03:47:33.146Z","updated":"2024-04-03T03:47:33.146Z","comments":true,"path":"api/articles/zl/2016-01-01-289_C# 与 Lua .json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":"交互原理 Lua Call C# Wrap 方式: 首先生成 C# 源文件所对应的Wrap文件，由 Lua 文件调用 Wrap 文件，再由 Wrap 文件调用 C# 文件 反射方式： 当索引系统 API、dll 库或者第三方库时，如果无法将代码的具体实现进行代码生成，可采用此方式...","link":"","photos":[],"count_time":{"symbolsCount":"1.1k","symbolsTime":"1 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"Lua Learning Notes","uid":"4b8499e3ac801948195a5de99e588873","slug":"zl/2016-01-01-288_Lua Learning Notes","date":"2024-04-03T03:47:33.145Z","updated":"2024-04-03T03:47:33.145Z","comments":true,"path":"api/articles/zl/2016-01-01-288_Lua Learning Notes.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":"控制流 if a, b = 10, 20 if a == b then print(&#34;a=b&#34;) elseif a &gt; b then print(&#34;a&gt;b&#34;) else print(&#34;a&lt;b&#34;) end while...","link":"","photos":[],"count_time":{"symbolsCount":"1.1k","symbolsTime":"1 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}}}