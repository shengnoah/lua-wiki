{"title":"Lua初识","uid":"608573cb0fd3dde7a12fef5738615f88","slug":"zl/2016-01-01-949_Lua初识","date":"2024-04-03T03:47:36.224Z","updated":"2024-04-03T03:47:36.224Z","comments":true,"path":"api/articles/zl/2016-01-01-949_Lua初识.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","content":"<h2 id=\"Lua初识\"><a href=\"#Lua初识\" class=\"headerlink\" title=\"Lua初识\"></a>Lua初识</h2><h3 id=\"Lua-数据类型\"><a href=\"#Lua-数据类型\" class=\"headerlink\" title=\"Lua 数据类型\"></a>Lua 数据类型</h3><ul><li>8种基本类型:</li><li>nil :表示无效值(条件表达式代表false)</li><li>boolean:布尔 包含两个值:true和false</li><li>number: 表示双精度类型的实浮点数</li><li>string: 字符串有””或者’’表示</li><li>userdata: 任意存储中的C数据结构</li><li>function: Lua或C编写的函数</li><li>thread: 执行独立线路,执行协同程序</li><li>table: 关联数据(associative arrays),索引是数字或者字符串,table的创建通过”构造表达式”来完成,最简单构造表达式{}(创建一个空表)</li></ul><h4 id=\"nil\"><a href=\"#nil\" class=\"headerlink\" title=\"nil\"></a>nil</h4><figure class=\"highlight plain\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\">nil:空</span><br/><span class=\"line\"> print(type(x)==&#34;nil&#34;) true</span><br/><span class=\"line\"> print(typeI(x)==nil) false</span><br/><span class=\"line\"> 注: type(X)==nil 结果为 false 的原因是因为 type(type(X))==string</span><br/></pre></td></tr></tbody></table></figure><h4 id=\"number\"><a href=\"#number\" class=\"headerlink\" title=\"number\"></a>number</h4><figure class=\"highlight plain\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/><span class=\"line\">5</span><br/><span class=\"line\">6</span><br/><span class=\"line\">7</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\">number类型--双精度类型(默认类型修改luaconf.h文中定义)</span><br/><span class=\"line\">例如:</span><br/><span class=\"line\">print(type(2))</span><br/><span class=\"line\">print(type(2.2))</span><br/><span class=\"line\">print(type(0.2))</span><br/><span class=\"line\">print(type(2e+1))</span><br/><span class=\"line\">print(type(2.1231231465e-06))</span><br/></pre></td></tr></tbody></table></figure><h4 id=\"string\"><a href=\"#string\" class=\"headerlink\" title=\"string\"></a>string</h4><figure class=\"highlight plain\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/><span class=\"line\">5</span><br/><span class=\"line\">6</span><br/><span class=\"line\">7</span><br/><span class=\"line\">8</span><br/><span class=\"line\">9</span><br/><span class=\"line\">10</span><br/><span class=\"line\">11</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\">用 [[]] 表示一块字符串</span><br/><span class=\"line\">例如:</span><br/><span class=\"line\">html = [[</span><br/><span class=\"line\">    &lt;html&gt;</span><br/><span class=\"line\">    &lt;head&gt;&lt;/head&gt;</span><br/><span class=\"line\">    &lt;body&gt;</span><br/><span class=\"line\">        &lt;a href=&#34;https://herb95.github.io/&#34;&gt;Graywolf 博客&lt;/a&gt;</span><br/><span class=\"line\">    &lt;/body&gt;</span><br/><span class=\"line\">    &lt;/html&gt;</span><br/><span class=\"line\">]]</span><br/><span class=\"line\">print(html)</span><br/></pre></td></tr></tbody></table></figure><h4 id=\"运算\"><a href=\"#运算\" class=\"headerlink\" title=\"运算\"></a>运算</h4><figure class=\"highlight plain\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/><span class=\"line\">5</span><br/><span class=\"line\">6</span><br/><span class=\"line\">7</span><br/><span class=\"line\">8</span><br/><span class=\"line\">9</span><br/><span class=\"line\">10</span><br/><span class=\"line\">11</span><br/><span class=\"line\">12</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\">数字,字符串上进行运算</span><br/><span class=\"line\">print(&#34;3&#34;+9)</span><br/><span class=\"line\">print(&#34;3&#34;+&#34;9&#34;)</span><br/><span class=\"line\">print(&#34;3+9&#34;)</span><br/><span class=\"line\">print(&#34;-2e2&#34;*9)</span><br/><span class=\"line\">print(&#34;e&#34;+2)</span><br/><span class=\"line\">结果:</span><br/><span class=\"line\">12</span><br/><span class=\"line\">12</span><br/><span class=\"line\">3+9</span><br/><span class=\"line\">-1800</span><br/><span class=\"line\">error...</span><br/></pre></td></tr></tbody></table></figure><p><strong>注:字符串连接使用是 ..</strong><br/><strong>注:用#来计算字符串的长度</strong></p><h4 id=\"运用\"><a href=\"#运用\" class=\"headerlink\" title=\"# 运用\"></a># 运用</h4><figure class=\"highlight plain\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/><span class=\"line\">5</span><br/><span class=\"line\">6</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\">len=&#34;herb95.github.io/&#34;</span><br/><span class=\"line\">print(#len)</span><br/><span class=\"line\">print(#&#34;herb95.github.io/&#34;)</span><br/><span class=\"line\">结果:</span><br/><span class=\"line\">17</span><br/><span class=\"line\">17</span><br/></pre></td></tr></tbody></table></figure><h4 id=\"table\"><a href=\"#table\" class=\"headerlink\" title=\"table\"></a>table</h4><figure class=\"highlight plain\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/><span class=\"line\">5</span><br/><span class=\"line\">6</span><br/><span class=\"line\">7</span><br/><span class=\"line\">8</span><br/><span class=\"line\">9</span><br/><span class=\"line\">10</span><br/><span class=\"line\">11</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\">tab1 ={}</span><br/><span class=\"line\">-- 直接初始化</span><br/><span class=\"line\">tab2 ={&#34;1&#34;,&#34;2&#34;,&#34;3&#34;,&#34;4&#34;}</span><br/><span class=\"line\">for k,v in pairs(tab2) do</span><br/><span class=\"line\">    print(k.. &#34;:&#34; .. v)</span><br/><span class=\"line\">end</span><br/><span class=\"line\">结果:</span><br/><span class=\"line\">1:1</span><br/><span class=\"line\">2:2</span><br/><span class=\"line\">3:3</span><br/><span class=\"line\">4:4</span><br/></pre></td></tr></tbody></table></figure><p><strong>注:lua表默认初始索引一般以1开始</strong><br/><strong>table不会固定长度大小,有新数据添加table长度会自动增长,没初始的table都是nil</strong></p><h4 id=\"function\"><a href=\"#function\" class=\"headerlink\" title=\"function\"></a>function</h4><figure class=\"highlight plain\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/><span class=\"line\">5</span><br/><span class=\"line\">6</span><br/><span class=\"line\">7</span><br/><span class=\"line\">8</span><br/><span class=\"line\">9</span><br/><span class=\"line\">10</span><br/><span class=\"line\">11</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\">-- function 函数是被看做事&#34;第一类值(First-Class Value),可存变量&#34;:</span><br/><span class=\"line\">例如:</span><br/><span class=\"line\">function add(a,b)</span><br/><span class=\"line\">   return a+b</span><br/><span class=\"line\">end</span><br/><span class=\"line\">print(add(10,20))</span><br/><span class=\"line\">add2 = add</span><br/><span class=\"line\">print(add(10,30))</span><br/><span class=\"line\">结果:</span><br/><span class=\"line\">30</span><br/><span class=\"line\">40</span><br/></pre></td></tr></tbody></table></figure><p>function 可以做匿名函数(anonymous function)的方式参数传递:<br/></p><figure class=\"highlight plain\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/><span class=\"line\">5</span><br/><span class=\"line\">6</span><br/><span class=\"line\">7</span><br/><span class=\"line\">8</span><br/><span class=\"line\">9</span><br/><span class=\"line\">10</span><br/><span class=\"line\">11</span><br/><span class=\"line\">12</span><br/><span class=\"line\">13</span><br/><span class=\"line\">14</span><br/><span class=\"line\">15</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\">function testFun(tab,fun)</span><br/><span class=\"line\">    for k,v in pairs(tab) do</span><br/><span class=\"line\">        print(fun(k,v))</span><br/><span class=\"line\">    end</span><br/><span class=\"line\">end</span><br/><span class=\"line\"></span><br/><span class=\"line\">tab1 = {k1= &#34;1&#34;,k2 = &#34;3&#34;};</span><br/><span class=\"line\">testFun(tab1,</span><br/><span class=\"line\">function(k,v)</span><br/><span class=\"line\">    return k..&#34;=&#34;..v</span><br/><span class=\"line\">end</span><br/><span class=\"line\">)</span><br/><span class=\"line\">结果:</span><br/><span class=\"line\">k1=1</span><br/><span class=\"line\">k2=3</span><br/></pre></td></tr></tbody></table></figure><p></p><h4 id=\"thread线程\"><a href=\"#thread线程\" class=\"headerlink\" title=\"thread线程\"></a>thread线程</h4><p>lua中最主要的线程是协同程序(coroutine),跟线程(thread)差不多,拥有自己独立的栈、 局部变量和指令指针，可与其他协同程序共享全局变量<br/>线程和协程的区别：</p><blockquote><ul><li>线程可以多个运行；</li><li>协程任意时刻只能运行一个，并且处于运行状态的协程只有被挂起(suspend)时才会暂停</li></ul></blockquote><h4 id=\"userdata-自定义类型\"><a href=\"#userdata-自定义类型\" class=\"headerlink\" title=\"userdata (自定义类型)\"></a>userdata (自定义类型)</h4><p>是一种用户自定义数据,表示一种有应用程序或C/C++语言库创建类型,将任意C/C++任意数据类型的数据(通常是struct和指针) 存到lua变量中调用</p>","text":"Lua初识Lua 数据类型8种基本类型:nil :表示无效值(条件表达式代表false)boolean:布尔 包含两个值:true和falsenumber: 表示双精度类型的实浮点数string: 字符串有””或者’’表示userdata: 任意存储中的C数据结构function...","link":"","photos":[],"count_time":{"symbolsCount":"1.9k","symbolsTime":"2 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Lua%E5%88%9D%E8%AF%86\"><span class=\"toc-text\">Lua初识</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#Lua-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B\"><span class=\"toc-text\">Lua 数据类型</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#nil\"><span class=\"toc-text\">nil</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#number\"><span class=\"toc-text\">number</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#string\"><span class=\"toc-text\">string</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E8%BF%90%E7%AE%97\"><span class=\"toc-text\">运算</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E8%BF%90%E7%94%A8\"><span class=\"toc-text\"># 运用</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#table\"><span class=\"toc-text\">table</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#function\"><span class=\"toc-text\">function</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#thread%E7%BA%BF%E7%A8%8B\"><span class=\"toc-text\">thread线程</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#userdata-%E8%87%AA%E5%AE%9A%E4%B9%89%E7%B1%BB%E5%9E%8B\"><span class=\"toc-text\">userdata (自定义类型)</span></a></li></ol></li></ol></li></ol>","author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"wrk搭配lua脚本，个性化压测","uid":"5169212eef43cfe5f6352b48192f0e28","slug":"zl/2016-01-01-951_wrk搭配lua脚本，个性化压测","date":"2024-04-03T03:47:36.225Z","updated":"2024-04-03T03:47:36.226Z","comments":true,"path":"api/articles/zl/2016-01-01-951_wrk搭配lua脚本，个性化压测.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":"压测工具 wrk wrk -t2 -c10 -d10s -s wrk.lua http://www.baidu.com apache benchmark：性能基准测试时使用 Hey：go实现的压测工具 http_load： http_load -p 100 -s 10 urls ...","link":"","photos":[],"count_time":{"symbolsCount":"3.4k","symbolsTime":"3 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"最近关于Lua的学习篇总结（一）","uid":"30ad5177d69434cf9fff05c2b0dc614a","slug":"zl/2016-01-01-94_最近关于Lua的学习篇总结（一）","date":"2024-04-03T03:47:36.224Z","updated":"2024-04-03T03:47:36.225Z","comments":true,"path":"api/articles/zl/2016-01-01-94_最近关于Lua的学习篇总结（一）.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":" Contents &lt;/div&gt; &lt;h1 id=&quot;1-Lua在游戏的作用&quot;&gt;&lt;a href=&quot;#1-Lua在游戏的作用&quot; class=&quot;headerlink&quot; title=&quot;1.L...","link":"","photos":[],"count_time":{"symbolsCount":"2.1k","symbolsTime":"2 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}}}