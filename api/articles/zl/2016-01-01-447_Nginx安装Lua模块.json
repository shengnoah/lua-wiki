{"title":"Nginx安装Lua模块","uid":"ae334ff60bb22fb2ed5701f79313d113","slug":"zl/2016-01-01-447_Nginx安装Lua模块","date":"2024-04-03T03:47:35.729Z","updated":"2024-04-03T03:47:35.729Z","comments":true,"path":"api/articles/zl/2016-01-01-447_Nginx安装Lua模块.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","content":"<h3 id=\"NGINX安装LUA（基于LNMP）：\"><a href=\"#NGINX安装LUA（基于LNMP）：\" class=\"headerlink\" title=\"NGINX安装LUA（基于LNMP）：\"></a>NGINX安装LUA（基于LNMP）：</h3><p>1.下载安装LuaJIT 2.1：<a href=\"http://luajit.org/download.html\" target=\"_blank\" rel=\"noopener noreferrer\">http://luajit.org/download.html</a></p>\n<figure class=\"highlight sh\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/><span class=\"line\">4</span><br/><span class=\"line\">5</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\">wget http://luajit.org/download/LuaJIT-2.1.0-beta3.tar.gz</span><br/><span class=\"line\">tar zxf LuaJIT-2.1.0-beta3.tar.gz</span><br/><span class=\"line\"><span class=\"built_in\">cd</span> LuaJIT-2.1.0-beta3</span><br/><span class=\"line\">make PREFIX=/usr/<span class=\"built_in\">local</span>/luajit</span><br/><span class=\"line\">make install PREFIX=/usr/<span class=\"built_in\">local</span>/luajit</span><br/></pre></td></tr></tbody></table></figure>\n<p>2.下载最新的ngx_devel_kit（NDK）模块：<a href=\"https://github.com/simpl/ngx_devel_kit/tags\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/simpl/ngx_devel_kit/tags</a></p>\n<figure class=\"highlight sh\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://github.com/simpl/ngx_devel_kit/archive/v0.3.0.tar.gz</span><br/><span class=\"line\">tar -xzvf v0.3.0.tar.gz</span><br/></pre></td></tr></tbody></table></figure>\n<p>3.下载最新的lua-nginx-module 模块：<a href=\"https://github.com/openresty/lua-nginx-module/tags\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/openresty/lua-nginx-module/tags</a></p>\n<figure class=\"highlight sh\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://github.com/openresty/lua-nginx-module/archive/v0.10.11.tar.gz</span><br/><span class=\"line\">tar -xzvf v0.10.11.tar.gz</span><br/></pre></td></tr></tbody></table></figure>\n<p>然后执行以下命令</p>\n<figure class=\"highlight sh\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/><span class=\"line\">2</span><br/><span class=\"line\">3</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br/><span class=\"line\"><span class=\"built_in\">export</span> LUAJIT_LIB=/usr/<span class=\"built_in\">local</span>/luajit/lib</span><br/><span class=\"line\"><span class=\"built_in\">export</span> LUAJIT_INC=/usr/<span class=\"built_in\">local</span>/luajit/include/luajit-2.1</span><br/></pre></td></tr></tbody></table></figure>\n<p>接下来我们就要开始升级nginx版本了，在升级nginx版本之前，想进入lnmp的解压包，我们要在lnmp一键包目录下的lnmp.conf文件里的Nginx_Modules_Options加上编译参数：</p>\n<figure class=\"highlight sh\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br/></pre></td><td class=\"code\"><pre><span class=\"line\">Nginx_Modules_Options=<span class=\"string\">&#39;--with-ld-opt=-Wl,-rpath,/usr/local/luajit/lib --add-module=/root/lua-nginx-module-0.10.11 --add-module=/root/ngx_devel_kit-0.3.0&#39;</span></span><br/></pre></td></tr></tbody></table></figure>\n<p>加上以上这段参数之后，我们就使用lnmp一键包中的./upgrade.sh nginx升级脚本升级一遍nginx即可完成lua扩展的安装。等重新编译完，nginx中就能使用lua扩展了。</p>","text":"NGINX安装LUA（基于LNMP）：1.下载安装LuaJIT 2.1：http://luajit.org/download.html 12345wget http://luajit.org/download/LuaJIT-2.1.0-beta3.tar.gztar zxf Lu...","link":"","photos":[],"count_time":{"symbolsCount":"1.1k","symbolsTime":"1 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#NGINX%E5%AE%89%E8%A3%85LUA%EF%BC%88%E5%9F%BA%E4%BA%8ELNMP%EF%BC%89%EF%BC%9A\"><span class=\"toc-text\">NGINX安装LUA（基于LNMP）：</span></a></li></ol>","author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"nginx lua waf","uid":"b7629b20ac900d8f1fafabf105306db6","slug":"zl/2016-01-01-44_nginx lua waf","date":"2024-04-03T03:47:35.733Z","updated":"2024-04-03T03:47:35.733Z","comments":true,"path":"api/articles/zl/2016-01-01-44_nginx lua waf.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":"ngx_lua_waf是一个基于lua-nginx-module(openresty)的web应用防火墙###用途： 防止sql注入，本地包含，部分溢出，fuzzing测试，xss,SSRF等web攻击 防止svn/备份之类文件泄漏 防止ApacheBench之类压力测试工具的攻...","link":"","photos":[],"count_time":{"symbolsCount":"2.1k","symbolsTime":"2 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"openresty的lua语法学习一","uid":"df8e57e9978129be635de09ab0e93a6f","slug":"zl/2016-01-01-448_openresty的lua语法学习一","date":"2024-04-03T03:47:35.729Z","updated":"2024-04-03T03:47:35.729Z","comments":true,"path":"api/articles/zl/2016-01-01-448_openresty的lua语法学习一.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":" openresty的lua语法学习 lua的popen获取命令的执行结果 1234567891011121314151617181920212223242526272829local myfile = io.popen(&#34;pwd&#34;, &#34;r&#34;)if...","link":"","photos":[],"count_time":{"symbolsCount":"4.8k","symbolsTime":"4 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}}}