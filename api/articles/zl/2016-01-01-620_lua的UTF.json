{"title":"lua的UTF","uid":"b1f2088da0ae9618f55020f2c2571b91","slug":"zl/2016-01-01-620_lua的UTF","date":"2024-04-03T03:47:35.843Z","updated":"2024-04-03T03:47:35.846Z","comments":true,"path":"api/articles/zl/2016-01-01-620_lua的UTF.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","content":"<p>大家知道utf8的每个字符并不是定长，所以在处理中文字符截取是会出现很多麻烦，直接substring的话最后一个字符一般都会是乱码，而且长度也不对，lua没有截取UTF8中文字符的相关函数，我们只能自己写一个：</p>\n<p>取前200个中文字符  </p>\n<pre><code>for uchar in string.gfind(string.sub(data.response.docs[i].content,sp), ‘[%z1-127194-244][128-191]*’) do\n     tab[#tab+1] = uchar \nend\nfor j=1,200,1 do\n    if tab[j]~=nil then\n        endp=endp..tab[j]\n    end\nend\n</code></pre>\n<p>通过正则来判断每个UTF8字符的结尾，这个utf8结尾标志就在[%z1-127194-244][128-191]*这个正则里。<br/>另：在处理ngx.location.capture去请求包含proxy_pass的子请求是，需要关闭gzip</p>","text":"大家知道utf8的每个字符并不是定长，所以在处理中文字符截取是会出现很多麻烦，直接substring的话最后一个字符一般都会是乱码，而且长度也不对，lua没有截取UTF8中文字符的相关函数，我们只能自己写一个： 取前200个中文字符 for uchar in string.gfi...","link":"","photos":[],"count_time":{"symbolsCount":451,"symbolsTime":"1 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"toc":"","author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"作业_4 leetcode 399 Evaluate Division","uid":"63a0a9fe79470d07d1ac5d06f7be4a95","slug":"zl/2016-01-01-621_作业_4 leetcode 399 Evaluate Division","date":"2024-04-03T03:47:35.846Z","updated":"2024-04-03T03:47:35.846Z","comments":true,"path":"api/articles/zl/2016-01-01-621_作业_4 leetcode 399 Evaluate Division.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":"题干Equations are given in the format A / B = k, where A and B are variables represented as strings, and k is a real number (floating point nu...","link":"","photos":[],"count_time":{"symbolsCount":"3.5k","symbolsTime":"3 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"Lua中and,or的一些特殊用法｜qiuzhong's blog","uid":"2e7a106177f3150a51d2f073e0ca6890","slug":"zl/2016-01-01-619_Lua中and,or的一些特殊用法｜qiuzhong's blog","date":"2024-04-03T03:47:35.842Z","updated":"2024-04-03T03:47:35.842Z","comments":true,"path":"api/articles/zl/2016-01-01-619_Lua中and,or的一些特殊用法｜qiuzhong's blog.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":"先说and：我们知道and是取与，与就是0 and 0 = 0、0 and 1 = 0、1 and 1 = 1，也就是说有一个为0值就为0，全为1表达式值才为1，所以，当and的第一个操作数为0的时候，我们就没有必要看后面的操作数了，此时表达式的值已经为0，我们就把第一个为0的操...","link":"","photos":[],"count_time":{"symbolsCount":506,"symbolsTime":"1 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua文章","slug":"lua文章","count":1133,"path":"api/tags/lua文章.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}}}