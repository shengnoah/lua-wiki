{"title":"Lua表","uid":"038bf88a1c7598385fc79ad2a48f60ba","slug":"lua/2016-06-01-tables","date":"2024-03-14T06:15:59.726Z","updated":"2024-03-14T06:15:59.726Z","comments":true,"path":"api/articles/lua/2016-06-01-tables.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":null,"content":"<h1 id=\"Lua-表\"><a href=\"#Lua-表\" class=\"headerlink\" title=\"Lua 表\"></a>Lua 表</h1><p>在 Lua 语言中，表是唯一可以用来创建不同数据类型的数据结构，比如常见的数组和字典都是用表来创建的。 Lua 语言中经常到关联数组这种数据类型，它不仅可以用数值作为索引值，除了 nil 以外的字符串同样可以作为其索引。表没有固定的大小，当数据量增加时表会自动增大。  </p>\n<p>Lua 语言中的各种结构表示都用到了表，包括包（package）的表示。当我们使用方法 string.format 时，我们用到的其实是包 string 中的方法 format。  </p>\n<h2 id=\"使用表\"><a href=\"#使用表\" class=\"headerlink\" title=\"使用表\"></a>使用表</h2><p>表被称之为对象，它既不是值也不是变量。Lua 用构造表达式 {} 创建一个空表。需要注意的是，在存储表的变量和表本身之间没有什么固定的对应关系（译注：一个表可以被不同的变量引用，一个变量也可以随时改变其所引用的表对象）。  </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">--简单的表初始化</span><br><span class=\"line\">mytable = &#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">--简单的表赋值</span><br><span class=\"line\">mytable[1]= &quot;Lua&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">--移除引用</span><br><span class=\"line\">mytable = nil</span><br><span class=\"line\">-- lua 的垃圾回收机制负责回收内存空间</span><br><span class=\"line\">```  </span><br><span class=\"line\"></span><br><span class=\"line\">当我们有一个拥有一系列元素的表时，如果我们将其赋值给 b。那么 a 和 b 都会引用同一个表对象(a 先引用该表)，指向相同的内存空间。而不会再单独为 b 分配内存空间。即使给变量 a 赋值 nil，我们仍然可以用变量 b 访问表本身。如果已经没有变量引用表时，Lua　语言垃圾回收机制负责回收不再使用的内存以被重复使用。</span><br><span class=\"line\">  </span><br><span class=\"line\">下面的示例代码使用到了上面提到的表的特性。　　</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>– 声明空表<br>mytable = {}<br>print(“Type of mytable is “,type(mytable))</p>\n<p>mytable[1]= “Lua”<br>mytable[“wow”] = “Tutorial”<br>print(“mytable Element at index 1 is “, mytable[1])<br>print(“mytable Element at index wow is “, mytable[“wow”])</p>\n<p>– alternatetable 与 mytable 引用相同的表<br>alternatetable = mytable</p>\n<p>print(“alternatetable Element at index 1 is “, alternatetable[1])<br>print(“mytable Element at index wow is “, alternatetable[“wow”])</p>\n<p>alternatetable[“wow”] = “I changed it”</p>\n<p>print(“mytable Element at index wow is “, mytable[“wow”])</p>\n<p>– 只是变量被释放，表本身没有被释放<br>alternatetable = nil<br>print(“alternatetable is “, alternatetable)</p>\n<p>– mytable 仍然可以访问<br>print(“mytable Element at index wow is “, mytable[“wow”])</p>\n<p>mytable = nil<br>print(“mytable is “, mytable)</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">执行上面的代码，我们可以得到如下的输出结果：  </span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>Type of mytable is     table<br>mytable Element at index 1 is     Lua<br>mytable Element at index wow is     Tutorial<br>alternatetable Element at index 1 is     Lua<br>mytable Element at index wow is     Tutorial<br>mytable Element at index wow is     I changed it<br>alternatetable is     nil<br>mytable Element at index wow is     I changed it<br>mytable is     nil</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">## 表的操作函数  </span><br><span class=\"line\"></span><br><span class=\"line\">下面的表中列出了 Lua 语言内置的表操作函数，具体内容如下所示：  </span><br><span class=\"line\"></span><br><span class=\"line\">&lt;table&gt;</span><br><span class=\"line\">\t&lt;tr&gt;</span><br><span class=\"line\">\t\t&lt;th&gt;S.N.&lt;/th&gt;</span><br><span class=\"line\">\t\t&lt;th&gt;方法与作用&lt;/th&gt;</span><br><span class=\"line\">\t&lt;/tr&gt;</span><br><span class=\"line\">\t&lt;tr&gt;</span><br><span class=\"line\">\t\t&lt;td&gt;1&lt;/td&gt;</span><br><span class=\"line\">\t\t&lt;td&gt;table.concat(table[, sep [, i[,j]]]): 根据指定的参数合并表中的字符串。具体用法参考下面的示例。&lt;/td&gt;</span><br><span class=\"line\">\t&lt;/tr&gt;</span><br><span class=\"line\">\t&lt;tr&gt;</span><br><span class=\"line\">\t\t&lt;td&gt;2&lt;/td&gt;</span><br><span class=\"line\">\t\t&lt;td&gt;table.insert(table,[pos,]value):在表中指定位置插入一个值。&lt;/td&gt;</span><br><span class=\"line\">\t&lt;/tr&gt;</span><br><span class=\"line\">\t&lt;tr&gt;</span><br><span class=\"line\">\t\t&lt;td&gt;3&lt;/td&gt;</span><br><span class=\"line\">\t\t&lt;td&gt;table.maxn(table)：返回表中最大的数值索引。&lt;/td&gt;</span><br><span class=\"line\">\t&lt;/tr&gt;</span><br><span class=\"line\">\t&lt;tr&gt;</span><br><span class=\"line\">\t\t&lt;td&gt;4&lt;/td&gt;</span><br><span class=\"line\">\t\t&lt;td&gt;table.remove(table[,pos]):从表中移出指定的值。&lt;/td&gt;</span><br><span class=\"line\">\t&lt;/tr&gt;\t&lt;tr&gt;</span><br><span class=\"line\">\t\t&lt;td&gt;5&lt;/td&gt;</span><br><span class=\"line\">\t\t&lt;td&gt;table.sort(table[,comp]):根据指定的（可选）比较方法对表进行排序操作。&lt;/td&gt;</span><br><span class=\"line\">\t&lt;/tr&gt;</span><br><span class=\"line\">&lt;/table&gt;  </span><br><span class=\"line\"></span><br><span class=\"line\">让我们一起看一些上述函数使用的例子。  </span><br><span class=\"line\"></span><br><span class=\"line\">### 表连接操作  </span><br><span class=\"line\"></span><br><span class=\"line\">我们可以使用表连接操作连接表中的元素，如下所示。  </span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>fruits = {“banana”,”orange”,”apple”}<br>– 返回表中字符串连接后的结果<br>print(“Concatenated string “,table.concat(fruits))</p>\n<p>–用字符串连接<br>print(“Concatenated string “,table.concat(fruits,”, “))</p>\n<p>–基于索引连接 fruits<br>print(“Concatenated string “,table.concat(fruits,”, “, 2,3))</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">执行上面的代码，我们可以得到如下的输出结果：  </span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>Concatenated string     bananaorangeapple<br>Concatenated string     banana, orange, apple<br>Concatenated string     orange, apple</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">### 插入与移出操作  </span><br><span class=\"line\"></span><br><span class=\"line\">插入和移除表中元素是对表最常见的操作。使用方法如下所示：  </span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>fruits = {“banana”,”orange”,”apple”}</p>\n<p>– 在 fruits 的末尾插入一种水果<br>table.insert(fruits,”mango”)<br>print(“Fruit at index 4 is “,fruits[4])</p>\n<p>– 在索引 2 的位置插入一种水果<br>table.insert(fruits,2,”grapes”)<br>print(“Fruit at index 2 is “,fruits[2])</p>\n<p>print(“The maximum elements in table is”,table.maxn(fruits))</p>\n<p>print(“The last element is”,fruits[5])<br>table.remove(fruits)<br>print(“The previous last element is”,fruits[5])</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">执行上面的代码，我们可以得到如下的输出结果：  </span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>Fruit at index 4 is     mango<br>Fruit at index 2 is     grapes<br>The maximum elements in table is    5<br>The last element is    mango<br>The previous last element is    nil</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">### 表排序操作  </span><br><span class=\"line\"></span><br><span class=\"line\">在程序开发过程中，常常有对表排序的需求。 sort 函数默认使用字母表对表中的元素进行排序（可以通过提供比较函数改变排序策略）。示例代码如下：  </span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>fruits = {“banana”,”orange”,”apple”,”grapes”}<br>for k,v in ipairs(fruits) do<br>print(k,v)<br>end<br>table.sort(fruits)<br>print(“sorted table”)<br>for k,v in ipairs(fruits) do<br>print(k,v)<br>end</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">执行上面的代码，我们可以得到如下的输出结果：  </span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>1    banana<br>2    orange<br>3    apple<br>4    grapes<br>sorted table<br>1    apple<br>2    banana<br>3    grapes<br>4    orange<br>```  </p>\n","text":"Lua 表在 Lua 语言中，表是唯一可以用来创建不同数据类型的数据结构，比如常见的数组和字典都是用表来创建的。 Lua 语言中经常到关联数组这种数据类型，它不仅可以用数值作为索引值，除了 nil 以外的字符串同样可以作为其索引。表没有固定的大小，当数据量增加时表会自动增大。 L...","link":"","photos":[],"count_time":{"symbolsCount":"4k","symbolsTime":"4 mins."},"categories":[{"name":"lua_guide","slug":"lua-guide","count":68,"path":"api/categories/lua-guide.json"}],"tags":[{"name":"lua","slug":"lua","count":153,"path":"api/tags/lua.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#Lua-%E8%A1%A8\"><span class=\"toc-text\">Lua 表</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%BD%BF%E7%94%A8%E8%A1%A8\"><span class=\"toc-text\">使用表</span></a></li></ol></li></ol>","author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"Lua字符串","uid":"cedbdf206a63ba0896535fb39f386996","slug":"lua/2016-06-01-strings","date":"2024-03-14T06:15:59.726Z","updated":"2024-03-14T06:15:59.726Z","comments":true,"path":"api/articles/lua/2016-06-01-strings.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":null,"text":"Lua 字符串字符串就是一个由字符或控制字符组成的序列。字符串可以用以下三种方式任意一种进行初始化。 单引号字符串 双引号字符串 [[和]]之间的字符串 上面三种初始化方式的示例如下： 1234567891011string1 = &quot;Lua&quot;print(&qu...","link":"","photos":[],"count_time":{"symbolsCount":"5k","symbolsTime":"5 mins."},"categories":[{"name":"lua_guide","slug":"lua-guide","count":68,"path":"api/categories/lua-guide.json"}],"tags":[{"name":"lua","slug":"lua","count":153,"path":"api/tags/lua.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"Lua标准库","uid":"fa374b256846497ad36372533ba9888a","slug":"lua/2016-06-01-standard-libraries","date":"2024-03-14T06:15:59.726Z","updated":"2024-03-14T06:15:59.726Z","comments":true,"path":"api/articles/lua/2016-06-01-standard-libraries.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":null,"text":"Lua 标准库Lua 标准库利用 C 语言 API 实现并提供了丰富的函数，它们内置于 Lua 语言中。该标准库不仅可以提供 Lua 语言内服务，还能提供外部服务，比如文件或数据库的操作。 这些标准库使用标准的 C API 接口实现，它们作为独立的 C 语言模块提供给使用者。主要...","link":"","photos":[],"count_time":{"symbolsCount":"2.8k","symbolsTime":"3 mins."},"categories":[{"name":"lua_guide","slug":"lua-guide","count":68,"path":"api/categories/lua-guide.json"}],"tags":[{"name":"lua","slug":"lua","count":153,"path":"api/tags/lua.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}}}