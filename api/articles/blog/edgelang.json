{"title":"一种小语言Edgelang","uid":"cb9d1e5e022c207d55ccf114e6e4aa69","slug":"blog/edgelang","date":"2024-03-14T06:15:59.712Z","updated":"2024-03-14T06:15:59.712Z","comments":true,"path":"api/articles/blog/edgelang.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":null,"content":"<p>找回了当时测试时用OpenResty Edgelang的代码。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uri contains &quot;SQL&quot;=&gt;</span><br><span class=\"line\">\tset-upstream(&#x27;HoneyPot_1&#x27;);\t</span><br><span class=\"line\">\treq-header(&quot;Content-Type&quot;) contains &quot;multipart/form-data&quot;,</span><br><span class=\"line\">\treq-header(&quot;Content-Type&quot;) !contains rx&#123;^multipart/form-data[\\s\\S]+&#125; =&gt;</span><br><span class=\"line\">\twaf-mark-evil(message: &quot;CVE-2017-5638 Struts&quot;, level: &quot;super&quot;),</span><br><span class=\"line\">\tset-upstream(&#x27;HoneyPot_2&#x27;);</span><br><span class=\"line\"></span><br><span class=\"line\">uri(&quot;/shop&quot;), client-province(&#x27;Guangdong&#x27;),</span><br><span class=\"line\">\tua-is-mobile() =&gt;</span><br><span class=\"line\">\tlimit-req-rate(key: client-addr, target-rate: 5 [r/s], reject-rate: 10 [r/s]), limit-resp-data-rate(441 [mB/s]);</span><br><span class=\"line\"></span><br><span class=\"line\">uri(&quot;/shop&quot;), client-country(&quot;US&quot;) =&gt;</span><br><span class=\"line\">\tlimit-req-rate(key: client-addr, target-rate: 5 [r/s], reject-rate: 10 [r/s]), sleep(0.5);</span><br><span class=\"line\"></span><br><span class=\"line\">req-header(“Content-Type”) contains “multipart/form-data”,</span><br><span class=\"line\">req-header(“Content-Type”) !contains rx&#123;^multipart/form-data[\\s\\S]+&#125; =&gt;</span><br><span class=\"line\">\twaf-mark-evil(message: &quot;CVE-XXX-XXX &quot;, level: &quot;super&quot;),</span><br></pre></td></tr></table></figure>\n\n","text":"找回了当时测试时用OpenResty Edgelang的代码。 1234567891011121314151617uri contains &quot;SQL&quot;=&gt; set-upstream(&#x27;HoneyPot_1&#x27;); req-header(...","link":"","photos":[],"count_time":{"symbolsCount":993,"symbolsTime":"1 mins."},"categories":[{"name":"文章","slug":"文章","count":22,"path":"api/categories/文章.json"}],"tags":[{"name":"OpenResty","slug":"OpenResty","count":1,"path":"api/tags/OpenResty.json"}],"toc":"","author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"绕过CDN查找真实IP方法","uid":"bcd4403de43b8cbd12066144ee39876d","slug":"blog/cdn-ip","date":"2024-03-14T06:15:59.712Z","updated":"2024-03-14T06:15:59.712Z","comments":true,"path":"api/articles/blog/cdn-ip.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":[],"text":"相信大家平时在做渗透测试时，经常会碰到部署了CDN的网站，我们有时候想要获取某站的源站ip，方法有很多，今天我给大家总结一下，赠人玫瑰，手有余香。 CDN简介：CDN的全称是Content Delivery Network，即内容分发网络。CDN是构建在现有网络基础之上的智能虚拟...","link":"","photos":[],"count_time":{"symbolsCount":"3.7k","symbolsTime":"3 mins."},"categories":[{"name":"文章","slug":"文章","count":22,"path":"api/categories/文章.json"}],"tags":[{"name":"安全技术","slug":"安全技术","count":2,"path":"api/tags/安全技术.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"ElasticSearch最大返回结果量大小设置","uid":"70e08f36c56f78f54175b098fc27d77a","slug":"blog/elasticsearch","date":"2024-03-14T06:15:59.712Z","updated":"2024-03-14T06:15:59.712Z","comments":true,"path":"api/articles/blog/elasticsearch.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":null,"text":"123curl -H &quot;Content-Type: application/json&quot; -XPUT &#x27;http://192.168.0.5:9205/_all/_settings?preserve_existing=true&#x27; -d &#x...","link":"","photos":[],"count_time":{"symbolsCount":221,"symbolsTime":"1 mins."},"categories":[{"name":"文章","slug":"文章","count":22,"path":"api/categories/文章.json"}],"tags":[{"name":"ElasticSearch","slug":"ElasticSearch","count":1,"path":"api/tags/ElasticSearch.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}}}