{"title":"一种小语言Edgelang","uid":"cb9d1e5e022c207d55ccf114e6e4aa69","slug":"blog/edgelang","date":"2024-03-14T07:45:09.093Z","updated":"2024-03-18T04:45:52.938Z","comments":true,"path":"api/articles/blog/edgelang.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","content":"<p>找回了当时测试时用OpenResty Edgelang的代码。</p>\n<pre class=\"line-numbers language-lua\" data-language=\"lua\"><code class=\"language-lua\">uri contains <span class=\"token string\">\"SQL\"</span><span class=\"token operator\">=</span><span class=\"token operator\">></span>\n\tset<span class=\"token operator\">-</span><span class=\"token function\">upstream</span><span class=\"token punctuation\">(</span><span class=\"token string\">'HoneyPot_1'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\t\n\treq<span class=\"token operator\">-</span><span class=\"token function\">header</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Content-Type\"</span><span class=\"token punctuation\">)</span> contains <span class=\"token string\">\"multipart/form-data\"</span><span class=\"token punctuation\">,</span>\n\treq<span class=\"token operator\">-</span><span class=\"token function\">header</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Content-Type\"</span><span class=\"token punctuation\">)</span> !contains <span class=\"token function\">rx</span><span class=\"token punctuation\">&#123;</span><span class=\"token operator\">^</span>multipart<span class=\"token operator\">/</span>form<span class=\"token operator\">-</span>data<span class=\"token punctuation\">[</span>\\s\\S<span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span>\n\twaf<span class=\"token operator\">-</span>mark<span class=\"token operator\">-</span><span class=\"token function\">evil</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">:</span> <span class=\"token string\">\"CVE-2017-5638 Struts\"</span><span class=\"token punctuation\">,</span> level<span class=\"token punctuation\">:</span> <span class=\"token string\">\"super\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n\tset<span class=\"token operator\">-</span><span class=\"token function\">upstream</span><span class=\"token punctuation\">(</span><span class=\"token string\">'HoneyPot_2'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">uri</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/shop\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> client<span class=\"token operator\">-</span><span class=\"token function\">province</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Guangdong'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n\tua<span class=\"token operator\">-</span>is<span class=\"token operator\">-</span><span class=\"token function\">mobile</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span>\n\tlimit<span class=\"token operator\">-</span>req<span class=\"token operator\">-</span><span class=\"token function\">rate</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">:</span> client<span class=\"token operator\">-</span>addr<span class=\"token punctuation\">,</span> target<span class=\"token operator\">-</span>rate<span class=\"token punctuation\">:</span> <span class=\"token number\">5</span> <span class=\"token punctuation\">[</span>r<span class=\"token operator\">/</span>s<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> reject<span class=\"token operator\">-</span>rate<span class=\"token punctuation\">:</span> <span class=\"token number\">10</span> <span class=\"token punctuation\">[</span>r<span class=\"token operator\">/</span>s<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> limit<span class=\"token operator\">-</span>resp<span class=\"token operator\">-</span>data<span class=\"token operator\">-</span><span class=\"token function\">rate</span><span class=\"token punctuation\">(</span><span class=\"token number\">441</span> <span class=\"token punctuation\">[</span>mB<span class=\"token operator\">/</span>s<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">uri</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/shop\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> client<span class=\"token operator\">-</span><span class=\"token function\">country</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"US\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span>\n\tlimit<span class=\"token operator\">-</span>req<span class=\"token operator\">-</span><span class=\"token function\">rate</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">:</span> client<span class=\"token operator\">-</span>addr<span class=\"token punctuation\">,</span> target<span class=\"token operator\">-</span>rate<span class=\"token punctuation\">:</span> <span class=\"token number\">5</span> <span class=\"token punctuation\">[</span>r<span class=\"token operator\">/</span>s<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> reject<span class=\"token operator\">-</span>rate<span class=\"token punctuation\">:</span> <span class=\"token number\">10</span> <span class=\"token punctuation\">[</span>r<span class=\"token operator\">/</span>s<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">sleep</span><span class=\"token punctuation\">(</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nreq<span class=\"token operator\">-</span><span class=\"token function\">header</span><span class=\"token punctuation\">(</span>“Content<span class=\"token operator\">-</span>Type”<span class=\"token punctuation\">)</span> contains “multipart<span class=\"token operator\">/</span>form<span class=\"token operator\">-</span>data”<span class=\"token punctuation\">,</span>\nreq<span class=\"token operator\">-</span><span class=\"token function\">header</span><span class=\"token punctuation\">(</span>“Content<span class=\"token operator\">-</span>Type”<span class=\"token punctuation\">)</span> !contains <span class=\"token function\">rx</span><span class=\"token punctuation\">&#123;</span><span class=\"token operator\">^</span>multipart<span class=\"token operator\">/</span>form<span class=\"token operator\">-</span>data<span class=\"token punctuation\">[</span>\\s\\S<span class=\"token punctuation\">]</span><span class=\"token operator\">+</span><span class=\"token punctuation\">&#125;</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span>\n\twaf<span class=\"token operator\">-</span>mark<span class=\"token operator\">-</span><span class=\"token function\">evil</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">:</span> <span class=\"token string\">\"CVE-XXX-XXX \"</span><span class=\"token punctuation\">,</span> level<span class=\"token punctuation\">:</span> <span class=\"token string\">\"super\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n","text":"找回了当时测试时用OpenResty Edgelang的代码。 uri contains \"SQL\"=> set-upstream('HoneyPot_1'); req-header(\"Content-Type\") contains \"multipart/form-data\", ...","link":"","photos":[],"count_time":{"symbolsCount":828,"symbolsTime":"1 mins."},"categories":[{"name":"文章","slug":"文章","count":22,"path":"api/categories/文章.json"}],"tags":[{"name":"OpenResty","slug":"OpenResty","count":1,"path":"api/tags/OpenResty.json"}],"toc":"","author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"理解威胁情报与威胁数据分析","uid":"898ea7cfc21533e8cdd79b533fcbfa66","slug":"blog/attandck","date":"2024-03-14T07:45:09.093Z","updated":"2024-03-14T07:45:09.093Z","comments":true,"path":"api/articles/blog/attandck.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":" 1、如何理解威胁情报和数据分析 在企业安全运营中心建设阶段中我们期望通过汇总大量的安全日志事件分析安全数据和威胁映射。 获得攻击者所采用的各种攻击手段特别是遇到鱼叉攻击钓鱼邮件攻击这种问题时我们希望能够通过数据分析和挖掘的方式来追踪到对手的行为特征。 基于类似的use case...","link":"","photos":[],"count_time":{"symbolsCount":"1.2k","symbolsTime":"1 mins."},"categories":[{"name":"文章","slug":"文章","count":22,"path":"api/categories/文章.json"}],"tags":[{"name":"大数据安全","slug":"大数据安全","count":2,"path":"api/tags/大数据安全.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"SSH解决The authenticity of host xxx can't be established.","uid":"87b14f55648ecfc38c289ee95a9a3dbf","slug":"blog/jumperserver","date":"2024-03-14T07:45:09.093Z","updated":"2024-03-14T07:45:09.093Z","comments":true,"path":"api/articles/blog/jumperserver.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":"通道机突然出现了链接不上的情况，最后就直接在SSH的IP约束检查去掉。 修改配置文件 vim &#x2F;etc&#x2F;ssh&#x2F;ssh_config 添加不检查主机的约束的选项 StrictHostKeyChecking no UserKnownHostsFile ...","link":"","photos":[],"count_time":{"symbolsCount":162,"symbolsTime":"1 mins."},"categories":[{"name":"文章","slug":"文章","count":22,"path":"api/categories/文章.json"}],"tags":[{"name":"运维记录","slug":"运维记录","count":1,"path":"api/tags/运维记录.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}}}