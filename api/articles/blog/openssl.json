{"title":"编译C++项目使用OpenSSL库","uid":"aaf5766099e8206fd4b43f584166f61e","slug":"blog/openssl","date":"2024-03-14T07:45:09.095Z","updated":"2024-03-14T07:45:09.095Z","comments":true,"path":"api/articles/blog/openssl.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","content":"<p>OpenSSL</p>\n<p>一些C/CPP项目，在代码中使用HTTPS协议访问网站，需要使用OpenSSL的.h原文件和SSL库，在编译的时候需要连接这两个资源。</p>\n<p>在Mac OS上，默认安全的不是通常意义上的开源的OpenSSL， 需要我们手动通过brew进行安装。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">brew install  openssl<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>在CPP编译时要指明.h的位置和库文件的位置。通过-I和-L两个参数。</p>\n<p>查看OpenSSL的.h文件位置、库文件的位置，使用命令，如下：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">brew info openssl<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>我们用一个CPP项目，开展示编译参数的使用。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">git clone https:&#x2F;&#x2F;github.com&#x2F;AntiSomnus&#x2F;iDict-cmd.git<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>g++ -Os -m64 -std=c++14 idict_linux.cpp -o idict -lssl -lcrypto -v $LDFLAGS</p>\n<p>为了让主程序连接时，可以找到OpenSSL的-lssl这个参数，对应的库文件，加了$LDFLAGS这个参数。这个参数等同于，如下：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">-L&#x2F;opt&#x2F;homebrew&#x2F;opt&#x2F;openssl<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>这路径通过brew info openssl查看，结果类似，如下：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x3D;&#x3D;&gt; openssl@3: stable 3.0.7 (bottled) [keg-only]\nCryptography and SSL&#x2F;TLS Toolkit\nhttps:&#x2F;&#x2F;openssl.org&#x2F;\n&#x2F;opt&#x2F;homebrew&#x2F;Cellar&#x2F;openssl@3&#x2F;3.0.7 (6,454 files, 28.0MB)\n  Poured from bottle on 2023-01-13 at 11:02:26\nFrom: https:&#x2F;&#x2F;github.com&#x2F;Homebrew&#x2F;homebrew-core&#x2F;blob&#x2F;HEAD&#x2F;Formula&#x2F;openssl@3.rb\nLicense: Apache-2.0\n&#x3D;&#x3D;&gt; Dependencies\nRequired: ca-certificates ✔\n&#x3D;&#x3D;&gt; Caveats\nA CA file has been bootstrapped using certificates from the system\nkeychain. To add additional certificates, place .pem files in\n  &#x2F;opt&#x2F;homebrew&#x2F;etc&#x2F;openssl@3&#x2F;certs\n\nand run\n  &#x2F;opt&#x2F;homebrew&#x2F;opt&#x2F;openssl@3&#x2F;bin&#x2F;c_rehash\n\nopenssl@3 is keg-only, which means it was not symlinked into &#x2F;opt&#x2F;homebrew,\nbecause macOS provides LibreSSL.\n\nIf you need to have openssl@3 first in your PATH, run:\n  echo &#39;export PATH&#x3D;&quot;&#x2F;opt&#x2F;homebrew&#x2F;opt&#x2F;openssl@3&#x2F;bin:$PATH&quot;&#39; &gt;&gt; ~&#x2F;.zshrc\n\nFor compilers to find openssl@3 you may need to set:\n  export LDFLAGS&#x3D;&quot;-L&#x2F;opt&#x2F;homebrew&#x2F;opt&#x2F;openssl@3&#x2F;lib&quot;\n  export CPPFLAGS&#x3D;&quot;-I&#x2F;opt&#x2F;homebrew&#x2F;opt&#x2F;openssl@3&#x2F;include&quot;\n\nFor pkg-config to find openssl@3 you may need to set:\n  export PKG_CONFIG_PATH&#x3D;&quot;&#x2F;opt&#x2F;homebrew&#x2F;opt&#x2F;openssl@3&#x2F;lib&#x2F;pkgconfig&quot;\n\n&#x3D;&#x3D;&gt; Analytics\ninstall: 333,606 (30 days), 736,709 (90 days), 2,116,153 (365 days)\ninstall-on-request: 86,899 (30 days), 300,347 (90 days), 1,318,084 (365 days)\nbuild-error: 280 (30 days)<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>这些返回结果中，和.h头文件，库文件，最直接相关的两个参数：CPPFLAGS和LDFLAGS。在编译的时候直接用$进行引用就可以,顺序如下：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">export CPPFLAGS&#x3D;&quot;-I&#x2F;opt&#x2F;homebrew&#x2F;opt&#x2F;openssl@3&#x2F;include&quot;   \nexport LDFLAGS&#x3D;&quot;-L&#x2F;opt&#x2F;homebrew&#x2F;opt&#x2F;openssl@3&#x2F;lib&quot;\ng++ -Os -m64 -std&#x3D;c++14 idict_linux.cpp -o idict -lssl -lcrypto -v $LDFLAGS $CPPFLAGS<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<p>经过如上的操作，在 Mac上编译时用OpenSSL库，就很顺畅了。</p>\n<p>因为用到加解密模块，很多其他的软件，都可能依赖OpenSLL，特别是很多的C/CPP代码项目工程。</p>\n","text":"OpenSSL 一些C/CPP项目，在代码中使用HTTPS协议访问网站，需要使用OpenSSL的.h原文件和SSL库，在编译的时候需要连接这两个资源。 在Mac OS上，默认安全的不是通常意义上的开源的OpenSSL， 需要我们手动通过brew进行安装。 brew install...","link":"","photos":[],"count_time":{"symbolsCount":"2.7k","symbolsTime":"2 mins."},"categories":[{"name":"文章","slug":"文章","count":22,"path":"api/categories/文章.json"}],"tags":[{"name":"OpenSSL","slug":"OpenSSL","count":1,"path":"api/tags/OpenSSL.json"}],"toc":"","author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"Clickhouse的Docker版本查询","uid":"3141f157b979681af7ded27775c68b78","slug":"blog/clickhouse","date":"2024-03-14T07:45:09.095Z","updated":"2024-03-14T07:45:09.095Z","comments":true,"path":"api/articles/blog/clickhouse.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":"Clickhouse的Docker版本查询。 select service, count(service) as cnt from x_main_all where date &gt; &#39;2021-01-01&#39; and date &lt;&#39;2022-01-...","link":"","photos":[],"count_time":{"symbolsCount":491,"symbolsTime":"1 mins."},"categories":[{"name":"文章","slug":"文章","count":22,"path":"api/categories/文章.json"}],"tags":[{"name":"ClickHouse","slug":"ClickHouse","count":2,"path":"api/tags/ClickHouse.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"手机代理软件","uid":"00bd71ac36adab9def7848f7249016dc","slug":"blog/proxyman","date":"2024-03-14T07:45:09.095Z","updated":"2024-03-14T07:45:09.095Z","comments":true,"path":"api/articles/blog/proxyman.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":"向网友们询问手机代理软件，大家推荐的： proxyman、charless。 ","link":"","photos":[],"count_time":{"symbolsCount":39,"symbolsTime":"1 mins."},"categories":[{"name":"文章","slug":"文章","count":22,"path":"api/categories/文章.json"}],"tags":[{"name":"大数据安全","slug":"大数据安全","count":2,"path":"api/tags/大数据安全.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}}}