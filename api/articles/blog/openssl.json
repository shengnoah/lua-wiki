{"title":"编译C++项目使用OpenSSL库","uid":"aaf5766099e8206fd4b43f584166f61e","slug":"blog/openssl","date":"2024-03-14T07:45:09.095Z","updated":"2024-03-14T07:45:09.095Z","comments":true,"path":"api/articles/blog/openssl.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":null,"content":"<p>OpenSSL</p>\n<p>一些C/CPP项目，在代码中使用HTTPS协议访问网站，需要使用OpenSSL的.h原文件和SSL库，在编译的时候需要连接这两个资源。</p>\n<p>在Mac OS上，默认安全的不是通常意义上的开源的OpenSSL， 需要我们手动通过brew进行安装。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">brew install  openssl</span><br></pre></td></tr></table></figure>\n<p>在CPP编译时要指明.h的位置和库文件的位置。通过-I和-L两个参数。</p>\n<p>查看OpenSSL的.h文件位置、库文件的位置，使用命令，如下：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">brew info openssl</span><br></pre></td></tr></table></figure>\n<p>我们用一个CPP项目，开展示编译参数的使用。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git clone https://github.com/AntiSomnus/iDict-cmd.git</span><br></pre></td></tr></table></figure>\n<p>g++ -Os -m64 -std=c++14 idict_linux.cpp -o idict -lssl -lcrypto -v $LDFLAGS</p>\n<p>为了让主程序连接时，可以找到OpenSSL的-lssl这个参数，对应的库文件，加了$LDFLAGS这个参数。这个参数等同于，如下：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">-L/opt/homebrew/opt/openssl</span><br></pre></td></tr></table></figure>\n<p>这路径通过brew info openssl查看，结果类似，如下：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">==&gt; openssl@3: stable 3.0.7 (bottled) [keg-only]</span><br><span class=\"line\">Cryptography and SSL/TLS Toolkit</span><br><span class=\"line\">https://openssl.org/</span><br><span class=\"line\">/opt/homebrew/Cellar/openssl@3/3.0.7 (6,454 files, 28.0MB)</span><br><span class=\"line\">  Poured from bottle on 2023-01-13 at 11:02:26</span><br><span class=\"line\">From: https://github.com/Homebrew/homebrew-core/blob/HEAD/Formula/openssl@3.rb</span><br><span class=\"line\">License: Apache-2.0</span><br><span class=\"line\">==&gt; Dependencies</span><br><span class=\"line\">Required: ca-certificates ✔</span><br><span class=\"line\">==&gt; Caveats</span><br><span class=\"line\">A CA file has been bootstrapped using certificates from the system</span><br><span class=\"line\">keychain. To add additional certificates, place .pem files in</span><br><span class=\"line\">  /opt/homebrew/etc/openssl@3/certs</span><br><span class=\"line\"></span><br><span class=\"line\">and run</span><br><span class=\"line\">  /opt/homebrew/opt/openssl@3/bin/c_rehash</span><br><span class=\"line\"></span><br><span class=\"line\">openssl@3 is keg-only, which means it was not symlinked into /opt/homebrew,</span><br><span class=\"line\">because macOS provides LibreSSL.</span><br><span class=\"line\"></span><br><span class=\"line\">If you need to have openssl@3 first in your PATH, run:</span><br><span class=\"line\">  echo &#x27;export PATH=&quot;/opt/homebrew/opt/openssl@3/bin:$PATH&quot;&#x27; &gt;&gt; ~/.zshrc</span><br><span class=\"line\"></span><br><span class=\"line\">For compilers to find openssl@3 you may need to set:</span><br><span class=\"line\">  export LDFLAGS=&quot;-L/opt/homebrew/opt/openssl@3/lib&quot;</span><br><span class=\"line\">  export CPPFLAGS=&quot;-I/opt/homebrew/opt/openssl@3/include&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">For pkg-config to find openssl@3 you may need to set:</span><br><span class=\"line\">  export PKG_CONFIG_PATH=&quot;/opt/homebrew/opt/openssl@3/lib/pkgconfig&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">==&gt; Analytics</span><br><span class=\"line\">install: 333,606 (30 days), 736,709 (90 days), 2,116,153 (365 days)</span><br><span class=\"line\">install-on-request: 86,899 (30 days), 300,347 (90 days), 1,318,084 (365 days)</span><br><span class=\"line\">build-error: 280 (30 days)</span><br></pre></td></tr></table></figure>\n<p>这些返回结果中，和.h头文件，库文件，最直接相关的两个参数：CPPFLAGS和LDFLAGS。在编译的时候直接用$进行引用就可以,顺序如下：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">export CPPFLAGS=&quot;-I/opt/homebrew/opt/openssl@3/include&quot;   </span><br><span class=\"line\">export LDFLAGS=&quot;-L/opt/homebrew/opt/openssl@3/lib&quot;</span><br><span class=\"line\">g++ -Os -m64 -std=c++14 idict_linux.cpp -o idict -lssl -lcrypto -v $LDFLAGS $CPPFLAGS</span><br></pre></td></tr></table></figure>\n<p>经过如上的操作，在 Mac上编译时用OpenSSL库，就很顺畅了。</p>\n<p>因为用到加解密模块，很多其他的软件，都可能依赖OpenSLL，特别是很多的C/CPP代码项目工程。</p>\n","text":"OpenSSL 一些C/CPP项目，在代码中使用HTTPS协议访问网站，需要使用OpenSSL的.h原文件和SSL库，在编译的时候需要连接这两个资源。 在Mac OS上，默认安全的不是通常意义上的开源的OpenSSL， 需要我们手动通过brew进行安装。 1brew instal...","link":"","photos":[],"count_time":{"symbolsCount":"2.3k","symbolsTime":"2 mins."},"categories":[{"name":"文章","slug":"文章","count":22,"path":"api/categories/文章.json"}],"tags":[{"name":"OpenSSL","slug":"OpenSSL","count":1,"path":"api/tags/OpenSSL.json"}],"toc":"","author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"Clickhouse的Docker版本查询","uid":"3141f157b979681af7ded27775c68b78","slug":"blog/clickhouse","date":"2024-03-14T07:45:09.095Z","updated":"2024-03-14T07:45:09.095Z","comments":true,"path":"api/articles/blog/clickhouse.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":null,"text":"Clickhouse的Docker版本查询。 123select service, count(service) as cnt from x_main_all where date &gt; &#x27;2021-01-01&#x27; and date &lt;&#x27;20...","link":"","photos":[],"count_time":{"symbolsCount":495,"symbolsTime":"1 mins."},"categories":[{"name":"文章","slug":"文章","count":22,"path":"api/categories/文章.json"}],"tags":[{"name":"ClickHouse","slug":"ClickHouse","count":2,"path":"api/tags/ClickHouse.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"手机代理软件","uid":"00bd71ac36adab9def7848f7249016dc","slug":"blog/proxyman","date":"2024-03-14T07:45:09.095Z","updated":"2024-03-14T07:45:09.095Z","comments":true,"path":"api/articles/blog/proxyman.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":null,"text":"向网友们询问手机代理软件，大家推荐的： proxyman、charless。 ","link":"","photos":[],"count_time":{"symbolsCount":39,"symbolsTime":"1 mins."},"categories":[{"name":"文章","slug":"文章","count":22,"path":"api/categories/文章.json"}],"tags":[{"name":"大数据安全","slug":"大数据安全","count":2,"path":"api/tags/大数据安全.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}}}