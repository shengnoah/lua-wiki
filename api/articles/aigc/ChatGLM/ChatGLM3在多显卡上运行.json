{"title":"ChaGLM3åœ¨å¤šæ˜¾å¡ä¸Šè¿è¡Œ","uid":"c8a161f78cff976f698872281578706e","slug":"aigc/ChatGLM/ChatGLM3åœ¨å¤šæ˜¾å¡ä¸Šè¿è¡Œ","date":"2024-03-14T07:45:09.021Z","updated":"2024-03-14T07:45:09.021Z","comments":true,"path":"api/articles/aigc/ChatGLM/ChatGLM3åœ¨å¤šæ˜¾å¡ä¸Šè¿è¡Œ.json","keywords":"AIGC,LLM,ç³–æœAIGCå®éªŒå®¤","cover":null,"content":"<h1>ChaGLM3åœ¨å¤šæ˜¾å¡ä¸Šè¿è¡Œ</h1>\n<p>åœ¨æ˜ç¡®æ˜¯16ä½é‡åŒ–çš„æ—¶å€™ï¼Œç”¨ChatGLMé¡¹ç›®ä¸­çš„utilsæ–‡ä»¶çš„load_model_on_gpusæ–¹æ³•ï¼Œè¿›è¡Œå¯¹modelçš„é…ç½®ï¼Œ num_gpus=4,æ„æ€æ˜¯è¯´åœ¨4å—æ˜¾å¡ä¸Šè¿è¡Œã€‚<br>\nfrom utils import load_model_on_gpus</p>\n<p>model = load_model_on_gpus(model_name, num_gpus=4)</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> quantize == <span class=\"number\">16</span>:</span><br><span class=\"line\">model = load_model_on_gpus(model_name, num_gpus=<span class=\"number\">4</span>)</span><br><span class=\"line\"><span class=\"keyword\">else</span>:</span><br><span class=\"line\">model = AutoModel.from_pretrained(model_name, device_map=<span class=\"string\">&quot;auto&quot;</span>,trust_remote_code=<span class=\"literal\">True</span>).half().quantize(quantize).cuda()</span><br></pre></td></tr></table></figure>\n<p>è¿è¡Œçš„æ—¶å€™ï¼Œç”¨å‘½ä»¤å‚æ•° -dï¼ŒæŒ‡å®šæ‰€åœ¨è¿è¡Œçš„æ˜¾å¡ã€‚</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">parser.add_argument(<span class=\"string\">&#x27;--device&#x27;</span>, <span class=\"string\">&#x27;-d&#x27;</span>, <span class=\"built_in\">help</span>=<span class=\"string\">&#x27;deviceï¼Œ -1 means cpu, other means gpu ids&#x27;</span>, default=<span class=\"string\">&#x27;0&#x27;</span>)</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python fastapiGPU.py -d 0,1,2,3</span><br></pre></td></tr></table></figure>\n<p>ç›¸å½“äºSDçš„ CUDA_VISIBLE_DEVICESã€‚</p>\n<p>webui-user.shä¸­åŠ å…¥exportå‚æ•°ã€‚</p>\n<p>export CUDA_VISIBLE_DEVICES=0,1,2,3</p>\n<p>./stable-diffusion-webui/webui.sh --listen --device-id 1<br>\nè¿™æ ·è¿è¡Œï¼ŒSDå¯ä»¥åŒæ—¶ä½¿ç”¨æ˜¾å¡0å’Œæ˜¾å¡1.</p>\n<p>CUDA_VISIBLE_DEVICES=0,1,2,3 python <a href=\"http://launch.py\">launch.py</a>  --share</p>\n<p>CUDA_VISIBLE_DEVICES=1 python <a href=\"http://launch.py\">launch.py</a>  --share</p>\n<p>cmd_args.py    --device-id</p>\n<p>device-idå‚æ•°æ˜¯åœ¨cmd_args.pyæ–‡ä»¶ä¸­å‡ºç°çš„ã€‚</p>\n","text":"ChaGLM3åœ¨å¤šæ˜¾å¡ä¸Šè¿è¡Œ åœ¨æ˜ç¡®æ˜¯16ä½é‡åŒ–çš„æ—¶å€™ï¼Œç”¨ChatGLMé¡¹ç›®ä¸­çš„utilsæ–‡ä»¶çš„load_model_on_gpusæ–¹æ³•ï¼Œè¿›è¡Œå¯¹modelçš„é…ç½®ï¼Œ num_gpus=4,æ„æ€æ˜¯è¯´åœ¨4å—æ˜¾å¡ä¸Šè¿è¡Œã€‚ from utils import load_model_on_g...","link":"","photos":[],"count_time":{"symbolsCount":937,"symbolsTime":"1 mins."},"categories":[{"name":"AIGC","slug":"AIGC","count":119,"path":"api/categories/AIGC.json"},{"name":"chatglm3","slug":"AIGC/chatglm3","count":1,"path":"api/categories/AIGC/chatglm3.json"}],"tags":[{"name":"chatglm3","slug":"chatglm3","count":1,"path":"api/tags/chatglm3.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\"><span class=\"toc-text\">ChaGLM3åœ¨å¤šæ˜¾å¡ä¸Šè¿è¡Œ</span></a></li></ol>","author":{"name":"å®‰å…¨ä¹¦","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"ã€Šå¢¨å®ˆä¹‹é“-WebæœåŠ¡å®‰å…¨æ¶æ„ä¸å®è·µã€‹","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"çŸ¢é‡æ•°æ®åº“","uid":"0214cb41e71f0a070ee24d319de60be5","slug":"aigc/çŸ¢é‡æ•°æ®åº“","date":"2024-03-14T07:45:09.021Z","updated":"2024-03-14T07:45:09.021Z","comments":true,"path":"api/articles/aigc/çŸ¢é‡æ•°æ®åº“.json","keywords":"AIGC,LLM,ç³–æœAIGCå®éªŒå®¤","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":"ä»€ä¹ˆæ˜¯ğ—©ğ—²ğ—°ğ˜ğ—¼ğ—¿ ğ——ğ—®ğ˜ğ—®ğ—¯ğ—®ğ˜€ğ—²? ä»€ä¹ˆæ˜¯ğ—©ğ—²ğ—°ğ˜ğ—¼ğ—¿ ğ——ğ—®ğ˜ğ—®ğ—¯ğ—®ğ˜€ğ—²? éšç€åŸºç¡€æ¨¡å‹çš„å…´èµ·ï¼ŒçŸ¢é‡æ•°æ®åº“è¿…é€Ÿæµè¡Œèµ·æ¥ã€‚äº‹å®ä¸Šï¼ŒçŸ¢é‡æ•°æ®åº“åœ¨å¤§å‹è¯­è¨€æ¨¡å‹ä¸Šä¸‹æ–‡ä¹‹å¤–ä¹Ÿå¾ˆæœ‰ç”¨ã€‚ å½“è°ˆåˆ°æœºå™¨å­¦ä¹ æ—¶ï¼Œæˆ‘ä»¬ç»å¸¸å¤„ç†å‘é‡åµŒå…¥ã€‚çŸ¢é‡æ•°æ®åº“çš„åˆ›å»ºæ˜¯ä¸ºäº†åœ¨ä½¿ç”¨å®ƒä»¬æ—¶è¡¨ç°ç‰¹åˆ«å¥½ï¼š â¡ï¸ å­˜å‚¨ã€‚ â¡ï¸...","link":"","photos":[],"count_time":{"symbolsCount":962,"symbolsTime":"1 mins."},"categories":[{"name":"AIGC","slug":"AIGC","count":119,"path":"api/categories/AIGC.json"},{"name":"weibo","slug":"AIGC/weibo","count":59,"path":"api/categories/AIGC/weibo.json"}],"tags":[{"name":"weibo","slug":"weibo","count":62,"path":"api/tags/weibo.json"}],"author":{"name":"å®‰å…¨ä¹¦","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"ã€Šå¢¨å®ˆä¹‹é“-WebæœåŠ¡å®‰å…¨æ¶æ„ä¸å®è·µã€‹","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"DDColorè€ç›¸ç‰‡ä¸Šè‰²","uid":"5ffd5ba2715e0bed5ed2f623a352bd78","slug":"aigc/sd/DDColorè€ç›¸ç‰‡ä¸Šè‰²","date":"2024-03-14T07:45:09.020Z","updated":"2024-03-14T07:45:09.020Z","comments":true,"path":"api/articles/aigc/sd/DDColorè€ç›¸ç‰‡ä¸Šè‰².json","keywords":"AIGC,LLM,ç³–æœAIGCå®éªŒå®¤","cover":[],"text":"DDColorè€ç›¸ç‰‡ä¸Šè‰² GitHub ä¸Šä¸€æ¬¾å¯å®ç°ç…§ç‰‡çº§çœŸå®æ„Ÿçš„å›¾åƒç€è‰²å·¥å…·ï¼šDDColorã€‚ å®ƒä¸ä»…å¯ä»¥ä¸ºå†å²é»‘ç™½è€æ—§ç…§ç‰‡æä¾›ç”ŸåŠ¨è‡ªç„¶çš„ç€è‰²ï¼Œè¿˜å¯ä»¥å¯¹åŠ¨æ¼«æ¸¸æˆä¸­çš„é£æ™¯è¿›è¡Œç€è‰²æˆ–é‡æ–°ç€è‰²ï¼Œå˜ä¸ºé€¼çœŸçš„ç°å®ç”Ÿæ´»é£æ ¼ï¼ GitHubï¼šgithub.com/piddnad/DDColo...","link":"","photos":[],"count_time":{"symbolsCount":177,"symbolsTime":"1 mins."},"categories":[{"name":"AIGC","slug":"AIGC","count":119,"path":"api/categories/AIGC.json"},{"name":"weibo","slug":"AIGC/weibo","count":59,"path":"api/categories/AIGC/weibo.json"}],"tags":[{"name":"weibo","slug":"weibo","count":62,"path":"api/tags/weibo.json"}],"author":{"name":"å®‰å…¨ä¹¦","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"ã€Šå¢¨å®ˆä¹‹é“-WebæœåŠ¡å®‰å…¨æ¶æ„ä¸å®è·µã€‹","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}}}