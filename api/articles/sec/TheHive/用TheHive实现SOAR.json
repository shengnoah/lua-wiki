{"title":"用TheHive实现SOAR","uid":"4ed59a6d992f5c41879395e6019b7e3d","slug":"sec/TheHive/用TheHive实现SOAR","date":"2024-03-18T03:38:03.761Z","updated":"2024-03-18T03:42:33.349Z","comments":true,"path":"api/articles/sec/TheHive/用TheHive实现SOAR.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":[],"content":"<h1 id=\"用thehive实现soar\"><a class=\"markdownIt-Anchor\" href=\"#用thehive实现soar\"></a> 用TheHive实现SOAR</h1>\n<h1 id=\"一-介绍\"><a class=\"markdownIt-Anchor\" href=\"#一-介绍\"></a> 一、介绍</h1>\n<p>SOAR代表“<strong>安全编排、自动化和响应</strong>”，指的是一种解决方案，用于威胁领域，以更好地监控和响应安全监控工具和技术检测到的<strong>事件</strong>。随着探测恶意活动的更先进技术的发展，大多数机构正转向使用SOAR，利用自动化来有效地<strong>分析、升级和响应 analyse, escalate and respond</strong> 安全威胁。</p>\n<p><strong>检测方法:</strong></p>\n<p><strong>安全运营中心（Security Operations Centres）<strong>也被称为SOC，它们有监控和保护关键资产的系统。这些系统有复杂的规则，以及不断运行的先进机器学习算法，以检测任何可能被归类为恶意的活动。一旦检测发生，下一步是将信息发送到SOC，供安全分析师进行调查。这个信息通常以</strong>告警Alert</strong>的形式发送进来。SOC团队然后尝试根据SLA(服务水平协议)在固定的时间内解决告警。</p>\n<p><strong>分析:</strong></p>\n<p><strong>安全分析师</strong>将<strong>分析</strong>告警以<strong>验证</strong>潜在的攻击，<strong>确定</strong>实际发生了什么，并<strong>评估</strong>事件的影响。基于此，安全运营团队可以执行响应操作来减轻威胁参与者。</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>“如果分析师试图证明一项告警是有效的，他们要比试图证明它是无效的<strong>多花三分之二的时间</strong>。”</p>\n<p>克里斯·森德斯——调查理论</p></blockquote>\n<p><strong>响应:</strong></p>\n<p>通常，安全分析人员必须执行一些任务来解决告警。其中一些任务非常复杂，需要网络安全专家来完成。然而，安全分析人员也会遇到平凡而重复的任务。当分析人员接触到具有<strong>相同或重复任务</strong>的大量告警时，他们往往会出现<strong>告警疲劳</strong>，这可能导致性能降低和响应时间延长。这就是SOAR来救援的地方!</p>\n<p><strong>SOAR:</strong></p>\n<p>SOAR强调自动化，以帮助安全团队增加带宽，专注于解决安全问题。与分析师接收警报类似，SOAR解决方案也将接收警报并对其执行一些分析。根据分析结果，将有一个响应操作来减轻威胁参与者。</p>\n<h1 id=\"二-thehive安全事件响应\"><a class=\"markdownIt-Anchor\" href=\"#二-thehive安全事件响应\"></a> 二、TheHive——安全事件响应</h1>\n<p>TheHive是一个可扩展的四合一开源和免费的安全事件响应平台。这4个是TheHive, Cortex, TheHive4py (TheHive的python API)和MISP。TheHive的设计是为了让soc、csirt、cert和任何信息安全从业者在处理需要迅速调查和采取行动的安全事件时生活得更轻松。简单地说，TheHive作为SOC的前端应用程序，在<strong>三个基本阶段(检测、分析和响应)以及从创建到关闭的案例/告警管理</strong>中提供帮助。</p>\n<h1 id=\"三-cortex-强大的可观察分析和反应\"><a class=\"markdownIt-Anchor\" href=\"#三-cortex-强大的可观察分析和反应\"></a> <strong>三、Cortex-强大的可观察分析和反应</strong></h1>\n<p>Cortex是另一款由TheHive同一团队开发并与TheHive紧密合作的软件。TheHive和Cortex可以一起使用，使SOC的生活更容易。在这样的解决方案中，任何可以帮助减轻威胁行为者的<strong>破坏指标(Indicator of Compromise, IoC)或取证数据</strong>片段都被列为<strong>可观察对象</strong> observable。Cortex是一个强大的可观察分析和主动响应引擎。它有有助于分析这些观测数据的分析器。分析者还帮助用有价值的信息丰富TheHive的告警。利用这些有价值的信息，分析人员可以运行Cortex上的Responders，轻松地自动解决安全告警。</p>\n<p>Cortex提供了一个web界面，用于分析IP、电子邮件地址、url、域名、文件或恶意软件的哈希值。然而，这两个应用程序可以集成在一起，使用REST API进行通信，而不是在web界面之间切换。Cortex配备了分析仪和响应器，以协助安全操作的自动化。这些分析器和响应器是可以用Linux支持的任何编程语言(如Python、Ruby、Perl等)编写的自动化脚本。在我写这篇博文的时候，大约有160个analyser和24个Responders默认安装了Cortex。然而，你可以选择编写自己的分析器和响应器，并将其放在指定的目录中供Cortex使用。</p>\n<p>TheHive &amp; Cortex完全由StrangeBee开发和维护。</p>\n<h1 id=\"四-misp-开源威胁intel共享\"><a class=\"markdownIt-Anchor\" href=\"#四-misp-开源威胁intel共享\"></a> 四、MISP -开源威胁Intel共享</h1>\n<p>恶意软件信息共享平台是一种开源软件解决方案，用于收集、存储、分发和共享网络安全指标、网络安全事件威胁和恶意软件分析。这是由CIRCL开发和维护的。除了MISP的许多用途之外，这个解决方案可以利用的一个主要用途是订阅许多开源威胁情报源。当TheHive与Cortex和MISP整合在一起时，它的真正力量就会显现出来。这三种工具共同作用，形成安全行动中心事件分析/响应和案例管理的全面解决方案。</p>\n<p>每一个需要调查的安全事件都会作为警报进入TheHive。MISP有一些世界级的威胁情报供分析师或安全团队使用。因此，每当有一些新的威胁信息添加到MISP，它将自动填充到TheHive上进行分类，分析和响应。此外，除了从MISP接收事件外，还可以将解决方案配置为向MISP发送事件。因此，SOC可以将发现的威胁信息反馈给MISP，以帮助更广泛的社区领先黑客一步。</p>\n<p>一幅画胜过千言万语!<br />\n<img src=\"https://gitee.com/shengnoah/picture/raw/master/20240318114206.png\" alt=\"image.png\" /></p>\n<p><img src=\"https://upload-images.jianshu.io/upload_images/5619637-2412037f86fe4d0a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/738/format/webp\" alt=\"\" /></p>\n<h1 id=\"五-剧本playbooks-工作流自动化\"><a class=\"markdownIt-Anchor\" href=\"#五-剧本playbooks-工作流自动化\"></a> 五、剧本Playbooks-工作流自动化</h1>\n<p>在安全运营领域，分析师将致力于解决非常复杂的安全告警。这些任务中的大多数都非常复杂，需要安全专业知识。然而，对于安全专家来说，要查看生成的每一条信息，有些任务可能是平凡而耗时的。像这样的任务，有更高的人为错误的机会，这是自动化可以帮助的地方。自动化旨在减少人为干预和人为错误的可能性。</p>\n<p>在前面的小节中，我们已经看到了如何利用开源工具的强大功能来为SOC创建一个独特的解决方案。下一步是增加一个额外的层，这将有助于自动执行一些平凡和重复的任务，以提高网络安全团队的效率。</p>\n<p>Thehive和Cortex都有外部工具的API来利用它们的功能。TheHive有一个webhook功能，它可以在发生任何更改或事件时通知其他工具。这些强大的功能使自动化成为可能。</p>\n<p><img src=\"https://gitee.com/shengnoah/picture/raw/master/20240318114218.png\" alt=\"image.png\" /></p>\n<p><img src=\"https://upload-images.jianshu.io/upload_images/5619637-88579a669da19a7c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/539/format/webp\" alt=\"\" /></p>\n<p><strong>剧本Playbooks:</strong></p>\n<p>剧本是在任何事件发生时应以特定方式执行的一系列步骤。</p>\n<p><strong>自动化:</strong></p>\n<p>安全分析师可以设计和开发剧本来自动化安全告警分析和响应。有了TheHive和Cortex中可用的API和Webhook功能，它们的功能可以通过<strong>任何工作流自动化工具来创建这些脚本</strong>。</p>\n<p>在我写这篇博客的时候，开源社区使用了一些工具。其中包括n8n、nodered、shuffle和tines。</p>\n<p>n8n的示例脚本如下所示。<br />\n<img src=\"https://gitee.com/shengnoah/picture/raw/master/20240318114229.png\" alt=\"image.png\" /></p>\n<p><img src=\"https://upload-images.jianshu.io/upload_images/5619637-272b6590aaca8661.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1024/format/webp\" alt=\"\" /></p>\n<h1 id=\"结论\"><a class=\"markdownIt-Anchor\" href=\"#结论\"></a> 结论</h1>\n<p>我们已经看到了如何使用开源工具构建一个完全自动化和自由的SOAR解决方案。使用开源工具的好处在于，开发人员可以很容易地修改它们以满足您的需求。此外，还有一个使用、改进和支持这些工具的开源社区。</p>\n<p>因为这个解决方案是开源和灵活的;这意味着它可以与其他解决方案集成。最有价值的集成之一是与Elastic SIEM的集成。Elastic SIEM为从所有设备中提取、转换和加载(ETL)日志和机器数据到Elasticsearch (Elastic堆栈的核心)提供了一种增强和简化的解决方案。然后，Elastic可以使用解析和充实技术来添加元数据，并使用最先进的机器学习(ML)来增强威胁分析和恶意行为检测。一个检测可以被发送到TheHive作为告警，并可能有一个全自动的解决方案来处理告警直至关闭。</p>\n<p>来源：<a href=\"https://skilledfield.com.au/soaring-with-thehive/\">https://skilledfield.com.au/soaring-with-thehive/</a></p>\n","feature":true,"text":" 用TheHive实现SOAR 一、介绍 SOAR代表“安全编排、自动化和响应”，指的是一种解决方案，用于威胁领域，以更好地监控和响应安全监控工具和技术检测到的事件。随着探测恶意活动的更先进技术的发展，大多数机构正转向使用SOAR，利用自动化来有效地分析、升级和响应 analys...","link":"","photos":[],"count_time":{"symbolsCount":"3k","symbolsTime":"3 mins."},"categories":[{"name":"安全","slug":"安全","count":37,"path":"api/categories/安全.json"}],"tags":[{"name":"SOAR","slug":"SOAR","count":3,"path":"api/tags/SOAR.json"},{"name":"TheHive","slug":"TheHive","count":4,"path":"api/tags/TheHive.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E7%94%A8thehive%E5%AE%9E%E7%8E%B0soar\"><span class=\"toc-text\"> 用TheHive实现SOAR</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E4%B8%80-%E4%BB%8B%E7%BB%8D\"><span class=\"toc-text\"> 一、介绍</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E4%BA%8C-thehive%E5%AE%89%E5%85%A8%E4%BA%8B%E4%BB%B6%E5%93%8D%E5%BA%94\"><span class=\"toc-text\"> 二、TheHive——安全事件响应</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E4%B8%89-cortex-%E5%BC%BA%E5%A4%A7%E7%9A%84%E5%8F%AF%E8%A7%82%E5%AF%9F%E5%88%86%E6%9E%90%E5%92%8C%E5%8F%8D%E5%BA%94\"><span class=\"toc-text\"> 三、Cortex-强大的可观察分析和反应</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%9B%9B-misp-%E5%BC%80%E6%BA%90%E5%A8%81%E8%83%81intel%E5%85%B1%E4%BA%AB\"><span class=\"toc-text\"> 四、MISP -开源威胁Intel共享</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E4%BA%94-%E5%89%A7%E6%9C%ACplaybooks-%E5%B7%A5%E4%BD%9C%E6%B5%81%E8%87%AA%E5%8A%A8%E5%8C%96\"><span class=\"toc-text\"> 五、剧本Playbooks-工作流自动化</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E7%BB%93%E8%AE%BA\"><span class=\"toc-text\"> 结论</span></a></li></ol>","author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{},"next_post":{"title":"澳大利亚AI与码农","uid":"1a6eb3c75e1616f628a2436324907239","slug":"weibo/澳大利亚AI与码农","date":"2024-03-14T07:45:09.130Z","updated":"2024-03-14T07:45:09.131Z","comments":true,"path":"api/articles/weibo/澳大利亚AI与码农.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://s2.loli.net/2024/02/07/Li7MZXHjcuvCSO4.png","text":"澳大利亚AI与码农 澳洲的AI和码农环境产生了浓厚的兴趣，打算深入了解一下。 澳大利亚在AI领域的研究拥有独特的优势，一些著名的研究机构和学校包括： 澳大利亚机器人与自动化协会（RAA），机器人和自动化技术，包括人工智能、自主系统、感知技术等； 澳大利亚国家数据科学与人工智能研究...","link":"","photos":[],"count_time":{"symbolsCount":840,"symbolsTime":"1 mins."},"categories":[{"name":"AIGC","slug":"AIGC","count":119,"path":"api/categories/AIGC.json"},{"name":"weibo","slug":"AIGC/weibo","count":59,"path":"api/categories/AIGC/weibo.json"}],"tags":[{"name":"weibo","slug":"weibo","count":62,"path":"api/tags/weibo.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}},"feature":true}}