{"title":"新版OPENCTI简介","uid":"4b034a15f055a394a702faf591842ba3","slug":"sec/新版OPENCTI简介","date":"2024-03-14T07:45:09.059Z","updated":"2024-03-14T07:45:09.059Z","comments":true,"path":"api/articles/sec/新版OPENCTI简介.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","content":"<h1 id=\"新版opencti简介\"><a class=\"markdownIt-Anchor\" href=\"#新版opencti简介\"></a> 新版OPENCTI简介</h1>\n<p><strong>重点：由图库改为ES进行存储</strong></p>\n<p><strong>一、总览</strong></p>\n<p>OpenCTI是一个开源平台，允许组织管理他们的网络威胁情报知识和观察结果。它的创建是为了结构化、存储、组织和可视化关于网络威胁的技术和非技术信息。</p>\n<p>数据使用基于[STIX2标准]的知识模式进行结构化(<a href=\"https://oasis-open.github.io/cti-documentation/\">https://oasis-open.github.io/cti-documentation/</a>)。它被设计成一个现代的web应用程序，包括一个<a href=\"https://graphql.org/\">GraphQL API</a>和一个面向UX的前端。此外，OpenCTI还可以与其他工具和应用程序集成，如<a href=\"https://github.com/MISP/MISP\">MISP</a>， <a href=\"https://github.com/TheHive-Project/TheHive\">TheHive</a>， <a href=\"https://github.com/mitre/cti\">MITRE ATT&amp;CK</a>等。</p>\n<p><img src=\"https://upload-images.jianshu.io/upload_images/5619637-3e62bf44fdd91431.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp\" alt=\"\" /></p>\n<h1 id=\"目标\"><a class=\"markdownIt-Anchor\" href=\"#目标\"></a> #目标</h1>\n<p>目标是创建一个全面的工具允许用户集成技术信息(如ttp,可见)和非技术信息(如提出归因,受害者研究、行业活动和本地化),而把每一块信息的主要来源(报告、MISP事件等),并提供链接等特性之间的信息,第一个和最后一个看到日期,水平的信心和描述字段。该工具能够使用<a href=\"https://attack.mitre.org/\">MITRE攻击与ck框架</a>(通过<a href=\"https://github.com/OpenCTI-Platform/connectors\">专用连接器</a>)来帮助构建数据结构。用户也可以选择实现自己的数据集。</p>\n<p>一旦分析人员将数据集成到OpenCTI中，新的关系<a href=\"../%E5%BC%95%E7%94%A8/%E6%8E%A8%E6%96%AD\">可能会从现有关系中推断出来</a>，以促进对这些信息的理解和表示。这允许用户从原始数据中提取和利用有意义的知识。</p>\n<p>OpenCTI不仅允许<a href=\"../usage/import\">imports</a>，而且还允许<a href=\"../usage/export\">exports of data</a>在不同的格式下(CSV, STIX2 bundles，等等)。<a href=\"https://github.com/OpenCTI-Platform/connectors\">Connectors</a>目前正在开发中，以加速工具与其他平台之间的交互。</p>\n<p><strong>二、架构</strong></p>\n<p>OpenCTI平台依靠几个外部数据库和服务才能正常工作。</p>\n<p><img src=\"https://upload-images.jianshu.io/upload_images/5619637-9a63c41e2beae881.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp\" alt=\"\" /></p>\n<p>（1）GraphQL API</p>\n<p>API是OpenCTI平台的核心部分，允许客户端(包括前端)与数据库和代理(消息传递系统)进行交互。它内置在NodeJS中，实现了<a href=\"https://graphql.org/\">GraphQL</a>查询语言。由于API还没有完整的文档记录，您可以通过GraphQL平台探索可用的方法和参数。请参见OpenCTI<a href=\"https://demo.opencti.io/graphql\">演示实例</a>。</p>\n<p>（2）写入worker</p>\n<p>worker是独立的Python进程，使用来自RabbitMQ broker的消息来完成异步写查询。您可以启动尽可能多的workers来提高写性能。在某种程度上，写性能将受到数据库吞吐量(ElasticSearch)的限制，如果您在使用3或4个worker时没有达到预期的性能，那么启动更多worker将是无用的，您必须考虑增强数据库节点的硬件(或将您的设置扩展到集群)。</p>\n<p>（3）连接器</p>\n<p>连接器是软件(Python进程)的第三方部分，可以在平台上扮演四种不同的角色:</p>\n<p>EXTERNAL_IMPORT：从远程数据源提取数据，将其转换为STIX2，并将其插入到OpenCTI平台上。MITRE, MISP, CVE, AlienVault, FireEye, etc.</p>\n<p>INTERNAL_IMPORT_FILE：通过UI或API从OpenCTI上上传的文件中提取数据。提取指标从pdf, STIX2导入，等。</p>\n<p>INTERNAL_ENRICHMENT：监听新的OpenCTI实体或用户请求，从远程数据源提取数据来充实。通过外部服务、实体更新等来丰富可观察对象。</p>\n<p>INTERNAL_EXPORT_FILE：根据列出实体或一个实体及其关系，从OpenCTI数据生成导出。STIX2导出，PDF导出，CSV列表生成等。</p>\n<p>STREAM:使用平台的数据流。History, Synchronizer, Tanium等。</p>\n<p><strong>三、OpenCTI生态系统</strong></p>\n<p>**<a href=\"https://www.notion.so/OpenCTI-Ecosystem-868329e9fb734fca89692b2ed6087e76\">https://www.notion.so/OpenCTI-Ecosystem-868329e9fb734fca89692b2ed6087e76</a><br />\n**</p>\n<p><strong>1、Python的OpenCTI客户端</strong></p>\n<p>pycti库旨在帮助OpenCTI用户和开发人员与OpenCTI平台GraphQL API进行交互。</p>\n<p>Python库要求Python &gt;= 3。</p>\n<p><strong>2、链接器</strong></p>\n<p><strong>2.1数据导入</strong></p>\n<p><strong>（1）OpenCTI AlienVault Connector</strong></p>\n<p>**<a href=\"https://github.com/OpenCTI-Platform/connectors/tree/master/alienvault\">https://github.com/OpenCTI-Platform/connectors/tree/master/alienvault</a><br />\n**</p>\n<p>OpenCTI AlienVault连接器可用于从Alien Labs Open Threat Exchange (OTX)平台导入知识。连接器利用OTX DirectConnect API获取订阅脉冲的威胁数据。</p>\n<p>注意:需要加入OTX威胁情报社区。</p>\n<p><strong>（2）OpenCTI网络威胁联盟连接器</strong></p>\n<p><strong><a href=\"https://github.com/OpenCTI-Platform/connectors/tree/master/cyber-threat-coalition\">https://github.com/OpenCTI-Platform/connectors/tree/master/cyber-threat-coalition</a></strong></p>\n<p>OpenCTI Cyber Threat Coalition connector导入由网络威胁联盟团队发布的指标。</p>\n<p>网络威胁联盟是一个专家团队，在COVID-19危机期间收集和分享与大流行相关的网络威胁情报</p>\n<p>技术信息</p>\n<p>连接器从经过审查的黑名单(<a href=\"https://blacklist.cyberthreatcoalition.org/vetted/\">https://blacklist.cyberthreatcoalition.org/vetted/</a>)导入指示器。</p>\n<p>所有导入的指标将链接到一份名为“COVID-19网络威胁联盟(CTC)黑名单”的独特报告。</p>\n<p>（3）OpenCTI CrowdStrike连接器</p>\n<p>OpenCTI CrowdStrike连接器可用于从CrowdStrike Falcon平台导入知识。该连接器利用intel api获取CrowdStrike的情报信息，包括参与者、指标、报告和YARA规则的数据。</p>\n<p>注:需要订阅CrowdStrike Falcon平台。订阅详细信息规定了连接器实际可用的数据。</p>\n<p><strong>(4)连接器:OpenCTI的CYBERCRIME-TRACKER.NET</strong></p>\n<p>连接器使用:<a href=\"http://cybercrime-tracker.net/rss.xml%E4%B8%8B%E7%9A%84%E8%B7%9F%E8%B8%AA%E5%99%A8%E7%9A%84RSS\">http://cybercrime-tracker.net/rss.xml下的跟踪器的RSS</a> feed</p>\n<p>它将解析所有的条目并:</p>\n<p>为每个条目生成一个指示符，指示相关的恶意软件。</p>\n<p>将域、url、IP地址作为observable添加到OpenCTI中，并创建相应的关系。</p>\n<p><strong>(5)OpenCTI FireEye连接器</strong></p>\n<p>该连接器连接到FireEye Intel API V3，并从给定的日期收集所有数据。</p>\n<p><strong>(6)OpenCTI卡巴斯基连接器</strong></p>\n<p>OpenCTI卡巴斯基连接器可以用于从卡巴斯基威胁情报门户导入知识。连接器利用卡巴斯基威胁情报门户API检索情报发布在卡巴斯基威胁情报门户，这包括报告pdf, IoCs和YARA规则。</p>\n<p>注意:使用卡巴斯基威胁情报门户服务需要许可证。</p>\n<p><strong>(7)OpenCTI的LastInfoSec连接器!</strong></p>\n<p>OpenCTI LastInfoSec连接器将使用/v2/stix21/getlasthour API。</p>\n<p>这个LastInfosec的威胁feed包含stix2.1报告每小时更新url，哈希值，域指示器。</p>\n<p>要求:如果你想使用LastInfoSec的智能，你需要一个API密钥。您可以通过contact@lastinfosec.com联系LastInfoSec团队</p>\n<p><strong>(8)OpenCTI Malpedia连接器</strong></p>\n<p>这个连接器从Malpedia 库导入知识。</p>\n<p>连接器为以下OpenCTI可观察对象/指示器类型添加数据:</p>\n<p>yara</p>\n<p>file-sha256</p>\n<p>连接器添加了以下实体:</p>\n<p>Malware</p>\n<p>Intrusion-Set</p>\n<p>References</p>\n<p>(9)OpenCTI MISP Connector</p>\n<p>MISP connector是一个独立的Python进程，必须能够访问OpenCTI平台和RabbitMQ。RabbitMQ的凭据和连接参数由API直接提供，在平台设置中配置。</p>\n","text":" 新版OPENCTI简介 重点：由图库改为ES进行存储 一、总览 OpenCTI是一个开源平台，允许组织管理他们的网络威胁情报知识和观察结果。它的创建是为了结构化、存储、组织和可视化关于网络威胁的技术和非技术信息。 数据使用基于[STIX2标准]的知识模式进行结构化(https:...","link":"","photos":[],"count_time":{"symbolsCount":"3.2k","symbolsTime":"3 mins."},"categories":[{"name":"安全","slug":"安全","count":38,"path":"api/categories/安全.json"}],"tags":[{"name":"OpenCTI","slug":"OpenCTI","count":4,"path":"api/tags/OpenCTI.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E6%96%B0%E7%89%88opencti%E7%AE%80%E4%BB%8B\"><span class=\"toc-text\"> 新版OPENCTI简介</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E7%9B%AE%E6%A0%87\"><span class=\"toc-text\"> #目标</span></a></li></ol>","author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"osv.dev开源软件分发漏洞","uid":"0ecd1bd1e56170cb7ee0bb4ac1c851d9","slug":"sec/osv.dev开源软件分发漏洞","date":"2024-03-14T07:45:09.059Z","updated":"2024-03-14T07:45:09.060Z","comments":true,"path":"api/articles/sec/osv.dev开源软件分发漏洞.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":" osv.dev开源软件分发漏洞 OSV（Open Source Vulnerabilities）是一个分布式的开源漏洞数据库，用于精确地生成和消费有关开源软件漏洞的信息。它提供了一个人类可读和机器可读的数据格式，以准确地描述漏洞与开源软件包版本或提交哈希之间的关系1。 OSV ...","link":"","photos":[],"count_time":{"symbolsCount":852,"symbolsTime":"1 mins."},"categories":[{"name":"安全","slug":"安全","count":38,"path":"api/categories/安全.json"}],"tags":[{"name":"osv","slug":"osv","count":1,"path":"api/tags/osv.json"},{"name":"dev","slug":"dev","count":1,"path":"api/tags/dev.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"RE&CT框架详细介绍","uid":"a11be9ae4d2ebafdc88c7634ec4817a3","slug":"sec/RE&CT框架详细介绍","date":"2024-03-14T07:45:09.058Z","updated":"2024-03-14T07:45:09.059Z","comments":true,"path":"api/articles/sec/RE&CT框架详细介绍.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":" RE&amp;CT框架详细介绍 0 原理 RE&amp;CT框架是为积累、描述和分类可操作的事件响应技术而设计的。 RE&amp;CT的哲学是基于MITRE的att&amp;ck框架。 列表示响应阶段。 这些单元格代表响应动作。 **主要用例: ** 1、事件响应能力开发的优先...","link":"","photos":[],"count_time":{"symbolsCount":"43k","symbolsTime":"39 mins."},"categories":[{"name":"安全","slug":"安全","count":38,"path":"api/categories/安全.json"}],"tags":[{"name":"RE与CT框架","slug":"RE与CT框架","count":1,"path":"api/tags/RE与CT框架.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}}}