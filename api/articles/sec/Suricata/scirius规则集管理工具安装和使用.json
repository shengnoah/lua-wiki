{"title":"scirius规则集管理工具安装和使用","uid":"1e6eda4712b64ed656f315e95c33e3f9","slug":"sec/Suricata/scirius规则集管理工具安装和使用","date":"2024-03-14T07:45:09.054Z","updated":"2024-03-14T07:45:09.055Z","comments":true,"path":"api/articles/sec/Suricata/scirius规则集管理工具安装和使用.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":[],"content":"<h1>scirius规则集管理工具安装和使用</h1>\n<p>scirius源代码网址：</p>\n<p><a href=\"http://www.github.com/StamusNetworks/scirius\">http://www.github.com/StamusNetworks/scirius</a></p>\n<p>Git Clone代码到本地：</p>\n<p>git clone <a href=\"http://www.github.com/StamusNetworks/scirius\">http://www.github.com/StamusNetworks/scirius</a></p>\n<p>scirius源码文档：</p>\n<p><a href=\"https://links.jianshu.com/go?to=https%3A%2F%2Fgithub.com%2FStamusNetworks%2Fscirius%2Fwiki\">https://github.com/StamusNetworks/scirius/wiki</a></p>\n<p><strong>1.简介</strong></p>\n<p>Scirius Community Edition是一个专用于Suricata规则集管理的web界面。 它处理规则文件并更新相关文件。</p>\n<p>Scirius  CE由stamus networks开发，遵循GNU GPLv3.</p>\n<p><strong>2.特征</strong></p>\n<p>Scirius 可以构建由不同来源组成的suricata规则集合。来源或提要可以从<a href=\"https://links.jianshu.com/go?to=https%3A%2F%2Foisf.net%2F\">OISF</a>发布的公共来源中挑选，也可以是自定义的。Scirius将通过在应用你的转换来处理刷新源和组成规则集。可以为每个规则或类别级别进行转换，例如禁用规则或应用阈值（仅降低噪声）。Scirius还提供有关规则活动的统计信息，以提供信息并促进调整。</p>\n<p><strong>3.安装和设置</strong></p>\n<p><strong>（3.1）安装scirius CE</strong></p>\n<p>Scirius CE是一个用Django编写的应用程序， 可以像其他 Django 应用程序一样安装它。</p>\n<p>它需要Django 1.11，但是尚不支持Django 2.0.  Scirius CE还使用<a href=\"https://links.jianshu.com/go?to=https%3A%2F%2Fwebpack.js.org%2F\">webpack</a>来构建CSS和JS包。</p>\n<p><strong>(3.1.1) 安装依赖</strong></p>\n<p>centos 7上安装，执行： yum  install  python-pip python-devel</p>\n<p>下载scirius：git  clone  <a href=\"http://www.github.com/StamusNetworks/scirius\">http://www.github.com/StamusNetworks/scirius</a></p>\n<p>切换到scirius目录下:  cd  scirius/ ,  然后安装django和依赖项,执行: pip  install -r  requirements.txt</p>\n<p>如果出现:ERROR: requests 2.21.0 has requirement urllib3&lt;1.25,&gt;=1.21.1, but you’ll have urllib3 1.25.1 which is incompatible</p>\n<p>建议升级pip install --upgrade urllib3</p>\n<p>要使用处理suricata restart的suri _reloader脚本，还需要安装pyinotify, 执行：pip  install  pyinotify</p>\n<p>安装gitdb模块、GitPython模块 ：pip install gitdb、pip install gitpython==0.3.1-beta2</p>\n<p>对于npm 和 webpack，需要安装稳定版本的npm和webpack 版：</p>\n<p>yum install npm</p>\n<p>全局安装webpack 和webpack-cli:</p>\n<p>npm install  webpack@3.11  -g</p>\n<p>npm install  webpack-cli  -g</p>\n<p>建议也局部安装一次:</p>\n<p>npm install webpack@3.11 --save-dev</p>\n<p>npm install webpack-cli --save-dev</p>\n<p>更新依赖:   npm install</p>\n<p><strong>(3.1.2) 安装scirius</strong></p>\n<p>step1  下载scirius：git  clone  <a href=\"http://www.github.com/StamusNetworks/scirius\">http://www.github.com/StamusNetworks/scirius</a></p>\n<p>step2 切换到scirius/hunt 下执行：cd  scirius/hunt 、 npm  install 、npm run build</p>\n<p>如果此时失败,提示为: “file”: “node_modules/patternfly/dist/sass/_patternfly.scss”, 是出于路径问题,需要增加对应路径.在 hunt/package.json文件中,在字段&quot;scripts&quot;增加路径:</p>\n<p>–include-path=node_modules/bootstrap-sass/assets/stylesheets/</p>\n<p>–include-path=node_modules/font-awesome-sass/assets/stylesheets/</p>\n<p>重新执行npm run build</p>\n<p><strong>(3.1.3) 运行scirius CE</strong></p>\n<p>从源目录内部,可以启动Django数据库 : 切换到上级目录cd  …/,执行python <a href=\"http://manage.py\">manage.py</a> migrate</p>\n<p>默认情况下,身份验证在scirius中,因此您需要创建超级用户账户: python <a href=\"http://manage.py\">manage.py</a> createsuperuser</p>\n<p>在启动应用程序之前，您需要通过运行webpack来构建bundle:   webpack</p>\n<p>如果出现Cannot read property ‘thisCompilation’ of undefined报错,可以按下面步骤解决:</p>\n<p>先卸载:npm uninstall --save-dev extract-text-webpack-plugin</p>\n<p>在重新安装:npm install --save-dev extract-text-webpack-plugin</p>\n<p>再次执行:webpack</p>\n<p><strong>(3.1.4) scirius CE 尝试</strong></p>\n<p>尝试Scirius CE的最简单方法之一是运行Django测试服务器 ; python <a href=\"http://manage.py\">manage.py</a> runserver .通过localhost:8000来访问地址.</p>\n<p>如果出现:/usr/lib/python2.7/site-packages/requests/<strong>init</strong>.py:91: RequestsDependencyWarning: urllib3 (1.25.1…)</p>\n<p>则卸载urllib3和chardet,再重新安装requests,命令如下:</p>\n<p>pip uninstall urllib3</p>\n<p>pip uninstall chardet</p>\n<p>pip install requests</p>\n<p>如果您需要应用程序来侦听可访问的地址，您可以运行类似的地址:python <a href=\"http://manage.py\">manage.py</a> runserver  0.0.0.0:8000</p>\n<p>如果通过浏览器访问时出现：</p>\n<p>Invalid HTTP_HOST header: ‘192.168.111.123:8000’. You may need to add u’192.168.111.123’ to ALLOWED_HOSTS.</p>\n<p>修改scirius下settings.py文件：</p>\n<p>ALLOWED_HOSTS = [‘*’]</p>\n<p><strong>(3.2) suricata 设置</strong></p>\n<p>Scirius CE正在生成一个包含所有激活规则的规则文件。编辑Suricata对象时，必须设置要生成此文件的目录以及要复制的规则集的关联文件.Scirius CE不会触及您的Suricata配置文件suricata.yaml。所以你必须更新它以指向Scirius CE设置数据的目录。</p>\n<p><strong>(3.2.1) 如果您只使用Scirius CE生成的规则，则应该在suricata.yaml文件中配置</strong></p>\n<p>default-rule-path:/path/to/rules</p>\n<p>rule-files:</p>\n<p>-scirius.rules</p>\n<p><strong>(3.2.2) 要使用“ 使用IP信誉”而不是“组”功能，您还需要使用</strong></p>\n<p>reputation-categories-file: /path/to/rules/scirius-categories.txt</p>\n<p>default-reputation-path: /path/to/rules</p>\n<p>reputation-files:</p>\n<p>- scirius-iprep.list</p>\n<p><strong>(3.2.3) 要与Scirius CE交互</strong>，需要检测何时创建/path/to/rules/scirius.reload文件，在这种情况下, 需要重新加载或重新启动Suricata，并在完成后删除重新加载文件.</p>\n<p>一种可能的方法是使用在suricata/scripts目录中的suri_reloader,。语法suri_reloader可以类似于:</p>\n<p>suri_reloader -p  /path/to/rules -l  /var/log/suri-reload.log</p>\n<p>如果此时出现：</p>\n<p>WARNING:root:No daemon support available, install python-daemon if feature is needed。</p>\n<p>安装python-daemon： yum install  python-daemon</p>\n<p>使用-h选项获取完整的选项列表。请注意，suri_reloaded 使用该service命令重新启动或重新加载Suricata。这意味着您需要一个init脚本才能使其正常工作。</p>\n<p><strong>(3.3)与Elasticsearch链接</strong></p>\n<p>如果您将Suricata与Eve日志记录和Elasticsearch一起使用，则可以获取有关显示有关Suricata信息的页面中显示的签名的信息,您还可以获取有关特定规则的图表和详细信息.</p>\n<p>要设置Elasticsearch连接，在目录下编辑settings.py或创建local_settings.py文件scirius以设置该功能。</p>\n<p><a href=\"http://xn--settings-q86n.py\">在settings.py</a>( 路径scirius/scirius/settings.py)中变量名称USE_ELASTICSEARCH设置为True，则激活Elasticsearch 。Elasticsearch的地址存储在 ELASTICSEARCH_ADDRESS变量中并使用该格式IP:port.</p>\n<p>注意:Suricata的名称在Elasticsearch（在对象编辑期间设置）必须等于host事件中的密钥。它也可以在这里编辑：scirius - &gt; suricata - &gt;edit。</p>\n<p>在logstash端，唯一必要的是确保@timestamp等于Suricata事件中提供的时间戳值。为此，如果Suricata事件属于SELKS类型，则可以使用:</p>\n<p>filter{</p>\n<p>if[type]==“SELKS”{</p>\n<p>date{</p>\n<p>match=&gt;[“timestamp”,“ISO8601”]</p>\n<p>}</p>\n<p>}</p>\n<p>}</p>\n<p>这对于避免Scirius CE生成的图形出现故障是必要的.</p>\n<p><strong>(3.4)与Kibana的链接</strong></p>\n<p>如果您使用的是Kibana，可以通过单击左上角的图标获取指向仪表板的链接.要激活该功能，您需要编辑settings.py文件:</p>\n<p>KIBANA_URL =  “<a href=\"http://localhost:9292\">http://localhost:9292</a>”</p>\n<p>USE_KIBANA = True</p>\n<p><strong>4.scirius使用</strong></p>\n<p><strong>(4.1)账户管理</strong></p>\n<p>Scirius CE在默认情况下使用身份验证。 你将需要超级用户才能创建和编辑scirius用户。账户管理允许用户管理 - 编辑/创建和删除不同的用户帐户，更改用户详细信息和/或密码。在此菜单中，您还可以查看当前可用用户的列表以及这些帐户拥有的设置.</p>\n<p><strong>(4.1.1) 添加/创建用户</strong></p>\n<p>要添加/创建新用户：在左上角单击Stamus Networks logo.在下拉 选项中选择Manage Accounts.此时跳转到用户管理界面.</p>\n<p><img src=\"https://upload-images.jianshu.io/upload_images/10950606-5559383451fc122d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/912/format/webp\" alt=\"\"></p>\n<p>图一</p>\n<p>在用户管理界面,在Action下面,点击Add.</p>\n<p><strong>(4.1.2)编辑用户</strong></p>\n<p>在用户管理界面,在用户列表中,点击你要编辑的用户.此时左边Actions出现三个菜单:<a href=\"https://links.jianshu.com/go?to=http%3A%2F%2F192.168.1.222%3A8000%2Faccounts%2Fmanage%2Fuser%2F1%2Fedit\">Edit user</a>,<a href=\"https://links.jianshu.com/go?to=http%3A%2F%2F192.168.1.222%3A8000%2Faccounts%2Fmanage%2Fuser%2F1%2Fpassword\">Change user password</a>,<a href=\"https://links.jianshu.com/go?to=http%3A%2F%2F192.168.1.222%3A8000%2Faccounts%2Fmanage%2Fuser%2F1%2Fdelete\">Delete user</a>,点击<a href=\"https://links.jianshu.com/go?to=http%3A%2F%2F192.168.1.222%3A8000%2Faccounts%2Fmanage%2Fuser%2F1%2Fedit\">Edit user</a>,进行用户编辑</p>\n<p><strong>(4.1.3)修改用户密码</strong></p>\n<p>在用户管理界面,在用户列表中,点击你要编辑的用户.此时左边Actions出现三个菜单:<a href=\"https://links.jianshu.com/go?to=http%3A%2F%2F192.168.1.222%3A8000%2Faccounts%2Fmanage%2Fuser%2F1%2Fedit\">Edit user</a>,<a href=\"https://links.jianshu.com/go?to=http%3A%2F%2F192.168.1.222%3A8000%2Faccounts%2Fmanage%2Fuser%2F1%2Fpassword\">Change user password</a>,<a href=\"https://links.jianshu.com/go?to=http%3A%2F%2F192.168.1.222%3A8000%2Faccounts%2Fmanage%2Fuser%2F1%2Fdelete\">Delete user</a>,点击<a href=\"https://links.jianshu.com/go?to=http%3A%2F%2F192.168.1.222%3A8000%2Faccounts%2Fmanage%2Fuser%2F1%2Fedit\">,</a><a href=\"https://links.jianshu.com/go?to=http%3A%2F%2F192.168.1.222%3A8000%2Faccounts%2Fmanage%2Fuser%2F1%2Fpassword\">Change user password</a>,进行用户密码修改.</p>\n<p><strong>(4.1.4)删除用户</strong></p>\n<p>在用户管理界面,在用户列表中,点击你要编辑的用户.此时左边Actions出现三个菜单:<a href=\"https://links.jianshu.com/go?to=http%3A%2F%2F192.168.1.222%3A8000%2Faccounts%2Fmanage%2Fuser%2F1%2Fedit\">Edit user</a>,<a href=\"https://links.jianshu.com/go?to=http%3A%2F%2F192.168.1.222%3A8000%2Faccounts%2Fmanage%2Fuser%2F1%2Fpassword\">Change user password</a>,<a href=\"https://links.jianshu.com/go?to=http%3A%2F%2F192.168.1.222%3A8000%2Faccounts%2Fmanage%2Fuser%2F1%2Fdelete\">Delete user</a>,点击<a href=\"https://links.jianshu.com/go?to=http%3A%2F%2F192.168.1.222%3A8000%2Faccounts%2Fmanage%2Fuser%2F1%2Fedit\">,</a><a href=\"https://links.jianshu.com/go?to=http%3A%2F%2F192.168.1.222%3A8000%2Faccounts%2Fmanage%2Fuser%2F1%2Fdelete\">Delete user</a>,删除用户.</p>\n<p><strong>(4.1.5)用户权限</strong></p>\n<p>有三个级别的权限：</p>\n<p>a.允许活动用户连接到Scirius，但只具有读取权限</p>\n<p>b.专业用户可以设置Scirius(应用编辑，规则集推送，…）</p>\n<p>c.超级用户具有完全不受限制的访问权限，包括在本地数据库中编辑用户身份验证设置和用户创建.</p>\n<p>在用户管理界面,在用户列表中,点击你要授权的用户.此时左边Actions出现三个菜单:<a href=\"https://links.jianshu.com/go?to=http%3A%2F%2F192.168.1.222%3A8000%2Faccounts%2Fmanage%2Fuser%2F1%2Fedit\">Edit user</a>,<a href=\"https://links.jianshu.com/go?to=http%3A%2F%2F192.168.1.222%3A8000%2Faccounts%2Fmanage%2Fuser%2F1%2Fpassword\">Change user password</a>,<a href=\"https://links.jianshu.com/go?to=http%3A%2F%2F192.168.1.222%3A8000%2Faccounts%2Fmanage%2Fuser%2F1%2Fdelete\">Delete user</a>,点击<a href=\"https://links.jianshu.com/go?to=http%3A%2F%2F192.168.1.222%3A8000%2Faccounts%2Fmanage%2Fuser%2F1%2Fedit\">Edit user</a>,进行用户编辑,该编辑栏有Active , Staff User and Superuser.通过复选框启用/禁用设置权限级别.</p>\n<p><strong>(4.2)规则集管理</strong></p>\n<p><strong>(4.2.1)规则集处理的哲学</strong></p>\n<p>Scirius允许您定义规则集,它定义了Stamus Networks Suricata探测器关于检测和检查的一套规则。您可以拥有任意数量的规则集,且可以将特定数据附加规则集到许多设备.</p>\n<p>规则集由在不同源中选择的组件组成。它可以转换（例如删除某些规则）、更改内容并将在网络探测器在应用规则集中的签名中之前推送过去。</p>\n<p>源是为Suricata提供信息的一组文件。 例如这可以是从官方ET URL（或任何其他URL）下载或在本地上载的EmergingThreats规则集。当包含签名的Source在多个文件中分割时，每个单独文件中的签名集称为类别。</p>\n<p><strong>（4.2.2）用户操作记录</strong></p>\n<p>用户操作记录了规则集管理中执行的所有操作。可以使用Stamus图标下的菜单Actions history访问其历史记录。每个操作都有可选注释，以允许用户相互交互。</p>\n<p><strong>（4.2.3）规则集管理</strong></p>\n<p>规则集管理包含两个主菜单选项：Sources和Rulesets。因此，要创建规则集，必须创建一组Sources然后将它们链接到规则集。完成此操作后，您可以选择要使用的源的哪些元素。例如，对于签名规则集，您可以选择要使用的类别以及要禁用的单个签名。</p>\n<p>定义规则集后，可以将其附加到检测器。为此，只需简单编辑检测器对象并在列表中选择该规则集。</p>\n<p><strong>（4.2.4）创建源</strong></p>\n<p>有两种方法可以创建Source。第一个是使用预定义的公共源，第二个是通过手动添加。</p>\n<p><strong>(4.2.4.1)公共源</strong></p>\n<p>使用预定义的公共源，转到 Sources -&gt; Add public source（Add public source 位于左侧菜单栏Actions下 ）。选择一个来源，然后单击Enabled按钮。在弹出窗口中，您可以编辑源名和要添加源到哪个规则集。在某些情况下，会出现一些字段，例如要输入的规则编辑器提供的密钥。</p>\n<p><strong>(4.2.4.2)手动添加</strong></p>\n<p>手动创建源转到Sources -&gt; Add custom source（Add custom source 位于左侧菜单栏Actions下 ）。然后设置不同的字段并单击Submit。需要手动填写名字、方法、数据类型。</p>\n<p><strong>4.2.4.2.1 名字</strong></p>\n<p>按需求自己定义。</p>\n<p><strong>4.2.4.2.2方法</strong></p>\n<p>**（1）<strong>选择</strong>HTTP URL，**将看到Optional authorization key字段，此字段是可选字段，可用于针对远程服务器对Scirius进行身份验证。它为HTTP请求添加了一个授权标头，允许对大量第三方服务进行身份验证。这可以特别用于从<a href=\"https://links.jianshu.com/go?to=http%3A%2F%2Fwww.misp-project.org%2F\">MISP</a>实例导入签名。有关更多信息，请参阅 <a href=\"https://links.jianshu.com/go?to=https%3A%2F%2Fwww.circl.lu%2Fdoc%2Fmisp%2Fautomation%2F%23automation-api\">MISP文档</a>。使用Optional authorization key也支持使用私有Github存储库来托管签名，正如Github文档中所解释的那样。Optional authorization key应该填充token TOKEN字段，第二个TOKEN是在开发人员设置页面中在Github配置文件中创建的用户个人访问令牌。</p>\n<p>（2）<strong>upload</strong></p>\n<p>上传一个规则文件</p>\n<p><strong>4.2.4.2.3数据类型</strong></p>\n<p><em><strong>（1）Signatures files in tar archive</strong></em> 的来源必须遵循一下一些规则：</p>\n<p>-它必须是tar存档</p>\n<p>-所有文件必须位于rules目录下</p>\n<p>例如，如果要为Suricata 4.0获取ETOpen Ruleset，可以使用:</p>\n<p>名称：ETOpen规则</p>\n<p>URI：<a href=\"https://links.jianshu.com/go?to=https%3A%2F%2Frules.emergingthreats.net%2Fopen%2Fsuricata-4.0%2Femerging.rules.tar.gz\">https://rules.emergingthreats.net/open/suricata-4.0/emerging.rules.tar.gz</a></p>\n<p><strong>（2）Individual signature file</strong>必须是包含签名的单个文件.</p>\n<p>例如，如果您要使用来自abuse.ch的SSL黑名单，您可以使用</p>\n<p>名称：SSLBL <a href=\"http://abuse.ch\">abuse.ch</a></p>\n<p>URI：<a href=\"https://links.jianshu.com/go?to=https%3A%2F%2Fsslbl.abuse.ch%2Fblacklist%2Fsslblacklist.rules\">https</a>:<a href=\"https://links.jianshu.com/go?to=https%3A%2F%2Fsslbl.abuse.ch%2Fblacklist%2Fsslblacklist.rules\">//sslbl.abuse.ch/blacklist/sslblacklist.rules</a></p>\n<p><strong>（3）Other content</strong>数据类型的来源必须是单个文件。它将使用其名称作为文件名复制到Suricata规则目录.</p>\n<p><strong>（4.2.5）更新源</strong></p>\n<p>要更新源，首先需要选择它。为此，请转到Sources然后在数组中选择所需的Source。然后，您可以单击侧栏菜单中的Update。此步骤可能需要很长时间，因为它可能需要一些下载和大量解析。更新后，您可以通过下拉链接中的链接浏览结果。</p>\n<p><strong>（4.2.6）创建规则集</strong></p>\n<p>要创建规则集，请转到Ruleset -&gt;Action-&gt; Add，然后设置规则集的名称并选择要使用的源并单击Submit。您可以选择要使用的源和要应用的转换。有关它们的更多信息，请参阅后面的<a href=\"https://links.jianshu.com/go?to=https%3A%2F%2Fscirius.readthedocs.io%2Fen%2Flatest%2Fruleset.html%23rule-transformations\">规则转换</a>。</p>\n<p><strong>（4.2.7）更新规则集</strong></p>\n<p>要更新规则集，首先需要选择它.为此，请转到Ruleset然后在数组中选择所需的Ruleset。然后，您可以单击侧栏中Update Ruleset菜单。此步骤可能需要很长时间，因为它可能需要下载不同的源和重度解析。当更新完毕后，弹窗将关闭。</p>\n<p><strong>（4.2.8）编辑规则集</strong></p>\n<p>要编辑规则集，首先需要选择它。为此，请转到Ruleset然后在数组中选择所需的Ruleset。然后，您可以单击侧栏中Edit Ruleset菜单.此时Action菜单中有不同的操作：</p>\n<p>-Edit sources，编辑源：选择要在规则集中使用的签名源</p>\n<p>-Edit categories，编辑类别：选择要在规则集中使用的签名类别</p>\n<p>-Add rule to suppressed list，将规则添加到非启用列表：如果规则在此列表中，则它不会是生成的规则集的一部分</p>\n<p>-Remove rule from suppressed list，从抑制列表中删除规则：这将从前面提到的列表中删除规则，从而在规则集中重新启用它</p>\n<p><strong>（4.2.8.1）编辑源</strong></p>\n<p>要选择要使用的源，只需通过复选框选择它们，然后单击Update sources。请注意，选择要启用的类别是添加新源时过程的下一步。</p>\n<p><strong>（4.2.8.2）编辑类别</strong></p>\n<p>要选择要使用的类别，只需通过复选框选择它们，然后单击Update categories。</p>\n<p><strong>（4.2.8.3）将规则添加到不启用列表</strong></p>\n<p>使用搜索字段查找要删除的规则，可以使用签名中的SID或任何其他元素。Scirius将在签名定义中搜索输入的文本，并返回规则列表。然后，您可以通过单击复选框并单击Add selected rules to suppressed list来删除它。</p>\n<p><strong>（4.2.8.4）从不启用列表中删除规则</strong></p>\n<p>要从被抑制列表中删除规则，只需在数组中查找到它们并单击Remove select rules from suppressed list即可。</p>\n<p><strong>（4.2.9）抑制（取消）和阈值处理</strong></p>\n<p>当需要最小化警报数时，可以通过阈值控制特定签名的警报号 。例如，通常阈值处理来自该签名的源或目标IP的每分钟最多1个警报。</p>\n<p>当需要抑制警报时使用抑制 。 也就是说，不从该源或目标IP生成针对该特定签名的警报。</p>\n<p><strong>（4.2.9.1）取消警报</strong></p>\n<p>从任何表中显示的警报列表，如规则集中，单击sid需要抑制的警报的特定内容，这将显示规则详情页面。在这里，您可以单击左侧菜单Action 下的Edit rule，然后在同一位置的菜单中选Suppress rule。在规则页面中，通过位于Ip and Time stats或Advanced Data选项卡上并单击Ip地址旁边的x，还可以从rule页面到达禁止创建页面。</p>\n<p>在新页面上，如果对该特定签名已经存在某些阈值或抑制，您将被告知。可用字段是：</p>\n<p>Ruleset：适用于此配置的规则集</p>\n<p>Track by：（必填字段）按源或目标IP进行跟踪</p>\n<p>Net：  IP和/或特定网络的有效性</p>\n<p>选择规则集，源或目标（针对该特定IP），然后单击+Add。</p>\n<p>您还可以选择对整个网络强制执行抑制和/或使用IP列表。您可以Net像这样在字段中添加：</p>\n<p>10.10.10.0/24,1.1.1.1,2.2.2.2</p>\n<p>您可以通过单击Rules info选项卡来验证抑制。您将获得有关不同（如果有）阈值和抑制配置状态的信息显示。或者，您也可以通过单击Rulesets并选择已应用特定抑制或阈值的规则集来查看该视图。</p>\n<p>要使抑制变为活动状态，您需要Push更新探针的规则集。有关完整说明，请参阅SEE 上的updates -appliances-ruleset和Scirius CE上的<a href=\"https://links.jianshu.com/go?to=https%3A%2F%2Fscirius.readthedocs.io%2Fen%2Flatest%2Fsuricata-ce.html%23updating-suricata\">更新规则集</a>。</p>\n<p><strong>（4.2.9.2）阈值警报</strong></p>\n<p>从显示警报列表的任何表中，单击sid需要抑制的警报的特定内容。这将显示规则页面。在那里，您可以单击左侧菜单Action下的Edit rule，然后在同一菜单中选择Threshold rule。在rule页面中，您还可以通过位于Ip和Time stats或Advanced Data选项卡上，并单击Ip地址旁边(x旁边)的向下箭头，从而到达阈值创建页面。</p>\n<p>在新页面上，如果对该特定签名已经存在某些阈值或抑制，您将被告知。可用字段是：</p>\n<p>Type  阈值的类型。有可能：</p>\n<p>limit  将警报限制为最多“X”次。</p>\n<p>threshold  规则生成警报之前的最低阈值。</p>\n<p>both   应用限制和阈值。</p>\n<p>Track by （必填字段）按源或目标IP进行跟踪</p>\n<p>Count  生成警报的次数。</p>\n<p>Seconds  在那个时间跨度内。</p>\n<p>Ruleset  适用于此配置的规则集</p>\n<p>您可以通过单击选项卡Rules info来验证阈值。您将获得有关不同（如果有）阈值和抑制配置状态的信息显示。或者，您也可以通过单击Rulesets并选择已应用特定抑制或阈值的规则集来查看该视图。</p>\n<p>要使阈值变为活动状态，您需要Push更新探针的规则集。有关完整说明，请参阅SEE 上的updates -appliances-ruleset和Scirius CE上的<a href=\"https://links.jianshu.com/go?to=https%3A%2F%2Fscirius.readthedocs.io%2Fen%2Flatest%2Fsuricata-ce.html%23updating-suricata\">更新规则集</a>。</p>\n<p><strong>（4.2.10）规则转换</strong></p>\n<p>有三种类型的规则转换。</p>\n<p>第一个Action，允许更改特定规则的操作 -  丢弃（drop），拒绝（reject ）或文件存储（filestore）。请注意，这些操作需要有关规则和规则关键字语言的高级知识。</p>\n<p>第二个是Lateral，它修改规则以检测横向移动。</p>\n<p>第三个是Target，它通过添加target关键字来更新签名。</p>\n<p>转换与规则集相关。但是它们可以在规则集上全局设置，也可以在类别或特定规则上设置。因此很容易处理异常。</p>\n<p><strong>（4.2.10.1）动作转换</strong></p>\n<p>一旦您有一个特定的规则，您想要转换 - 在规则的详细信息页面的左侧面板Actions下单击 Transform rule。您将看到一些选择。</p>\n<p>选择形式的转换类型：</p>\n<p>drop - （IPS模式）将规则从alert（警报）转换为丢弃 - 也需要事先明确设置和配置IPS模式。</p>\n<p>reject - （IDPS / hybrid）会将规则从alert（警报）转换为reject，这意味着当触发RST /或dst不可达数据包时，将发送到src和dst IP。</p>\n<p>filestore - 将仅转换那些具有允许文件提取的协议的规则 - 例如alert http…或alert smtp</p>\n<p>选择您希望添加/注册新转换的规则的规则集。</p>\n<p>**注意：**特定规则只能转换一次。</p>\n<p>**注意：**要使用此drop功能，您需要具有有效的IPS设置。</p>\n<p>完成所需的选择后，您可以添加注释以进行问责，然后单击Valid(生效)。您将在Information选项卡中获得有关已转换规则的详细信息。您可以查看并确认转换及其添加的规则集以及任何注释。</p>\n<p>只能转换活动的规则。如果规则在特定规则集中未处于活动状态，则它将不具有左侧面板上可用的转换或抑制/阈值选项。要使其处于活动状态，您可以通过单击左侧面板菜单上的Toggle availability选项来切换该规则的可用性。</p>\n<p>规则详细信息页面的历史记录选项卡将对已转换的规则进行任何注释和更改以进行跟踪。</p>\n<p><strong>（4.2.10.2）横向移动</strong></p>\n<p>签名通常使用EXTERNAL_NET和HOME_NET变量编写，这意味着如果流的两端都在HOME_NET中，它们将不匹配。因此，未检测到横向运动。这种转换将EXTERNAL_NET改为任何能够检测横向运动的。</p>\n<p>该选项可以有三个值：</p>\n<p>No：没有替换</p>\n<p>Yes：EXTERNAL_NET被任何替换</p>\n<p>Auto：如果签名验证某些属性，则完成替换</p>\n<p><strong>（4.2.10.3）目标关键字</strong></p>\n<p>自Suricata 4.0起可用，目标关键字可用于指示触发签名的流的哪一侧是目标。如果存在此密钥，则会增强相关事件以包含攻击的源和目标。</p>\n<p>该选项可以有四个值：</p>\n<p>Auto：如果存在目标，则使用算法确定目标</p>\n<p>Destination：目标是目标IP</p>\n<p>Source：目标是源IP</p>\n<p>None：没有进行转换</p>\n<p><strong>5.hunt</strong></p>\n<p><strong>5.1 介绍</strong></p>\n<p>Hunt是一个专门用于签名和事件可视化和调优的界面。它可以通过Hunt链接从Scirius Enterprise的顶级菜单中获得。</p>\n<p>Hunt使用向下钻取方法来选择事件。通过单击字段值旁边的放大镜图标，可以简单地添加警报事件中包含的协议元数据的过滤器。</p>\n<p>一旦定义了复合过滤器，用户就可以基于它采取行动。该操作将应用于与复合过滤器匹配的所有未来事件。</p>\n<p>在Community Edition中，只能使用可在suricata中用于创建抑制和阈值的字段。目前仅限于src_ip和 dest_ip。</p>\n<p>在Enterprise Edition中，Stamus探针可以对使用任意协议元数据的过滤器应用操作。</p>\n<p><strong>5.2 页面</strong></p>\n<p>可以通过右侧菜单中的单击访问页面。从一个页面跳转到另一个页面将保持过滤器不受影响，允许分析师在可用的不同视图之间切换。</p>\n<p><strong>5.2.1 仪表板（Dashboard）</strong></p>\n<p>此页面显示一个仪表板，其中包含可在警报中看到的最有趣的数据和协议元数据的统计信息。</p>\n<p><strong>5.2.2 签名（Signatures）</strong></p>\n<p>如果已创建签名ID的过滤器，此页面将显示签名或签名页面的列表。</p>\n<p><strong>5.2.3提醒（Alerts）</strong></p>\n<p>此页面将列出单个警报事件。可以展开事件以查看包括有关它的元数据的所有详细信息。</p>\n<p><strong>5.2.4动作（Actions）</strong></p>\n<p>此页面显示操作列表。列表已排序，过滤器按升序应用。</p>\n<p>可以重新排序动作以调整过滤器的相应优先级。为此，只需单击操作右侧的三个点并填写表单即可</p>\n<p><strong>5.2.5历史（History）</strong></p>\n<p>此页面显示用户在Scirius实例上执行的修改的历史记录。</p>\n<p><strong>5.2.6 主页（home）</strong></p>\n<p>链接到Scirius主页。</p>\n<p><strong>5.3. 动作</strong></p>\n<p><strong>5.3.1 抑制(取消)</strong></p>\n<p>抑制操作将在匹配事件到达存储之前将其删除。</p>\n<p>在Scirius CE中，需要具有签名ID和源或目标IP的过滤器才能创建操作。</p>\n<p>对于Stamus探针，可以使用任何字段。</p>\n<p><strong>5.3.2 阈值</strong></p>\n<p>阈值操作仅在达到定义的阈值时保持警报。</p>\n<p>在Scirius CE中，需要具有签名ID的过滤器才能创建操作。</p>\n<p>在Scirius EE和Stamus探针中，可以使用任何字段。</p>\n<p><strong>5.3.3 标签</strong></p>\n<p>一个标签可以根据过滤器进行设置。它将在所有匹配事件上设置，并允许轻松分类。</p>\n<p>目前有2个值：</p>\n<p>Informational，信息：信息足够好，不会被压制，以防万一</p>\n<p>Relevant，相关：事件是相关的，需要进行调查</p>\n<p>所有未标记的事件都可以在Untagged标签下找到。如果正确设置了已定义的操作，则应该是新签名或未引用的行为。所以应该进行调查和分类。</p>\n<p>标记操作仅适用于Scirius EE和Stamus探针。</p>\n<p><strong>5.3.4 标签和保持</strong></p>\n<p>一个标签，并保持动作类似于标签的动作，但匹配的事件将不会受到任何后来的行动处理发现的行动来抑制或阈值。</p>\n<p>标记和保持操作仅适用于Scirius EE和Stamus探针。</p>\n<p><strong>5.4 键盘快捷键</strong></p>\n<p><strong>5.4.1 标签过滤</strong></p>\n<p>这是完整的清单：</p>\n<p>A：显示所有事件</p>\n<p>R：仅显示相关事件</p>\n<p>I：仅显示信息事件</p>\n<p>U：仅显示未标记的事件</p>\n<p><strong>6.suricata管理</strong></p>\n<p><strong>6.1 设置</strong></p>\n<p>Suricata编辑页面允许您设置Suricata的参数。</p>\n<p>参数如下：</p>\n<p>Name：探测器的主机名，确保它与JSON事件中的主机字段的值匹配</p>\n<p>Descr：suricata的描述</p>\n<p>Rules directory：将在此目录中创建scirius.rules文件。Suricata必须只使用此文件</p>\n<p>Suricata configuration file：用于检测某些配置设置</p>\n<p>Ruleset：选择要使用的规则集</p>\n<p><strong>6.2更新规则集</strong></p>\n<p>要更新Suricata规则集，您可以转到Suricata -&gt; Update（Update在 Actions 菜单中）。然后你必须选择你想要做的动作：</p>\n<p>Update：下载规则集使用的源的最新版本</p>\n<p>Build：基于当前版本的源构建Suricata规则集</p>\n<p>Push：触发Suricata重新加载以使其与最新的构建规则集一起运行</p>\n<p>您还可以通过运行来更新规则集并触发Suricata重新加载：</p>\n<p>python  <a href=\"http://manage.py\">manage.py</a>  update suricata</p>\n<p><strong>7.备份</strong></p>\n<p>要开始备份，请运行：</p>\n<p>python  <a href=\"http://manage.py\">manage.py</a>  scbackup</p>\n<p>要恢复备份并清除所有数据，您可以运行</p>\n<p>python  <a href=\"http://manage.py\">manage.py</a>  screstore</p>\n<p>python  <a href=\"http://manage.py\">manage.py</a>  migrate</p>\n<p>这将恢复最新的备份。要选择其他备份，请将备份文件名指定为第一个参数。要获取可用备份列表，请使用</p>\n<p>python <a href=\"http://manage.py\">manage.py</a> listbackups</p>\n<p>您无法将备份还原到比已完成备份的scirius更旧的scirius。</p>\n<p>使用默认配置文件，备份在/ var / backups中的磁盘上完成，但也可以使用其他方法。由于Scirius CE使用django-dbbackup应用程序进行备份和还原过程，因此它可以从此应用程序中的所有可用方法中受益。这包括至少：</p>\n<p>FTP</p>\n<p>Amazon AWS</p>\n<p>Dropbox的</p>\n<p>有关可用方法及其<a href=\"https://links.jianshu.com/go?to=http%3A%2F%2Fdjango-dbbackup.readthedocs.org%2Fen%2Flatest%2Fstorage.html\">配置</a>的更多信息，请参阅<a href=\"https://links.jianshu.com/go?to=https%3A%2F%2Fdjango-dbbackup.readthedocs.io%2Fen%2Flatest%2Fstorage.html\">django-dbbackup</a>配置。</p>\n","text":"scirius规则集管理工具安装和使用 scirius源代码网址： http://www.github.com/StamusNetworks/scirius Git Clone代码到本地： git clone http://www.github.com/StamusNetwork...","link":"","photos":[],"count_time":{"symbolsCount":"13k","symbolsTime":"12 mins."},"categories":[{"name":"安全","slug":"安全","count":37,"path":"api/categories/安全.json"}],"tags":[{"name":"scirius","slug":"scirius","count":1,"path":"api/tags/scirius.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\"><span class=\"toc-text\">scirius规则集管理工具安装和使用</span></a></li></ol>","author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"Suricata与TheHiveCortex结合使用","uid":"b11fd065488f675e75d28e383528140e","slug":"sec/Suricata/Suricata与TheHiveCortex结合使用","date":"2024-03-14T07:45:09.054Z","updated":"2024-03-14T07:45:09.054Z","comments":true,"path":"api/articles/sec/Suricata/Suricata与TheHiveCortex结合使用.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":null,"text":"Suricata与TheHiveCortex结合使用 Suricata 是一个强大的网络威胁检测引擎，而 TheHive Cortex 则是一个可观察性分析和主动响应引擎。虽然它们是不同的工具，但可以结合使用以增强安全分析和响应能力。 下面是关于 Suricata 和 TheHi...","link":"","photos":[],"count_time":{"symbolsCount":703,"symbolsTime":"1 mins."},"categories":[{"name":"安全","slug":"安全","count":37,"path":"api/categories/安全.json"}],"tags":[{"name":"Cortex","slug":"Cortex","count":3,"path":"api/tags/Cortex.json"},{"name":"Suricata","slug":"Suricata","count":1,"path":"api/tags/Suricata.json"},{"name":"TheHive","slug":"TheHive","count":4,"path":"api/tags/TheHive.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"网络安全中的图分析技术","uid":"12d8337630bcec898f13cc334cae698d","slug":"sec/网络安全中的图分析技术","date":"2024-03-14T07:45:09.053Z","updated":"2024-03-14T07:45:09.054Z","comments":true,"path":"api/articles/sec/网络安全中的图分析技术.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":[],"text":"网络安全中的图分析技术 日益增多的重大安全事件引发了人们对打击网络威胁的兴趣。为了使合作能够防止攻击，必须有结构化和标准化的格式来描述事件。目前使用的格式复杂而广泛，因为它们是为自动化处理而设计的。这妨碍了可读性，并阻止人们理解记录的事件。 网络安全专家的工作很有挑战性。他们分析...","link":"","photos":[],"count_time":{"symbolsCount":"3.1k","symbolsTime":"3 mins."},"categories":[{"name":"安全","slug":"安全","count":37,"path":"api/categories/安全.json"}],"tags":[{"name":"安全运营","slug":"安全运营","count":4,"path":"api/tags/安全运营.json"},{"name":"图数据库","slug":"图数据库","count":1,"path":"api/tags/图数据库.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}}}