{"title":"教你理解和构建GPT Tokenizer","uid":"3f78d971eabe4d648c246dd6ba6afdb2","slug":"course/教你理解和构建GPT Tokenizer","date":"2024-03-14T07:45:09.029Z","updated":"2024-03-14T07:45:09.029Z","comments":true,"path":"api/articles/course/教你理解和构建GPT Tokenizer.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","content":"<h1 id=\"教你理解和构建gpt-tokenizer\"><a class=\"markdownIt-Anchor\" href=\"#教你理解和构建gpt-tokenizer\"></a> 教你理解和构建GPT Tokenizer</h1>\n<p>Open AI传奇研究员Andrej Karpathy的新课，教你理解和构建GPT Tokenizer。</p>\n<p>他可以把相当复杂的LLM概念用非常好理解的方式讲出来。希望了解LLM的强烈建议听一下他的课，包括一些历史课程。</p>\n<p>用GPT-4翻译了一下这节课，感兴趣可以听一下。字幕文件下载和历史课程会放最后。</p>\n<p>补充一下视频介绍：</p>\n<p>分词器是大语言模型（LLM）处理流程中一个独立且关键的环节。它们有专属的训练数据集、采用特定的训练算法——字节对编码（Byte Pair Encoding），训练完成后，分词器能够执行两个核心功能：encode() 函数将普通文本字符串转换为词元，而 decode() 函数则能将词元还原为原始文本字符串。在这场讲座中，我们将一步步揭开 OpenAI GPT 系列分词器的构建过程。</p>\n<p>我们将发现，许多大语言模型(LLM)表现出的异常行为和问题，其实都源于标记化(tokenization)这一环节。我们会针对这些问题进行详细讨论，探究标记化为何成为问题的关键所在，以及为什么最理想的情况是有人能够找到办法，完全去除这一处理阶段。</p>\n<p>00:00:00 intro: Tokenization, GPT-2 paper, tokenization-related issues<br />\n00:05:50 tokenization by example in a Web UI (tiktokenizer)<br />\n00:14:56 strings in Python, Unicode code points<br />\n00:18:15 Unicode byte encodings, ASCII, UTF-8, UTF-16, UTF-32<br />\n00:22:47 daydreaming: deleting tokenization<br />\n00:23:50 Byte Pair Encoding (BPE) algorithm walkthrough<br />\n00:27:02 starting the implementation<br />\n00:28:35 counting consecutive pairs, finding most common pair<br />\n00:30:36 merging the most common pair<br />\n00:34:58 training the tokenizer: adding the while loop, compression ratio<br />\n00:39:20 tokenizer/LLM diagram: it is a completely separate stage<br />\n00:42:47 decoding tokens to strings<br />\n00:48:21 encoding strings to tokens<br />\n00:57:36 regex patterns to force splits across categories<br />\n01:11:38 tiktoken library intro, differences between GPT-2/GPT-4 regex<br />\n01:14:59 GPT-2 <a href=\"http://encoder.py\">encoder.py</a> released by OpenAI walkthrough<br />\n01:18:26 special tokens, tiktoken handling of, GPT-2/GPT-4 differences<br />\n01:25:28 minbpe exercise time! write your own GPT-4 tokenizer<br />\n01:28:42 sentencepiece library intro, used to train Llama 2 vocabulary<br />\n01:43:27 how to set vocabulary set? revisiting <a href=\"http://gpt.py\">gpt.py</a> transformer<br />\n01:48:11 training new tokens, example of prompt compression<br />\n01:49:58 multimodal [image, video, audio] tokenization with vector quantization<br />\n01:51:41 revisiting and explaining the quirks of LLM tokenization<br />\n02:10:20 final recommendations</p>\n<p><a href=\"https://pan.quark.cn/s/60d51adb8ecc#/list/share\">https://pan.quark.cn/s/60d51adb8ecc#/list/share</a></p>\n<p><img src=\"https://gitee.com/shengnoah/picture/raw/master/20240221124153.png\" alt=\"image.png\" /></p>\n","text":" 教你理解和构建GPT Tokenizer Open AI传奇研究员Andrej Karpathy的新课，教你理解和构建GPT Tokenizer。 他可以把相当复杂的LLM概念用非常好理解的方式讲出来。希望了解LLM的强烈建议听一下他的课，包括一些历史课程。 用GPT-4翻译了...","link":"","photos":[],"count_time":{"symbolsCount":"1.9k","symbolsTime":"2 mins."},"categories":[{"name":"课程","slug":"课程","count":1,"path":"api/categories/课程.json"}],"tags":[{"name":"GPT","slug":"GPT","count":1,"path":"api/tags/GPT.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E6%95%99%E4%BD%A0%E7%90%86%E8%A7%A3%E5%92%8C%E6%9E%84%E5%BB%BAgpt-tokenizer\"><span class=\"toc-text\"> 教你理解和构建GPT Tokenizer</span></a></li></ol>","author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"","uid":"f73a8e23e6f6f669cf99c7dba8fa0722","slug":"kanbanfiles/gitee与pico做成的图床图片文件网站引入图片时无法显示怎么解决","date":"2024-03-14T07:45:09.030Z","updated":"2024-03-14T07:45:09.030Z","comments":true,"path":"api/articles/kanbanfiles/gitee与pico做成的图床图片文件网站引入图片时无法显示怎么解决.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":"gitee与pico做成的图床图片文件网站引入图片时无法显示怎么解决？ 如果在gitee或pico搭建的图床图片文件网站中，引入的图片无法显示，可能有以下几种解决方法： 检查图片链接是否正确：确保引入图片时使用的是正确的链接地址。可以尝试在浏览器中直接打开该链接来确认图片是否能够...","link":"","photos":[],"count_time":{"symbolsCount":"2.2k","symbolsTime":"2 mins."},"categories":[],"tags":[],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"Hexo使用Gitee+PicGO图墙图片不显示","uid":"70ccad85c177ffedfa95e18f77517e68","slug":"kanbanfiles/Hexo使用Gitee+PicGO图墙图片不显示","date":"2024-03-14T07:45:09.029Z","updated":"2024-03-14T07:45:09.030Z","comments":true,"path":"api/articles/kanbanfiles/Hexo使用Gitee+PicGO图墙图片不显示.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":" 如何只对网页中的img标签进行no-referrer限制。 要对网页中的img标签进行no-referrer限制，您可以使用以下方法： 使用JavaScript：在网页中插入以下JavaScript代码，它将遍历所有的img标签，并为每个img标签设置rel属性为&quot;n...","link":"","photos":[],"count_time":{"symbolsCount":"1.3k","symbolsTime":"1 mins."},"categories":[{"name":"obsidian","slug":"obsidian","count":8,"path":"api/categories/obsidian.json"},{"name":"hexo","slug":"obsidian/hexo","count":3,"path":"api/categories/obsidian/hexo.json"}],"tags":[{"name":"obsidian","slug":"obsidian","count":3,"path":"api/tags/obsidian.json"},{"name":"hexo","slug":"hexo","count":1,"path":"api/tags/hexo.json"},{"name":"picgo","slug":"picgo","count":1,"path":"api/tags/picgo.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}}}