{"title":"waf.md","uid":"af3dedc41147fb62d7e9d45739663031","slug":"old_topic/2016-09-17-303","date":"2016-09-17T14:50:18.000Z","updated":"2024-03-14T07:45:09.224Z","comments":true,"path":"api/articles/old_topic/2016-09-17-303.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","content":"<hr />\n<h2 id=\"category-apiredirect_from-docslatestapiwaftitle-waf防火墙sort_title-9flag-2\"><a class=\"markdownIt-Anchor\" href=\"#category-apiredirect_from-docslatestapiwaftitle-waf防火墙sort_title-9flag-2\"></a> category: API<br />\nredirect_from:<br />\n- /docs/latest/api/waf/<br />\ntitle: “WAF防火墙”<br />\nsort_title: “9”<br />\nflag: “2”</h2>\n<h4 id=\"1-开启或关闭此插件\"><a class=\"markdownIt-Anchor\" href=\"#1-开启或关闭此插件\"></a> 1) 开启或关闭此插件</h4>\n<p><strong>请求</strong></p>\n<table>\n<thead>\n<tr>\n<th>URI</th>\n<th>Method</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>/waf/enable</td>\n<td>Post</td>\n</tr>\n</tbody>\n</table>\n<p><strong>参数</strong></p>\n<table>\n<thead>\n<tr>\n<th>名称</th>\n<th>类型</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>enable</td>\n<td>int</td>\n<td>0关闭1开启</td>\n</tr>\n</tbody>\n</table>\n<p><strong>返回结果</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#123;\n    &quot;msg&quot;:&quot;关闭成功&quot;,\n    &quot;success&quot;:true\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<h4 id=\"2-获取所有配置信息\"><a class=\"markdownIt-Anchor\" href=\"#2-获取所有配置信息\"></a> 2) 获取所有配置信息</h4>\n<p><strong>请求</strong></p>\n<table>\n<thead>\n<tr>\n<th>URI</th>\n<th>Method</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>/waf/configs</td>\n<td>Get</td>\n</tr>\n</tbody>\n</table>\n<p><strong>参数</strong><br />\n无</p>\n<p><strong>返回结果</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#123;\n    &quot;data&quot;: &#123;\n        &quot;enable&quot;: true,\n        &quot;rules&quot;: [\n            &#123;\n                &quot;enable&quot;: true,\n                &quot;handle&quot;: &#123;\n                    &quot;log&quot;: true, &#x2F;&#x2F;是否记录此条规则的匹配日志\n                    &quot;code&quot;: 403, &#x2F;&#x2F; 返回的http状态码\n                    &quot;stat&quot;: true, &#x2F;&#x2F;是否将此次记录加入到统计中\n                    &quot;perform&quot;: &quot;deny&quot; &#x2F;&#x2F; deny or allow, deny则拒绝后续访问，以code为http状态码返回，allow则放过这条请求\n                &#125;,\n                &quot;id&quot;: &quot;C4DDC90B-F05C-4F69-94E1-6FCBC4F88392&quot;,\n                &quot;time&quot;: &quot;2016-06-21 16:04:58&quot;,\n                &quot;name&quot;: &quot;禁用管理功能&quot;,\n                &quot;judge&quot;: &#123; &#x2F;&#x2F; “条件判断模块”配置\n                    &quot;type&quot;: 0,\n                    &quot;conditions&quot;: [\n                        &#123;\n                            &quot;type&quot;: &quot;URI&quot;,\n                            &quot;operator&quot;: &quot;match&quot;,\n                            &quot;value&quot;: &quot;^&#x2F;admin&#x2F;&quot;\n                        &#125;\n                    ]\n                &#125;\n            &#125;\n        ]\n    &#125;,\n    &quot;success&quot;: true\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h4 id=\"3-新建某条规则\"><a class=\"markdownIt-Anchor\" href=\"#3-新建某条规则\"></a> 3) 新建某条规则</h4>\n<p><strong>请求</strong></p>\n<table>\n<thead>\n<tr>\n<th>URI</th>\n<th>Method</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>/waf/configs</td>\n<td>Put</td>\n<td>Content-Type:application/x-www-form-urlencoded; charset=UTF-8</td>\n</tr>\n</tbody>\n</table>\n<p><strong>参数</strong></p>\n<table>\n<thead>\n<tr>\n<th>名称</th>\n<th>类型</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>rule</td>\n<td>string</td>\n<td>指一条&quot;规则&quot;json格式的字符串</td>\n</tr>\n</tbody>\n</table>\n<p>&quot;规则&quot;格式示例如下，具体格式可参考&quot;获取所有配置&quot;API中返回数据中的data.rules[0]格式:</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#123;\n    &quot;name&quot;: &quot;waf规则修改示例&quot;,\n    &quot;judge&quot;: &#123;\n        &quot;type&quot;: 1,\n        &quot;conditions&quot;: [\n            &#123;\n                &quot;type&quot;: &quot;URI&quot;,\n                &quot;operator&quot;: &quot;match&quot;,\n                &quot;value&quot;: &quot;&#x2F;waf&quot;\n            &#125;,\n            &#123;\n                &quot;type&quot;: &quot;PostParams&quot;,\n                &quot;name&quot;: &quot;uid&quot;,\n                &quot;operator&quot;: &quot;&#x3D;&quot;,\n                &quot;value&quot;: &quot;456&quot;\n            &#125;\n        ]\n    &#125;,\n    &quot;handle&quot;: &#123;\n        &quot;log&quot;: true, &#x2F;&#x2F;是否记录此条规则的匹配日志\n        &quot;code&quot;: 403, &#x2F;&#x2F; 返回的http状态码\n        &quot;stat&quot;: true, &#x2F;&#x2F;是否将此次记录加入到统计中\n        &quot;perform&quot;: &quot;deny&quot; &#x2F;&#x2F; deny or allow, deny则拒绝后续访问，以code为http状态码返回，allow则放过这条请求\n    &#125;,\n    &quot;enable&quot;: true\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p><strong>返回结果</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#123;\n    &quot;success&quot;: true,\n    &quot;msg&quot;: &quot;新建规则成功&quot;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<h4 id=\"4-编辑某条规则信息\"><a class=\"markdownIt-Anchor\" href=\"#4-编辑某条规则信息\"></a> 4) 编辑某条规则信息</h4>\n<p><strong>请求</strong></p>\n<table>\n<thead>\n<tr>\n<th>URI</th>\n<th>Method</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>/waf/configs</td>\n<td>Post</td>\n<td>Content-Type:application/x-www-form-urlencoded; charset=UTF-8</td>\n</tr>\n</tbody>\n</table>\n<p><strong>参数</strong></p>\n<table>\n<thead>\n<tr>\n<th>名称</th>\n<th>类型</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>rule</td>\n<td>string</td>\n<td>指修改后的&quot;规则&quot;</td>\n</tr>\n</tbody>\n</table>\n<p>&quot;规则&quot;格式示例如下:</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#123;\n    &quot;id&quot;:&quot;C4DDC90B-F05C-4F69-94E1-6FCBC4F88392&quot;,\n    &quot;name&quot;: &quot;跳转&quot;,\n    &quot;judge&quot;: &#123;\n        &quot;type&quot;: 0,\n        &quot;conditions&quot;: [\n            &#123;\n                &quot;type&quot;: &quot;URI&quot;,\n                &quot;operator&quot;: &quot;match&quot;,\n                &quot;value&quot;: &quot;&#x2F;abc&quot;\n            &#125;\n        ]\n    &#125;,\n    &quot;handle&quot;: &#123;\n        &quot;log&quot;: true, &#x2F;&#x2F;是否记录此条规则的匹配日志\n        &quot;code&quot;: 405, &#x2F;&#x2F; 返回的http状态码\n        &quot;stat&quot;: true, &#x2F;&#x2F;是否将此次记录加入到统计中\n        &quot;perform&quot;: &quot;deny&quot; &#x2F;&#x2F; deny or allow, deny则拒绝后续访问，以code为http状态码返回，allow则放过这条请求\n    &#125;,\n    &quot;enable&quot;: true\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p><strong>返回结果</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#123;\n    &quot;success&quot;: true,\n    &quot;msg&quot;: &quot;修改成功&quot;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<h4 id=\"5-删除某条规则\"><a class=\"markdownIt-Anchor\" href=\"#5-删除某条规则\"></a> 5) 删除某条规则</h4>\n<p><strong>请求</strong></p>\n<table>\n<thead>\n<tr>\n<th>URI</th>\n<th>Method</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>/waf/configs</td>\n<td>Delete</td>\n<td>Content-Type:application/x-www-form-urlencoded; charset=UTF-8</td>\n</tr>\n</tbody>\n</table>\n<p><strong>参数</strong></p>\n<table>\n<thead>\n<tr>\n<th>名称</th>\n<th>类型</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>rule_id</td>\n<td>string</td>\n<td>指一条&quot;规则&quot;的id</td>\n</tr>\n</tbody>\n</table>\n<p><strong>返回结果</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#123;\n    &quot;success&quot;: true,\n    &quot;msg&quot;: &quot;删除成功&quot;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<h4 id=\"6-获取数据库中此插件的最新配置\"><a class=\"markdownIt-Anchor\" href=\"#6-获取数据库中此插件的最新配置\"></a> 6) 获取数据库中此插件的最新配置</h4>\n<p><strong>请求</strong></p>\n<table>\n<thead>\n<tr>\n<th>URI</th>\n<th>Method</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>/waf/fetch_config</td>\n<td>Get</td>\n</tr>\n</tbody>\n</table>\n<p><strong>参数</strong><br />\n无</p>\n<p><strong>返回结果</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#123;\n    &quot;success&quot;: true,\n    &quot;data&quot;: &#123;\n        &quot;enable&quot;: true, &#x2F;&#x2F;是否开启了此插件\n        &quot;rules&quot;: [] &#x2F;&#x2F; 该插件包含的规则列表\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>具体规则格式见以上API描述</p>\n<h4 id=\"7-将数据库中最新配置更新到此orange节点\"><a class=\"markdownIt-Anchor\" href=\"#7-将数据库中最新配置更新到此orange节点\"></a> 7) 将数据库中最新配置更新到此orange节点</h4>\n<p><strong>请求</strong></p>\n<table>\n<thead>\n<tr>\n<th>URI</th>\n<th>Method</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>/waf/sync</td>\n<td>Post</td>\n<td>Content-Type:application/x-www-form-urlencoded; charset=UTF-8</td>\n</tr>\n</tbody>\n</table>\n<p><strong>参数</strong><br />\n无</p>\n<p><strong>返回结果</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#123;\n    &quot;success&quot;: true, &#x2F;&#x2F;成功或失败\n    &quot;msg&quot;: &quot;&quot; &#x2F;&#x2F;描述信息\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<h4 id=\"8-获取防火墙统计信息\"><a class=\"markdownIt-Anchor\" href=\"#8-获取防火墙统计信息\"></a> 8) 获取防火墙统计信息</h4>\n<p><strong>请求</strong></p>\n<table>\n<thead>\n<tr>\n<th>URI</th>\n<th>Method</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>/waf/stat</td>\n<td>Get</td>\n</tr>\n</tbody>\n</table>\n<p><strong>参数</strong></p>\n<p>无</p>\n<p><strong>返回结果</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#123;\n    &quot;data&quot;: &#123;\n        &quot;statistics&quot;: [&#123;\n            &quot;count&quot;: 7, &#x2F;&#x2F;命中规则的请求个数\n            &quot;rule_id&quot;: &quot;C4DDC90B-F05C-4F69-94E1-6FCBC4F88392&quot;,&#x2F;&#x2F; 规则id\n        &#125;]\n    &#125;,\n    &quot;success&quot;: true\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n","text":" category: API redirect_from: - /docs/latest/api/waf/ title: “WAF防火墙” sort_title: “9” flag: “2” 1) 开启或关闭此插件 请求 URI Method /waf/enable Post 参...","link":"","photos":[],"count_time":{"symbolsCount":"5.2k","symbolsTime":"5 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#category-apiredirect_from-docslatestapiwaftitle-waf%E9%98%B2%E7%81%AB%E5%A2%99sort_title-9flag-2\"><span class=\"toc-text\"> category: API\nredirect_from:\n- &#x2F;docs&#x2F;latest&#x2F;api&#x2F;waf&#x2F;\ntitle: “WAF防火墙”\nsort_title: “9”\nflag: “2”</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#1-%E5%BC%80%E5%90%AF%E6%88%96%E5%85%B3%E9%97%AD%E6%AD%A4%E6%8F%92%E4%BB%B6\"><span class=\"toc-text\"> 1) 开启或关闭此插件</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#2-%E8%8E%B7%E5%8F%96%E6%89%80%E6%9C%89%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF\"><span class=\"toc-text\"> 2) 获取所有配置信息</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#3-%E6%96%B0%E5%BB%BA%E6%9F%90%E6%9D%A1%E8%A7%84%E5%88%99\"><span class=\"toc-text\"> 3) 新建某条规则</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#4-%E7%BC%96%E8%BE%91%E6%9F%90%E6%9D%A1%E8%A7%84%E5%88%99%E4%BF%A1%E6%81%AF\"><span class=\"toc-text\"> 4) 编辑某条规则信息</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#5-%E5%88%A0%E9%99%A4%E6%9F%90%E6%9D%A1%E8%A7%84%E5%88%99\"><span class=\"toc-text\"> 5) 删除某条规则</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#6-%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%AD%E6%AD%A4%E6%8F%92%E4%BB%B6%E7%9A%84%E6%9C%80%E6%96%B0%E9%85%8D%E7%BD%AE\"><span class=\"toc-text\"> 6) 获取数据库中此插件的最新配置</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#7-%E5%B0%86%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%AD%E6%9C%80%E6%96%B0%E9%85%8D%E7%BD%AE%E6%9B%B4%E6%96%B0%E5%88%B0%E6%AD%A4orange%E8%8A%82%E7%82%B9\"><span class=\"toc-text\"> 7) 将数据库中最新配置更新到此orange节点</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#8-%E8%8E%B7%E5%8F%96%E9%98%B2%E7%81%AB%E5%A2%99%E7%BB%9F%E8%AE%A1%E4%BF%A1%E6%81%AF\"><span class=\"toc-text\"> 8) 获取防火墙统计信息</span></a></li></ol></li></ol></li></ol>","author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"api_server.md","uid":"e3aed5e630276c44941c876b650cbd89","slug":"old_topic/2016-09-17-304","date":"2016-09-17T14:50:18.000Z","updated":"2024-03-14T07:45:09.160Z","comments":true,"path":"api/articles/old_topic/2016-09-17-304.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":" category: Advanced redirect_from: - /docs/latest/advanced/api_server/ title: “如何使用Open API” sort_title: “2” Orange提供了各种API用于实现第三方需求， 如： 根据A...","link":"","photos":[],"count_time":{"symbolsCount":257,"symbolsTime":"1 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"build_plugin.md","uid":"6c3ff5d54ee84215c9897a80659f0b5f","slug":"old_topic/2016-09-17-305","date":"2016-09-17T14:50:18.000Z","updated":"2024-03-14T07:45:09.168Z","comments":true,"path":"api/articles/old_topic/2016-09-17-305.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":" category: Advanced redirect_from: - /docs/latest/advanced/build_plugin/ title: “创建自定义插件” sort_title: “3” to be continued… ","link":"","photos":[],"count_time":{"symbolsCount":124,"symbolsTime":"1 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}}}