{"title":"MoonScript for GrayLog","uid":"bace4a0f855ab931a94c6323590dcc00","slug":"old_topic/2016-09-17-368","date":"2016-09-17T14:50:18.000Z","updated":"2024-03-14T07:45:09.203Z","comments":true,"path":"api/articles/old_topic/2016-09-17-368.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","content":"<p>GrayLog REST API Wrapper for Moonscript</p>\n<p>此程序是Graylog REST对外提供的API的一个Moonscript的Wrapper封装，把REST接口提供的数据服务，变成通过函数调用的方式取得相应REST接口返回的数据。</p>\n<p>下面是一个实际的基于Lapis框架程序中调用此SDK的例子：</p>\n<pre class=\"line-numbers language-lua\" data-language=\"lua\"><code class=\"language-lua\">class App extends lapis<span class=\"token punctuation\">.</span>Application\n  <span class=\"token string\">\"/testcase\"</span><span class=\"token punctuation\">:</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span>\n    <span class=\"token comment\">--准备对应REST的输入参数，如果相应该有的项目没有设定会输出NG原因。</span>\n    param_data<span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>\n        fields<span class=\"token punctuation\">:</span><span class=\"token string\">'username'</span><span class=\"token punctuation\">,</span>\n        limit<span class=\"token punctuation\">:</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span>\n        query<span class=\"token punctuation\">:</span><span class=\"token string\">'*'</span><span class=\"token punctuation\">,</span>\n        from<span class=\"token punctuation\">:</span> <span class=\"token string\">'2017-01-05 00:00:00'</span><span class=\"token punctuation\">,</span>\n        to<span class=\"token punctuation\">:</span><span class=\"token string\">'2017-01-06 00:00:00'</span><span class=\"token punctuation\">,</span>\n        filter<span class=\"token punctuation\">:</span><span class=\"token string\">'streams'</span><span class=\"token operator\">..</span><span class=\"token string\">':'</span><span class=\"token operator\">..</span><span class=\"token string\">'673b1666ca624a6231a460fa'</span>\n    <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token comment\">--进行鉴权信息设定</span>\n    url  <span class=\"token operator\">=</span> GMoonSDK\\auth <span class=\"token string\">'supervisor'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'password'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'127.0.0.1'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'12600'</span>\n    \n    <span class=\"token comment\">--调用对应'TYPE'相对应的REST服务，返回结果。</span>\n    ret <span class=\"token operator\">=</span> GMoonSDK\\dealStream <span class=\"token string\">'s_ua'</span><span class=\"token punctuation\">,</span> param_data\n    ret\n```    \n上文提到 ‘TYPE’， 其实就是对Endpoints的一种编号，基本上和GrayLog REST API是一对一关系。\n\n```lua\n    endpoints<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token string\">'s_uat'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">&#123;</span><span class=\"token string\">'/search/universal/absolute/terms'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">&#123;</span><span class=\"token string\">'field'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'query'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'from'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'to'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'limit'</span><span class=\"token punctuation\">&#125;</span> <span class=\"token punctuation\">&#125;</span>\n        <span class=\"token string\">'s_ua'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">&#123;</span><span class=\"token string\">'/search/universal/absolute'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">&#123;</span><span class=\"token string\">'fields'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'query'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'from'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'to'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'limit'</span><span class=\"token punctuation\">&#125;</span> <span class=\"token punctuation\">&#125;</span>\n        <span class=\"token string\">'s_urt'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">&#123;</span><span class=\"token string\">'/search/universal/relative/terms'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">&#123;</span><span class=\"token string\">'field'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'query'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'range'</span><span class=\"token punctuation\">&#125;</span> <span class=\"token punctuation\">&#125;</span>\n        <span class=\"token string\">'s_ut'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">&#123;</span><span class=\"token string\">'/search/universal/relative'</span><span class=\"token punctuation\">:</span><span class=\"token punctuation\">&#123;</span><span class=\"token string\">'fields'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'query'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'range'</span><span class=\"token punctuation\">&#125;</span> <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>理论上说，可以个修改以上的数据结构，对应各种REST API的服封装(GET),只要知道对应URL与可接收的参数列表。</p>\n","text":"GrayLog REST API Wrapper for Moonscript 此程序是Graylog REST对外提供的API的一个Moonscript的Wrapper封装，把REST接口提供的数据服务，变成通过函数调用的方式取得相应REST接口返回的数据。 下面是一个实际的基...","link":"","photos":[],"count_time":{"symbolsCount":"1.3k","symbolsTime":"1 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[],"toc":"","author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"MoonScript's Object","uid":"f17567ac35ebb144b8a5d3dffefc17d8","slug":"old_topic/2016-09-17-367","date":"2016-09-17T14:50:18.000Z","updated":"2024-03-14T07:45:09.215Z","comments":true,"path":"api/articles/old_topic/2016-09-17-367.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":"作者：糖果 Coffescript是一种中间的脚本，可以把这种脚本翻译成JavaScript。而MoonScript，是可以翻译成lua语言的中间脚本。 本文简单的介绍的： 如何在VIM中，实现MoonScript语法高亮。 如何简单的编译MoonScript脚本。 MoonSc...","link":"","photos":[],"count_time":{"symbolsCount":"2.9k","symbolsTime":"3 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"MoonScript官方文档","uid":"99aa8520e0bab428f7fc88038d56c646","slug":"old_topic/2016-09-17-369","date":"2016-09-17T14:50:18.000Z","updated":"2024-03-14T07:45:09.191Z","comments":true,"path":"api/articles/old_topic/2016-09-17-369.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":"我本人写的中文版的MoonScript文档，直接看官方文档其实，还是会不得要领。后面的英文部分，就是官方的，前面是中文自己写的。 国内用MoonScript的用户相对比较少，作者leafo创作了moonscript，另外还用moonscript创作的一个lua web框架：lap...","link":"","photos":[],"count_time":{"symbolsCount":"8.1k","symbolsTime":"7 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}}}