{"title":"Tup与Moonscript自动编译","uid":"72fc9906b7ade28d0ec3b847f7af3a98","slug":"old_topic/2016-09-17-183","date":"2016-09-17T14:50:18.000Z","updated":"2024-03-14T07:45:09.223Z","comments":true,"path":"api/articles/old_topic/2016-09-17-183.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","content":"<p>tup可以监控文件变动的，再执行相应有执行动作。可以设定tupfile规则，当监控目录中的文件发生变化的时候，实时执行编译脚本，只要文件有改动，然后openresty服务会reload文件，刷新一下url就可以看到新的变动结果（LUA）。</p>\n<p>安装TUP首先要在Linux上安装FUSE。</p>\n<p>第一步：安装FUSE。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">yum install fuse<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>只安装fuse是不够的，还需要安装fuse-devel，在之后的编译需要.h和库文件。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">yum list fuse*\n\nyum install fuse-devel<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<p>如果是在ubuntu下：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">sudo apt-get install libfuse-dev<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>第二步：下载tup。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">git clone https:&#x2F;&#x2F;github.com&#x2F;gittup&#x2F;tup.git\n\n.&#x2F;build.sh linux\n\nsudo .&#x2F;bootstrap.sh<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>第三步：运行tup。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">\nln tup &#x2F;usr&#x2F;bin\n\ntup init\n\nsudo tup\n\nsudo tup monitor -a<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>特别说明：</p>\n<p>A.创建软链接。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">ln -s tup &#x2F;usr&#x2F;bin<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>-s创建软连接，可跨文件系统。</p>\n<p>B.监控变化。</p>\n<p>第二次输入就是重起就是monitor</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">sudo tup monitor -a<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>C.监控规则<br />\ntup在文件发生变动的时候，根据什么规则去什么动作。</p>\n<p>在创建lapis工程的时候，我们不是简单的输入：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">lapis new<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>而是要输入：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">lapis new --git --tup<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>这样会在当前目录，生成规则文件Tuprules.tup</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">: foreach *.moon |&gt; moonc %f |&gt; %B.lua  <span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>所有.moon文件，用moonc编译成同名的lua程序。</p>\n<p>Tup的效果就是，只要编辑工程目录中的.moon文件，就会自动触发moonc把.moon编译成.lua文件。</p>\n<p>作者：糖果</p>\n<p>PS:转载到其它平台请注明作者姓名及原文链接，请勿用于商业用途。</p>\n<p><a href=\"http://www.lua.ren\">http://www.lua.ren</a></p>\n","text":"tup可以监控文件变动的，再执行相应有执行动作。可以设定tupfile规则，当监控目录中的文件发生变化的时候，实时执行编译脚本，只要文件有改动，然后openresty服务会reload文件，刷新一下url就可以看到新的变动结果（LUA）。 安装TUP首先要在Linux上安装FUS...","link":"","photos":[],"count_time":{"symbolsCount":926,"symbolsTime":"1 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[],"toc":"","author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"Lrexlib安装(Lua PCRE)","uid":"1b3a4d7f131dd65bcee1a16042fe9553","slug":"old_topic/2016-09-17-182","date":"2016-09-17T14:50:18.000Z","updated":"2024-03-14T07:45:09.216Z","comments":true,"path":"api/articles/old_topic/2016-09-17-182.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":"作者：糖果 Lrexlib是PCRE的Lua调用库。在此说一下 Lrexlib的安装过程。 Ubuntu下安装： 1.首先是安装依赖。 apt-get install libpcre3 apt-get install libpcre3-dev 2.建立连接。 Ubuntu安装的是...","link":"","photos":[],"count_time":{"symbolsCount":872,"symbolsTime":"1 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"Moonscript的常用WEB特性","uid":"cc7492c9c593b6abb05073ddf9060cb2","slug":"old_topic/2016-09-17-184","date":"2016-09-17T14:50:18.000Z","updated":"2024-03-14T07:45:09.159Z","comments":true,"path":"api/articles/old_topic/2016-09-17-184.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":"下面是一个简单的moonscript脚本，值得注意的地方有几点。 1.Moonscript如何表示List列比数据结构。 2.Moonscript的路由样式。 3.Moonscript如何取得请求URL中的参数变量值。 4.Moonscript如何遍历List数据结构。（pair...","link":"","photos":[],"count_time":{"symbolsCount":"2.3k","symbolsTime":"2 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}}}