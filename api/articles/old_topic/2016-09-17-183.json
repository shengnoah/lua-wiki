{"title":"Tup与Moonscript自动编译","uid":"72fc9906b7ade28d0ec3b847f7af3a98","slug":"old_topic/2016-09-17-183","date":"2016-09-17T14:50:18.000Z","updated":"2024-03-14T07:45:09.223Z","comments":true,"path":"api/articles/old_topic/2016-09-17-183.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":null,"content":"<p>tup可以监控文件变动的，再执行相应有执行动作。可以设定tupfile规则，当监控目录中的文件发生变化的时候，实时执行编译脚本，只要文件有改动，然后openresty服务会reload文件，刷新一下url就可以看到新的变动结果（LUA）。</p>\n<p>安装TUP首先要在Linux上安装FUSE。</p>\n<p>第一步：安装FUSE。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install fuse</span><br></pre></td></tr></table></figure>\n<p>只安装fuse是不够的，还需要安装fuse-devel，在之后的编译需要.h和库文件。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum list fuse*</span><br><span class=\"line\"></span><br><span class=\"line\">yum install fuse-devel</span><br></pre></td></tr></table></figure>\n<p>如果是在ubuntu下：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install libfuse-dev</span><br></pre></td></tr></table></figure>\n<p>第二步：下载tup。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git clone https://github.com/gittup/tup.git</span><br><span class=\"line\"></span><br><span class=\"line\">./build.sh linux</span><br><span class=\"line\"></span><br><span class=\"line\">sudo ./bootstrap.sh</span><br></pre></td></tr></table></figure>\n<p>第三步：运行tup。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">ln tup /usr/bin</span><br><span class=\"line\"></span><br><span class=\"line\">tup init</span><br><span class=\"line\"></span><br><span class=\"line\">sudo tup</span><br><span class=\"line\"></span><br><span class=\"line\">sudo tup monitor -a</span><br></pre></td></tr></table></figure>\n<p>特别说明：</p>\n<p>A.创建软链接。</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ln -s tup /usr/bin</span><br></pre></td></tr></table></figure>\n<p>-s创建软连接，可跨文件系统。</p>\n<p>B.监控变化。</p>\n<p>第二次输入就是重起就是monitor</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo tup monitor -a</span><br></pre></td></tr></table></figure>\n<p>C.监控规则<br>\ntup在文件发生变动的时候，根据什么规则去什么动作。</p>\n<p>在创建lapis工程的时候，我们不是简单的输入：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">lapis new</span><br></pre></td></tr></table></figure>\n<p>而是要输入：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">lapis new --git --tup</span><br></pre></td></tr></table></figure>\n<p>这样会在当前目录，生成规则文件Tuprules.tup</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">: foreach *.moon |&gt; moonc %f |&gt; %B.lua  </span><br></pre></td></tr></table></figure>\n<p>所有.moon文件，用moonc编译成同名的lua程序。</p>\n<p>Tup的效果就是，只要编辑工程目录中的.moon文件，就会自动触发moonc把.moon编译成.lua文件。</p>\n<p>作者：糖果</p>\n<p>PS:转载到其它平台请注明作者姓名及原文链接，请勿用于商业用途。</p>\n<p><a href=\"http://www.lua.ren\">http://www.lua.ren</a></p>\n","text":"tup可以监控文件变动的，再执行相应有执行动作。可以设定tupfile规则，当监控目录中的文件发生变化的时候，实时执行编译脚本，只要文件有改动，然后openresty服务会reload文件，刷新一下url就可以看到新的变动结果（LUA）。 安装TUP首先要在Linux上安装FUS...","link":"","photos":[],"count_time":{"symbolsCount":886,"symbolsTime":"1 mins."},"categories":[{"name":"topic","slug":"topic","count":308,"path":"api/categories/topic.json"}],"tags":[],"toc":"","author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"LUA模拟面向对象：类与对象","uid":"85a31f98ce1faec97b54316baed59b3d","slug":"old_topic/2016-09-17-180","date":"2016-09-17T14:50:18.000Z","updated":"2024-03-14T07:45:09.151Z","comments":true,"path":"api/articles/old_topic/2016-09-17-180.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":null,"text":"首先还是向大家介绍一下国产LUA框架Vanilla。这次我们来看看Vanilla中如何用Lua 模拟面向对象编程。实现主要是使用lua的setemetatable特性来实现的。下面程序大体的处理流程是： 类和对象创建流程： 1.创建一个Controller在类模板程序。 2.在C...","link":"","photos":[],"count_time":{"symbolsCount":"1.1k","symbolsTime":"1 mins."},"categories":[{"name":"topic","slug":"topic","count":308,"path":"api/categories/topic.json"}],"tags":[],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"Lrexlib安装(Lua PCRE)","uid":"1b3a4d7f131dd65bcee1a16042fe9553","slug":"old_topic/2016-09-17-182","date":"2016-09-17T14:50:18.000Z","updated":"2024-03-14T07:45:09.216Z","comments":true,"path":"api/articles/old_topic/2016-09-17-182.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":null,"text":"作者：糖果 Lrexlib是PCRE的Lua调用库。在此说一下 Lrexlib的安装过程。 Ubuntu下安装： 1.首先是安装依赖。 12apt-get install libpcre3apt-get install libpcre3-dev 2.建立连接。 Ubuntu安装的...","link":"","photos":[],"count_time":{"symbolsCount":789,"symbolsTime":"1 mins."},"categories":[{"name":"topic","slug":"topic","count":308,"path":"api/categories/topic.json"}],"tags":[],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}}}