{"title":"graylog的sidercar与nxlog部署","uid":"88310665d32cdba1d5ff1f6f71acda67","slug":"old_topic/2016-09-17-390","date":"2016-09-17T14:50:18.000Z","updated":"2024-03-14T07:45:09.207Z","comments":true,"path":"api/articles/old_topic/2016-09-17-390.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","content":"<p>graylog的sidercar与nxlog部署</p>\n<p>1.去github上下载sidercar.</p>\n<p>2.配置sidercar的配置文件。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">server_url: http:&#x2F;&#x2F;192.168.0.3:9100&#x2F;api \nupdate_interval: 10\ntls_skip_verify: false\nsend_status: true\nlist_log_files:\nnode_id: graylog-collector-sidecar\ncollector_id: file:C:\\Program Files\\graylog\\collector-sidecar\\collector-id\ncache_path: C:\\Program Files\\graylog\\collector-sidecar\\cache\nlog_path: C:\\Program Files\\graylog\\collector-sidecar\\logs\nlog_rotation_time: 86400\nlog_max_age: 604800\ntags: [windows, iis]\nbackends:\n    - name: nxlog\n      enabled: false\n      binary_path: C:\\Program Files (x86)\\nxlog\\nxlog.exe\n      configuration_path: C:\\Program Files\\graylog\\collector-sidecar\\generated\\nxlog.conf<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>3.安装后，设置服务并启动。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">$ &quot;C:\\Program Files\\graylog\\collector-sidecar\\graylog-collector-sidecar.exe&quot; -service install\n$ &quot;C:\\Program Files\\graylog\\collector-sidecar\\graylog-collector-sidecar.exe&quot; -service start<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p>4.安装nxlog。</p>\n<p>5.配置nxlog.conf文件。</p>\n<p>nxlog的配置文件存在一种配对关系，定义Input节、Output节、Route节<br />\n，下面的配置文件只定义了一个Input,Output的路由对应关系，nxlog是模块化的设计，我们在in这个Input节中，用了im_file这个模块，告诉nxlog去那里读取本地日志文件，我们这定义日志文件放到c:\\rlog\\下的所有.log文件。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&lt;Extension _syslog&gt;\n    Module      xm_syslog\n&lt;&#x2F;Extension&gt;\n\n&lt;Input in&gt;\n    Module    im_file \n    file    &#39;C:\\\\rlog\\\\*.log&#39;\n    SavePos    TRUE\n&lt;&#x2F;Input&gt;\n\n&lt;Output out&gt;\n    Module      om_udp\n    Host        192.168.1.3\n    Port        521\n    Exec parse_syslog(); \n&lt;&#x2F;Output&gt;\n\n\n&lt;Route 1&gt;\n    Path        in &#x3D;&gt; out\n&lt;&#x2F;Route&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>名out的Output节定义的是输出才用什么协议，并解析成什么形式，使用om_udp模块，将本的日志文件以udp传输协议，输出成syslog形式，到指定的服务器,syslog服务器或是graylog的数据接收端口。</p>\n<p>安装服务</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">nxlog -i<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>停止一下nxlog，如果启动了。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">nxlog -s<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>在后端启动nxlog监听服务</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">nxlog -f<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>看一下默认的位置nxlog的启动log。</p>\n<p>文件位置：C:\\Program Files (x86)\\nxlog\\data</p>\n<p>正常启动nxlog会显示下面的字样：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">2017-08-16 17:02:15 INFO nxlog-ce-2.9.1716 started<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>如果出现这样的字段就OK了，如有其它警告和提示，可能是配置文件写错了。</p>\n","text":"graylog的sidercar与nxlog部署 1.去github上下载sidercar. 2.配置sidercar的配置文件。 server_url: http:&#x2F;&#x2F;192.168.0.3:9100&#x2F;api update_interval: 10...","link":"","photos":[],"count_time":{"symbolsCount":"1.9k","symbolsTime":"2 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua","slug":"lua","count":124,"path":"api/tags/lua.json"}],"toc":"","author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"使用windump监控流量","uid":"2eb9778cfe15235d511c05b2278c1e5d","slug":"old_topic/2016-09-17-389","date":"2016-09-17T14:50:18.000Z","updated":"2024-03-14T07:45:09.189Z","comments":true,"path":"api/articles/old_topic/2016-09-17-389.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":"windump相关于linux和mac上的tcpdump，有些场景在windows平台上使用windump要比wireshark方便一些,wireshark是GUI形式的，还支持lua插件，有机会我们介绍wireshark的lua插件，windump是一个分析tcp/udp/ic...","link":"","photos":[],"count_time":{"symbolsCount":810,"symbolsTime":"1 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[{"name":"lua","slug":"lua","count":124,"path":"api/tags/lua.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"快速安装MySQL与为Lapis修改mysql字符集","uid":"bf9123379f1a4de9653db6fc2b33716c","slug":"old_topic/2016-09-17-39-mysql-install","date":"2016-09-17T14:50:18.000Z","updated":"2024-03-14T07:45:09.202Z","comments":true,"path":"api/articles/old_topic/2016-09-17-39-mysql-install.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":" 快速安装MySQL 下载安装Yum源 wget -i -c http:&#x2F;&#x2F;dev.mysql.com&#x2F;get&#x2F;mysql57-community-release-el7-10.noarch.rpm 安装的MySQL与服务器端 yum -y...","link":"","photos":[],"count_time":{"symbolsCount":"1.1k","symbolsTime":"1 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"},{"name":"mysql","slug":"topic/mysql","count":1,"path":"api/categories/topic/mysql.json"}],"tags":[{"name":"lapis","slug":"lapis","count":3,"path":"api/tags/lapis.json"},{"name":"mysql","slug":"mysql","count":1,"path":"api/tags/mysql.json"}],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}}}