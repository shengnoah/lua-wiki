{"title":"反扫描可视化","uid":"9a08798d6ed47e5066c21c10dcfbe72f","slug":"old_topic/2016-09-17-372","date":"2016-09-17T14:50:18.000Z","updated":"2024-03-14T07:45:09.232Z","comments":true,"path":"api/articles/old_topic/2016-09-17-372.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":[],"content":"<p>威胁情报可视化，一直以来对安全人员分析安全事件起着有益的作用， 可视化是对分析的结果一种图形化的映射，是威胁行为的一种图形具象化。</p>\n<p>针对蜜罐日志分析的流程来讲，溯源和展示攻击行为本身也是很重要的。</p>\n<p>一般比较传统的日志分析方式是：</p>\n<ol>\n<li class=\"lvl-3\">\n<p>蜜罐向类似mysql这种库中写入被访问的IP地址和Port，启动定时任务读取数据库，取出数据库当条目总数，与之前本地保存的最大数进行比较 发现，数据库中的日志记录变多了，就将这些数据取出，进行分析和报警。</p>\n</li>\n<li class=\"lvl-3\">\n<p>另一种方式是依赖ips,ids这种设备，对网段内的所有蜜罐的流量进行监控，发现有任何触发蜜罐的访问就进行数据的报警分析，不好的地方是，除了要依赖这些设备 ，ids和ids<br>\n本身对蜜罐被访问策略控制比较单一,另外如果想进一步的想取得访问的payload也需要与ids<br>\n，ips再次交互取，不同产商的设备特点不统一。</p>\n</li>\n<li class=\"lvl-3\">\n<p>还有一种方案是，除了构建蜜网之外，再构建一个日志中心（ES集群+Openresty）一方面可以通过在设备上加agent把数据传回日志中心,另一方面日志中心本身也是一个REST<br>\n网关，接受多种 形志的日志推送，这个方案是有构建成本的，但是一旦构建好，策略处理就比较灵活，push和poll模式下都可以，接受push数据过来，进行实性分析和显示更直观。</p>\n</li>\n</ol>\n<p><img src=\"https://www.openresty.com.cn/images/moonscript/unti-scan-sort.png\" alt=\"unti-scan-sort\"></p>\n<h3 id=\"center-图a-1-center\"><center>图a-1</center></h3>\n<p>一个典型的用例，poll模式下对日志中心的REST服务的使用，可以像最传统方式一样，起动定时任务，按时间段范围，对当前指定时间内，所有（用户ID，或DeviceID，或IP）访问日志数量大的访问（IP）进行降排（数据源可以来自蜜罐，或是其它设备），并对被访问IP的<br>\nPORT进行联合枚举分析，如果某个IP访问量大，访问PORT范围大，或是访问 非常规Port，可以进入新的报警与分析阶段。 关于非常规的Port数据，可以对网内常规的PORT进行数据汇聚，常规以外的就是不常规的，汇聚可在对机器进行扫描时，把网内IP的常开PORT进行序列化，生成数据指纹，与之后 的蜜网数据进行联合分析。</p>\n<p>上图a-1，既是对一次用户抄描形为的图形展现。</p>\n<p>供参考。</p>\n","text":"威胁情报可视化，一直以来对安全人员分析安全事件起着有益的作用， 可视化是对分析的结果一种图形化的映射，是威胁行为的一种图形具象化。 针对蜜罐日志分析的流程来讲，溯源和展示攻击行为本身也是很重要的。 一般比较传统的日志分析方式是： 蜜罐向类似mysql这种库中写入被访问的IP地址和...","link":"","photos":[],"count_time":{"symbolsCount":887,"symbolsTime":"1 mins."},"categories":[{"name":"topic","slug":"topic","count":308,"path":"api/categories/topic.json"}],"tags":[],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#center-%E5%9B%BEa-1-center\"><span class=\"toc-text\">图a-1</span></a></li></ol>","author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"MoonScript for GrayLog","uid":"bace4a0f855ab931a94c6323590dcc00","slug":"old_topic/2016-09-17-368","date":"2016-09-17T14:50:18.000Z","updated":"2024-03-14T07:45:09.203Z","comments":true,"path":"api/articles/old_topic/2016-09-17-368.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":null,"text":"GrayLog REST API Wrapper for Moonscript 此程序是Graylog REST对外提供的API的一个Moonscript的Wrapper封装，把REST接口提供的数据服务，变成通过函数调用的方式取得相应REST接口返回的数据。 下面是一个实际的基...","link":"","photos":[],"count_time":{"symbolsCount":"1.7k","symbolsTime":"2 mins."},"categories":[{"name":"topic","slug":"topic","count":308,"path":"api/categories/topic.json"}],"tags":[],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"MoonScript API","uid":"718dd50cb1bd8b8045cdc3956cf5b840","slug":"old_topic/2016-09-17-371","date":"2016-09-17T14:50:18.000Z","updated":"2024-03-14T07:45:09.164Z","comments":true,"path":"api/articles/old_topic/2016-09-17-371.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":null,"text":"{ target: “reference/api” template: “reference” title: “Compiler API” short_name: “api” } MoonScript Compiler API Autocompiling with the moo...","link":"","photos":[],"count_time":{"symbolsCount":"4.2k","symbolsTime":"4 mins."},"categories":[{"name":"topic","slug":"topic","count":308,"path":"api/categories/topic.json"}],"tags":[],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}}}