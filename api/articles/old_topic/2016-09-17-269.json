{"title":"ORC索引页显示的Lapis实现","uid":"d2259f558f383bf9636ac7b5a9eaea5a","slug":"old_topic/2016-09-17-269","date":"2016-09-17T14:50:18.000Z","updated":"2024-03-14T07:45:09.204Z","comments":true,"path":"api/articles/old_topic/2016-09-17-269.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","content":"<p>作者：糖果</p>\n<p>ORC是是用LOR框架完成的，这次尝试实现用Lapis来实现，ORC索引页面的显示， 国为ORC是后端前端分开的， 实际上后端只要根据用输入返回按接口定义的JSON数据就好。</p>\n<p>这个实验会涉及到几个最学用的点：</p>\n<h5 id=\"1简单的用sql对业务表进行left-join这个和语言平台无关\"><a class=\"markdownIt-Anchor\" href=\"#1简单的用sql对业务表进行left-join这个和语言平台无关\"></a> 1.简单的用SQL对业务表进行left join，这个和语言平台无关。</h5>\n<h5 id=\"2or的lua框架返回json-json数据的编解码\"><a class=\"markdownIt-Anchor\" href=\"#2or的lua框架返回json-json数据的编解码\"></a> 2.OR的LUA框架返回JSON, JSON数据的编解码。</h5>\n<h5 id=\"3常规不使用orm访问数据库\"><a class=\"markdownIt-Anchor\" href=\"#3常规不使用orm访问数据库\"></a> 3.常规不使用ORM访问数据库。</h5>\n<h5 id=\"4lapis模板在模板中进行子模板渲染\"><a class=\"markdownIt-Anchor\" href=\"#4lapis模板在模板中进行子模板渲染\"></a> 4.Lapis模板，在模板中进行子模板渲染。</h5>\n<pre class=\"line-numbers language-lua\" data-language=\"lua\"><code class=\"language-lua\"><span class=\"token keyword\">local</span> lapis <span class=\"token operator\">=</span> require <span class=\"token string\">\"lapis\"</span>\n<span class=\"token keyword\">local</span> app <span class=\"token operator\">=</span> lapis<span class=\"token punctuation\">.</span><span class=\"token function\">Application</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">local</span> db <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"lapis.db\"</span><span class=\"token punctuation\">)</span>\napp<span class=\"token punctuation\">:</span><span class=\"token function\">enable</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"etlua\"</span><span class=\"token punctuation\">)</span>\n\n\napp<span class=\"token punctuation\">:</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/topics/all\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">)</span>\n    page_no <span class=\"token operator\">=</span> <span class=\"token number\">1</span>\n    page_size <span class=\"token operator\">=</span> <span class=\"token number\">10</span>\n    category <span class=\"token operator\">=</span> <span class=\"token number\">3</span>  \n    <span class=\"token keyword\">local</span> sql <span class=\"token operator\">=</span> <span class=\"token string\">\"select t.*, c.name as category_name, u.avatar as avatar from topic t \"</span> <span class=\"token operator\">..</span>\n                                <span class=\"token string\">\"left join user u on t.user_id=u.id \"</span> <span class=\"token operator\">..</span>\n                                <span class=\"token string\">\"left join category c on t.category_id=c.id \"</span> <span class=\"token operator\">..</span>\n                                <span class=\"token string\">\"where t.category_id=1 \"</span>\n\n    <span class=\"token keyword\">local</span> res<span class=\"token punctuation\">,</span> err <span class=\"token operator\">=</span> db<span class=\"token punctuation\">.</span><span class=\"token function\">query</span><span class=\"token punctuation\">(</span>sql<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">&#123;</span> json <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span> data <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>totalCount<span class=\"token operator\">=</span><span class=\"token string\">\"54\"</span><span class=\"token punctuation\">,</span> currentPage<span class=\"token operator\">=</span><span class=\"token string\">\"1\"</span><span class=\"token punctuation\">,</span>topics <span class=\"token operator\">=</span> res<span class=\"token punctuation\">,</span> totalPage<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span> success<span class=\"token operator\">=</span><span class=\"token keyword\">true</span> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">&#125;</span>\n<span class=\"token keyword\">end</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">return</span> app<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>值的注意的是，db.query(sql)返回的结果res本身就是JSON形式，不需要进入JSON编解码。  因为LORj框架是不提供ORM的，所以ORC所有返回接口几乎都是纯SQL。 因为Lapis的底层用的也是resty-mysql<br />\n,他们之间执行SQL是兼容的。</p>\n<p>下面是节选的Lapis的Mysql库的源码：</p>\n<pre class=\"line-numbers language-lua\" data-language=\"lua\"><code class=\"language-lua\">    <span class=\"token keyword\">local</span> mysql <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"resty.mysql\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span>q<span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">if</span> logger <span class=\"token keyword\">then</span>\n        logger<span class=\"token punctuation\">.</span><span class=\"token function\">query</span><span class=\"token punctuation\">(</span>q<span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">end</span>\n      <span class=\"token keyword\">local</span> db <span class=\"token operator\">=</span> ngx <span class=\"token keyword\">and</span> ngx<span class=\"token punctuation\">.</span>ctx<span class=\"token punctuation\">.</span>resty_mysql_db\n      <span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> <span class=\"token punctuation\">(</span>db<span class=\"token punctuation\">)</span> <span class=\"token keyword\">then</span>\n        <span class=\"token keyword\">local</span> err\n        db<span class=\"token punctuation\">,</span> err <span class=\"token operator\">=</span> <span class=\"token function\">assert</span><span class=\"token punctuation\">(</span>mysql<span class=\"token punctuation\">:</span><span class=\"token function\">new</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        db<span class=\"token punctuation\">:</span><span class=\"token function\">set_timeout</span><span class=\"token punctuation\">(</span>timeout<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">local</span> options <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>\n          database <span class=\"token operator\">=</span> database<span class=\"token punctuation\">,</span>\n          user <span class=\"token operator\">=</span> user<span class=\"token punctuation\">,</span>\n          password <span class=\"token operator\">=</span> password<span class=\"token punctuation\">,</span>\n          ssl <span class=\"token operator\">=</span> ssl<span class=\"token punctuation\">,</span>\n          ssl_verify <span class=\"token operator\">=</span> ssl_verify\n        <span class=\"token punctuation\">&#125;</span>\n        <span class=\"token keyword\">if</span> path <span class=\"token keyword\">then</span>\n          options<span class=\"token punctuation\">.</span>path <span class=\"token operator\">=</span> path\n        <span class=\"token keyword\">else</span>\n          options<span class=\"token punctuation\">.</span>host <span class=\"token operator\">=</span> host\n          options<span class=\"token punctuation\">.</span>port <span class=\"token operator\">=</span> port\n        <span class=\"token keyword\">end</span>\n        <span class=\"token function\">assert</span><span class=\"token punctuation\">(</span>db<span class=\"token punctuation\">:</span><span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>options<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span> ngx <span class=\"token keyword\">then</span>\n          ngx<span class=\"token punctuation\">.</span>ctx<span class=\"token punctuation\">.</span>resty_mysql_db <span class=\"token operator\">=</span> db\n          <span class=\"token function\">after_dispatch</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">return</span> db<span class=\"token punctuation\">:</span><span class=\"token function\">set_keepalive</span><span class=\"token punctuation\">(</span>max_idle_timeout<span class=\"token punctuation\">,</span> pool_size<span class=\"token punctuation\">)</span>\n          <span class=\"token keyword\">end</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">end</span>\n      <span class=\"token keyword\">end</span>\n      <span class=\"token keyword\">local</span> start_time\n      <span class=\"token keyword\">if</span> ngx <span class=\"token keyword\">and</span> config<span class=\"token punctuation\">.</span>measure_performance <span class=\"token keyword\">then</span>\n        ngx<span class=\"token punctuation\">.</span><span class=\"token function\">update_time</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        start_time <span class=\"token operator\">=</span> ngx<span class=\"token punctuation\">.</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">end</span>\n      <span class=\"token keyword\">local</span> res<span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">,</span> errcode<span class=\"token punctuation\">,</span> sqlstate <span class=\"token operator\">=</span> <span class=\"token function\">assert</span><span class=\"token punctuation\">(</span>db<span class=\"token punctuation\">:</span><span class=\"token function\">query</span><span class=\"token punctuation\">(</span>q<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">local</span> result\n      <span class=\"token keyword\">if</span> err <span class=\"token operator\">==</span> <span class=\"token string\">'again'</span> <span class=\"token keyword\">then</span>\n        result <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>\n          res\n        <span class=\"token punctuation\">&#125;</span>\n        <span class=\"token keyword\">while</span> err <span class=\"token operator\">==</span> <span class=\"token string\">'again'</span> <span class=\"token keyword\">do</span>\n          res<span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">,</span> errcode<span class=\"token punctuation\">,</span> sqlstate <span class=\"token operator\">=</span> <span class=\"token function\">assert</span><span class=\"token punctuation\">(</span>db<span class=\"token punctuation\">:</span><span class=\"token function\">read_result</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n          table<span class=\"token punctuation\">.</span><span class=\"token function\">insert</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">,</span> res<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">end</span>\n      <span class=\"token keyword\">else</span>\n        result <span class=\"token operator\">=</span> res\n      <span class=\"token keyword\">end</span>\n      <span class=\"token keyword\">if</span> start_time <span class=\"token keyword\">then</span>\n        ngx<span class=\"token punctuation\">.</span><span class=\"token function\">update_time</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token function\">increment_perf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"db_time\"</span><span class=\"token punctuation\">,</span> ngx<span class=\"token punctuation\">.</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> start_time<span class=\"token punctuation\">)</span>\n        <span class=\"token function\">increment_perf</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"db_count\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">end</span>\n      <span class=\"token keyword\">return</span> result\n    <span class=\"token keyword\">end</span>\n  <span class=\"token keyword\">end</span>\n<span class=\"token punctuation\">&#125;</span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>ORC的前端代码，除了其它和这个实验不相关的Layout，主要的代码如下：</p>\n<p>meta.etlua</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&lt;script src&#x3D;&quot;&#x2F;static&#x2F;js&#x2F;juicer.js&quot;&gt;&lt;&#x2F;script&gt;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p><img src=\"http://file.epubit.com.cn/ScreenShow/16087e7dceeca78a5bfe\" alt=\"图像说明文字\" /></p>\n<pre class=\"line-numbers language-javascript\" data-language=\"javascript\"><code class=\"language-javascript\">\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">%</span> <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"views.meta\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">%</span><span class=\"token operator\">></span>\n\n<span class=\"token operator\">&lt;</span>script src<span class=\"token operator\">=</span><span class=\"token string\">\"/static/js/index.js\"</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>script<span class=\"token operator\">></span>\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<p>这里的index.js的代码也不是很多：</p>\n<pre class=\"line-numbers language-javascript\" data-language=\"javascript\"><code class=\"language-javascript\"><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token constant\">L</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n    <span class=\"token keyword\">var</span> _this <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n    <span class=\"token constant\">L</span><span class=\"token punctuation\">.</span>Index <span class=\"token operator\">=</span> <span class=\"token constant\">L</span><span class=\"token punctuation\">.</span>Index <span class=\"token operator\">||</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span>\n    _this <span class=\"token operator\">=</span> <span class=\"token constant\">L</span><span class=\"token punctuation\">.</span>Index <span class=\"token operator\">=</span> <span class=\"token punctuation\">&#123;</span>\n        <span class=\"token literal-property property\">data</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n            <span class=\"token literal-property property\">current_category</span><span class=\"token operator\">:</span> <span class=\"token string\">\"0\"</span>\n        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n\n        <span class=\"token function-variable function\">init</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">current_category</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n            _this<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>current_category <span class=\"token operator\">=</span> current_category <span class=\"token operator\">||</span> <span class=\"token string\">\"0\"</span><span class=\"token punctuation\">;</span>\n            _this<span class=\"token punctuation\">.</span><span class=\"token function\">loadTopics</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"default\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">//_this.loadTopics(\"ir-black\");</span>\n            _this<span class=\"token punctuation\">.</span><span class=\"token function\">initEvents</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n\n<span class=\"token comment\">/*\n        scrollTop: function () &#123;\n            $('html, body').animate(&#123;scrollTop: 0&#125;, 0);\n        &#125;,\n*/</span>\n\n        <span class=\"token function-variable function\">initEvents</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n            <span class=\"token function\">$</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"click\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"#topic-type-tab a\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n                <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#topic-type-tab a\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">each</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n                    <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">removeClass</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"active\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n                <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">addClass</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"active\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#default-topics-btn\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n                _this<span class=\"token punctuation\">.</span><span class=\"token function\">loadTopics</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"default\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#recent-reply-topics-btn\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n                _this<span class=\"token punctuation\">.</span><span class=\"token function\">loadTopics</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"recent-reply\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#good-topics-btn\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n                _this<span class=\"token punctuation\">.</span><span class=\"token function\">loadTopics</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"good\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            \n            \n            <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#noreply-topics-btn\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n                _this<span class=\"token punctuation\">.</span><span class=\"token function\">loadTopics</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"noreply\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n\n        <span class=\"token function-variable function\">loadTopics</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">type<span class=\"token punctuation\">,</span> pageNo</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n            pageNo <span class=\"token operator\">=</span> pageNo <span class=\"token operator\">||</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n            $<span class=\"token punctuation\">.</span><span class=\"token function\">ajax</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span>\n                <span class=\"token literal-property property\">url</span><span class=\"token operator\">:</span> <span class=\"token string\">'/topics/all'</span><span class=\"token punctuation\">,</span>\n                <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> <span class=\"token string\">'get'</span><span class=\"token punctuation\">,</span>\n                <span class=\"token literal-property property\">cache</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n                <span class=\"token literal-property property\">data</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n                    <span class=\"token literal-property property\">page_no</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> type<span class=\"token punctuation\">,</span>\n                    <span class=\"token literal-property property\">category</span><span class=\"token operator\">:</span> _this<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>current_category\n                <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n                <span class=\"token literal-property property\">dataType</span><span class=\"token operator\">:</span> <span class=\"token string\">'json'</span><span class=\"token punctuation\">,</span>\n                <span class=\"token function-variable function\">success</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">result</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n                    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">.</span>success<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n                        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>result<span class=\"token punctuation\">.</span>data <span class=\"token operator\">||</span> <span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">.</span>data <span class=\"token operator\">&amp;&amp;</span> result<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>topics<span class=\"token punctuation\">.</span>length <span class=\"token operator\">&lt;=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n                            <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#topics-body\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">html</span><span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;div class=\"alert alert-info\" role=\"alert\">此分类下没有任何内容&lt;/div>'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                        <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span>\n                            _this<span class=\"token punctuation\">.</span><span class=\"token function\">page</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">,</span> type<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                        <span class=\"token punctuation\">&#125;</span>\n                    <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span>\n                        <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#topics-body\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">html</span><span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;div class=\"alert alert-danger\" role=\"alert\">'</span> <span class=\"token operator\">+</span> result<span class=\"token punctuation\">.</span>msg <span class=\"token operator\">+</span> <span class=\"token string\">'&lt;/div>'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token punctuation\">&#125;</span>\n                <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n                <span class=\"token function-variable function\">error</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n                    <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#topics-body\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">html</span><span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;div class=\"alert alert-danger\" role=\"alert\">error to send request.&lt;/div>'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">&#125;</span>\n            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n        <span class=\"token function-variable function\">page</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">result<span class=\"token punctuation\">,</span> type<span class=\"token punctuation\">,</span> pageNo</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n            <span class=\"token keyword\">var</span> data <span class=\"token operator\">=</span> result<span class=\"token punctuation\">.</span>data <span class=\"token operator\">||</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">var</span> $container <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#topics-body\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            $container<span class=\"token punctuation\">.</span><span class=\"token function\">empty</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token keyword\">var</span> tpl <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#topic-item-tpl\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">html</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">var</span> html <span class=\"token operator\">=</span> <span class=\"token function\">juicer</span><span class=\"token punctuation\">(</span>tpl<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            $container<span class=\"token punctuation\">.</span><span class=\"token function\">html</span><span class=\"token punctuation\">(</span>html<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token keyword\">var</span> currentPage <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>currentPage<span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">var</span> totalPage <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>totalPage<span class=\"token punctuation\">;</span>\n            <span class=\"token keyword\">var</span> totalCount <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>totalCount<span class=\"token punctuation\">;</span>\n\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>totalPage <span class=\"token operator\">></span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n                <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#pagebar\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">show</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                $<span class=\"token punctuation\">.</span>fn<span class=\"token punctuation\">.</span><span class=\"token function\">jpagebar</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span>\n                    <span class=\"token literal-property property\">renderTo</span><span class=\"token operator\">:</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#pagebar\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token literal-property property\">totalpage</span><span class=\"token operator\">:</span> totalPage<span class=\"token punctuation\">,</span>\n                    <span class=\"token literal-property property\">totalcount</span><span class=\"token operator\">:</span> totalCount<span class=\"token punctuation\">,</span>\n                    <span class=\"token literal-property property\">pagebarCssName</span><span class=\"token operator\">:</span> <span class=\"token string\">'pagination2'</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token literal-property property\">currentPage</span><span class=\"token operator\">:</span> currentPage<span class=\"token punctuation\">,</span>\n                    <span class=\"token function-variable function\">onClickPage</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">pageNo</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n                        $<span class=\"token punctuation\">.</span>fn<span class=\"token punctuation\">.</span><span class=\"token function\">setCurrentPage</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">,</span> pageNo<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                        $<span class=\"token punctuation\">.</span><span class=\"token function\">ajax</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">&#123;</span>\n                            <span class=\"token literal-property property\">url</span><span class=\"token operator\">:</span> <span class=\"token string\">'/topics/all'</span><span class=\"token punctuation\">,</span>\n                            <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> <span class=\"token string\">'get'</span><span class=\"token punctuation\">,</span>\n                            <span class=\"token literal-property property\">cache</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n                            <span class=\"token literal-property property\">data</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">&#123;</span>\n                                <span class=\"token literal-property property\">page_no</span><span class=\"token operator\">:</span> pageNo<span class=\"token punctuation\">,</span>\n                                <span class=\"token literal-property property\">type</span><span class=\"token operator\">:</span> type<span class=\"token punctuation\">,</span>\n                                <span class=\"token literal-property property\">category</span><span class=\"token operator\">:</span> _this<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>current_category\n                            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n\n                            <span class=\"token literal-property property\">dataType</span><span class=\"token operator\">:</span> <span class=\"token string\">'json'</span><span class=\"token punctuation\">,</span>\n                            <span class=\"token function-variable function\">success</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">result</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n                                <span class=\"token keyword\">var</span> data <span class=\"token operator\">=</span> result<span class=\"token punctuation\">.</span>data <span class=\"token operator\">||</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span>\n                                <span class=\"token keyword\">var</span> $container <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#topics-body\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                                $container<span class=\"token punctuation\">.</span><span class=\"token function\">empty</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n                                <span class=\"token keyword\">var</span> tpl <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#topic-item-tpl\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">html</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                                <span class=\"token keyword\">var</span> html <span class=\"token operator\">=</span> <span class=\"token function\">juicer</span><span class=\"token punctuation\">(</span>tpl<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                                $container<span class=\"token punctuation\">.</span><span class=\"token function\">html</span><span class=\"token punctuation\">(</span>html<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                               <span class=\"token comment\">// _this.scrollTop();</span>\n                            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">,</span>\n                            <span class=\"token function-variable function\">error</span><span class=\"token operator\">:</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span>\n                                <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#topics-body\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">html</span><span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;div class=\"alert alert-danger\" role=\"alert\">error to find topics page.&lt;/div>'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                            <span class=\"token punctuation\">&#125;</span>\n                        <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                    <span class=\"token punctuation\">&#125;</span>\n                <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">&#125;</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span>\n                <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#pagebar\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">hide</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token punctuation\">&#125;</span>\n        <span class=\"token punctuation\">&#125;</span>\n    <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">(</span><span class=\"token constant\">APP</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>ORC并没有使用传统的框架分页器对象，结合框架模板语言来实现分页，LOR框架也暂时不提供这些功能。用的是Juicer前端模板来实现<br />\n把后端返回的JSON数据的字段，渲染到前端的Layout标签中。</p>\n<pre class=\"line-numbers language-javascript\" data-language=\"javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> tpl <span class=\"token operator\">=</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#topic-item-tpl\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">html</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> html <span class=\"token operator\">=</span> <span class=\"token function\">juicer</span><span class=\"token punctuation\">(</span>tpl<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n$container<span class=\"token punctuation\">.</span><span class=\"token function\">html</span><span class=\"token punctuation\">(</span>html<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<p>juicer把data数据提供给了topic-item-tpl这个标签类，并在前端页面嵌入了 {@each topics as t}语法，取得JSON数据的值， t.title, t.avatar等。</p>\n<p>上面这段代码，把后端返回JSON数据返回在前端渲染，主要靠的是juicer。按目前ORC这种写法， 前后端都是通过JSON数据建立联系，ORM,Etlua标记，分页器这种中间模块都没用到。下面的实验就是把这些功能，应用到ORC上。</p>\n<p>PS:<br />\nORC=Openrest China</p>\n<p>下一篇实验是对ORC的内容页进行Lapis的代码实现移植。</p>\n","text":"作者：糖果 ORC是是用LOR框架完成的，这次尝试实现用Lapis来实现，ORC索引页面的显示， 国为ORC是后端前端分开的， 实际上后端只要根据用输入返回按接口定义的JSON数据就好。 这个实验会涉及到几个最学用的点： 1.简单的用SQL对业务表进行left join，这个和语...","link":"","photos":[],"count_time":{"symbolsCount":"8.4k","symbolsTime":"8 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#1%E7%AE%80%E5%8D%95%E7%9A%84%E7%94%A8sql%E5%AF%B9%E4%B8%9A%E5%8A%A1%E8%A1%A8%E8%BF%9B%E8%A1%8Cleft-join%E8%BF%99%E4%B8%AA%E5%92%8C%E8%AF%AD%E8%A8%80%E5%B9%B3%E5%8F%B0%E6%97%A0%E5%85%B3\"><span class=\"toc-text\"> 1.简单的用SQL对业务表进行left join，这个和语言平台无关。</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#2or%E7%9A%84lua%E6%A1%86%E6%9E%B6%E8%BF%94%E5%9B%9Ejson-json%E6%95%B0%E6%8D%AE%E7%9A%84%E7%BC%96%E8%A7%A3%E7%A0%81\"><span class=\"toc-text\"> 2.OR的LUA框架返回JSON, JSON数据的编解码。</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#3%E5%B8%B8%E8%A7%84%E4%B8%8D%E4%BD%BF%E7%94%A8orm%E8%AE%BF%E9%97%AE%E6%95%B0%E6%8D%AE%E5%BA%93\"><span class=\"toc-text\"> 3.常规不使用ORM访问数据库。</span></a></li><li class=\"toc-item toc-level-5\"><a class=\"toc-link\" href=\"#4lapis%E6%A8%A1%E6%9D%BF%E5%9C%A8%E6%A8%A1%E6%9D%BF%E4%B8%AD%E8%BF%9B%E8%A1%8C%E5%AD%90%E6%A8%A1%E6%9D%BF%E6%B8%B2%E6%9F%93\"><span class=\"toc-text\"> 4.Lapis模板，在模板中进行子模板渲染。</span></a></li></ol>","author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"Threading的Timer是否可以被wait和communicate阻塞","uid":"1f0e7f34ab02983eb011a2f068cfda64","slug":"old_topic/2016-09-17-268","date":"2016-09-17T14:50:18.000Z","updated":"2024-03-14T07:45:09.193Z","comments":true,"path":"api/articles/old_topic/2016-09-17-268.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":"作者：糖果 测试的内容是将Timer的使用和Popen的使用混合在一起，测试当wait()和communicate()被调用时，是否会阻塞主进程的Timer。 找到Timer在Python2.7里的源码位置： # The timer class was contributed b...","link":"","photos":[],"count_time":{"symbolsCount":"19k","symbolsTime":"17 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"ElasticSearch的LUA客户端","uid":"fc17f56f18c6188c98c1c7bfedd06596","slug":"old_topic/2016-09-17-270","date":"2016-09-17T14:50:18.000Z","updated":"2024-03-14T07:45:09.161Z","comments":true,"path":"api/articles/old_topic/2016-09-17-270.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":"作者：糖果 从Github上看，有一位叫做Dhaval Kapil老师完成了ElasticSearch for Lua的工作，另一位来自阿根廷的叫做Cristian Haunsen的老师，完成了ElasticSearch for Lapis的客户端程序写作工作,dhavalkap...","link":"","photos":[],"count_time":{"symbolsCount":"2.5k","symbolsTime":"2 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}}}