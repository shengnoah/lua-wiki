{"title":"Lapis读取中文Mysql数据的问题","uid":"1f4f3b0cdc7ac1495b8bbbf5b8327672","slug":"old_topic/2016-09-17-203","date":"2016-09-17T14:50:18.000Z","updated":"2024-03-14T07:45:09.218Z","comments":true,"path":"api/articles/old_topic/2016-09-17-203.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","content":"<p>作者：糖果</p>\n<p>在阿里云的VPS上，准备用lapis克隆一版blog程序，就是现在这个发文章的Blog。</p>\n<p>Mysql移植的过程中发现的了问题，Lapis读取mysql数据库数据出现乱码。</p>\n<p>查看结果集合</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">SHOW VARIABLES LIKE &#39;character%&#39;;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">mysql&gt; SET character_set_client &#x3D; utf8 ;  \nmysql&gt; SET character_set_connection &#x3D; utf8 ;   \nmysql&gt; SET character_set_database &#x3D; utf8 ;   \nmysql&gt; SET character_set_results &#x3D; utf8 ;    \nmysql&gt; SET character_set_server &#x3D; utf8 ;   \n \nmysql&gt; SET collation_connection &#x3D; utf8 ;  \nmysql&gt; SET collation_database &#x3D; utf8 ;   \nmysql&gt; SET collation_server &#x3D; utf8 ; \n\n\nSET NAMES &#39;utf8&#39;;  \n\nSET character_set_client &#x3D; utf8;  \nSET character_set_results &#x3D; utf8;   \nSET character_set_connection &#x3D; utf8; <span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>上面这些在运行修改参数的方式，phpmyadmin修改有限的字符的方式都失灵。</p>\n<h3><strong>注意，下面才是好用的方法：</strong></h3>  \n<pre class=\"line-numbers language-none\"><code class=\"language-none\">mysqld --character-set-server&#x3D;utf8<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">mysql&gt; SHOW VARIABLES LIKE &#39;character%&#39;;\n+--------------------------+----------------------------+\n| Variable_name            | Value                      |\n+--------------------------+----------------------------+\n| character_set_client     | utf8                       |\n| character_set_connection | utf8                       |\n| character_set_database   | utf8                       |\n| character_set_filesystem | binary                     |\n| character_set_results    | utf8                       |\n| character_set_server     | utf8                       |\n| character_set_system     | utf8                       |\n| character_sets_dir       | &#x2F;usr&#x2F;share&#x2F;mysql&#x2F;charsets&#x2F; |\n+--------------------------+----------------------------+\n8 rows in set (0.00 sec)<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">mysqld --character-set-server&#x3D;latin1 \\\n           --collation-server&#x3D;latin1_swedish_ci<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p>另外，collation-server可以在phpmyadmin和mysql-workbench修改，就是GUI有些罗嗦。</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">.&#x2F;configure --with-charset&#x3D;latin1 \\\n           --with-collation&#x3D;latin1_german1_ci<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p>这种编译时指定，个人很少用，没试过。</p>\n<p>Lapis目前最大的问题是Moonscript翻译过来的lua代码，人类不易看懂。</p>\n<p>这个问题是不是，lapis以来resty mysql引起呢，因为resty mysql connect数据库的时候，不能指定字符集，不能很肯定，没看源码。</p>\n<p><a href=\"https://github.com/openresty/lua-resty-mysql/issues/20\">下面这个连接是春哥对这个问的回答，供参考：</a></p>\n","text":"作者：糖果 在阿里云的VPS上，准备用lapis克隆一版blog程序，就是现在这个发文章的Blog。 Mysql移植的过程中发现的了问题，Lapis读取mysql数据库数据出现乱码。 查看结果集合 SHOW VARIABLES LIKE &#39;character%&#39;;...","link":"","photos":[],"count_time":{"symbolsCount":"2k","symbolsTime":"2 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\"><span class=\"toc-text\">注意，下面才是好用的方法：</span></a></li></ol>","author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"误删Unity导致Ubuntu桌面左边栏消失","uid":"9e3528aaa8fffc1f32ba95ca160d9152","slug":"old_topic/2016-09-17-201","date":"2016-09-17T14:50:18.000Z","updated":"2024-03-14T07:45:09.154Z","comments":true,"path":"api/articles/old_topic/2016-09-17-201.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":"昨天安装老的版本的Django,删除Python，误删除了Unity． 结果发现桌面的左边栏和Terminal的标题栏都没了． 恢复安装一下就好了． sudo apt-get install unity sudo apt-get install gnome-terminal 这样...","link":"","photos":[],"count_time":{"symbolsCount":150,"symbolsTime":"1 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"SAE到VPS的移植","uid":"88294b3320ee535773bca2da0894980a","slug":"old_topic/2016-09-17-204","date":"2016-09-17T14:50:18.000Z","updated":"2024-03-14T07:45:09.174Z","comments":true,"path":"api/articles/old_topic/2016-09-17-204.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":"SAE到VPS的移植 主要移植的内容是python的django, tornado程序。 除了代码不能全放到blog上，把环境移植的东西简单的记录一下。 VPS上比较要有的Python部件。 apt-get install pip pip install django==1.5....","link":"","photos":[],"count_time":{"symbolsCount":585,"symbolsTime":"1 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}}}