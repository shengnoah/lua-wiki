{"title":"Lua动态加载脚本( loadstring )","uid":"9eeeb777591d00c19e4d4fed3011ba33","slug":"old_topic/2016-09-17-158","date":"2016-09-17T14:50:18.000Z","updated":"2024-03-14T06:15:59.737Z","comments":true,"path":"api/articles/old_topic/2016-09-17-158.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":null,"content":"<p>作者：糖果</p>\n<p>下面是代码：</p>\n<figure class=\"highlight lua\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">local</span> lua_script = <span class=\"string\">[[</span></span><br><span class=\"line\"><span class=\"string\">     local var = 1</span></span><br><span class=\"line\"><span class=\"string\">     print(var)</span></span><br><span class=\"line\"><span class=\"string\">]]</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">local</span>  script = lua_script </span><br><span class=\"line\"><span class=\"keyword\">local</span> tb=<span class=\"built_in\">assert</span>(<span class=\"built_in\">loadstring</span>(script))()</span><br><span class=\"line\"><span class=\"built_in\">print</span>(tb[<span class=\"number\">0</span>].text)</span><br></pre></td></tr></table></figure>\n\n\n\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">const</span> <span class=\"type\">char</span>* testfunc = <span class=\"string\">&quot;print (add(1.0, 2.0)) print(sub(20.1, 19))&quot;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"type\">int</span> <span class=\"title function_\">main</span><span class=\"params\">()</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">        lua_State* L = luaL_newstate();</span><br><span class=\"line\">        luaL_openlibs(L);</span><br><span class=\"line\">        lua_register(L, <span class=\"string\">&quot;add&quot;</span>, add);</span><br><span class=\"line\">        lua_register(L, <span class=\"string\">&quot;sub&quot;</span>, sub);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (luaL_dostring(L, testfunc))</span><br><span class=\"line\">                <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;Failed to invoke.\\n&quot;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        lua_close(L);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>糖果实验室<br><a href=\"http://www.lua.ren/topic/158\">www.lua.ren/topic/158</a></p>\n","text":"作者：糖果 下面是代码： 123456789local lua_script = [[ local var = 1 print(var)]]local script = lua_script local tb=assert(loadstring(script))()print(t...","link":"","photos":[],"count_time":{"symbolsCount":602,"symbolsTime":"1 mins."},"categories":[{"name":"topic","slug":"topic","count":308,"path":"api/categories/topic.json"}],"tags":[],"toc":"","author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"Lua快速入门书","uid":"f3e99e9ea7d7d80df722bfdd4f318e9e","slug":"old_topic/2016-09-17-163","date":"2016-09-17T14:50:18.000Z","updated":"2024-03-14T06:15:59.737Z","comments":true,"path":"api/articles/old_topic/2016-09-17-163.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":null,"text":"这是一本lua的入门书籍。 ","link":"","photos":[],"count_time":{"symbolsCount":14,"symbolsTime":"1 mins."},"categories":[{"name":"topic","slug":"topic","count":308,"path":"api/categories/topic.json"}],"tags":[],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"Openresty 火焰图","uid":"6fb84e2c72aba63aea886444da3d9874","slug":"old_topic/2016-09-17-167","date":"2016-09-17T14:50:18.000Z","updated":"2024-03-14T06:15:59.737Z","comments":true,"path":"api/articles/old_topic/2016-09-17-167.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":null,"text":"这是群里的小伙伴分享，感谢这位小伙伴，mc!信春哥，看文档。 Openresty最佳实践—讲火焰图 1https://github.com/moonbingbing/nginx-systemtap-toolkit/blob/master/README-CN.markdown#sa...","link":"","photos":[],"count_time":{"symbolsCount":272,"symbolsTime":"1 mins."},"categories":[{"name":"topic","slug":"topic","count":308,"path":"api/categories/topic.json"}],"tags":[],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}}}