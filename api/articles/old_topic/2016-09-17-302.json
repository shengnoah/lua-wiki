{"title":"rule.md","uid":"d1e289c6fe68119c3bd6635eff90f158","slug":"old_topic/2016-09-17-302","date":"2016-09-17T14:50:18.000Z","updated":"2024-03-14T06:15:59.747Z","comments":true,"path":"api/articles/old_topic/2016-09-17-302.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":null,"content":"<hr>\n<p>category: Concept<br>redirect_from:<br>    - /docs/v0.4.0/concept/rule/<br>    - /docs/latest/concept/rule/<br>title: “规则”<br>sort_title: “1”</p>\n<hr>\n<p>** 规则 ** 是Orange中的一个概念，它可能包括一个<a href=\"/docs/concept/judge\">条件判断模块</a>、一个<a href=\"/docs/concept/extractor\">变量提取模块</a>和一个<a href=\"/docs/concept/handle\">后续处理模块</a>。一般情况下，插件的一条规则会包含条件判断模块和一个处理模块，根据需要选择是否使用变量提取模块，如分流插件就需要变量提取模块，但防火墙插件则不需要。</p>\n<p>下面通过一个具体的实例看一下它的组成。</p>\n<h3 id=\"格式\"><a href=\"#格式\" class=\"headerlink\" title=\"格式\"></a>格式</h3><p>以<code>重定向插件</code>的一条规则的结构为例，介绍如下(以json格式描述):</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    &quot;enable&quot;: true,</span><br><span class=\"line\">    &quot;name&quot;: &quot;用户访问重定向&quot;,</span><br><span class=\"line\">    &quot;id&quot;: &quot;F7F73D94-AEEB-4B61-9E59-AEDBF200B941&quot;,</span><br><span class=\"line\">    &quot;time&quot;: &quot;2016-05-04 16:05:03&quot;,</span><br><span class=\"line\">    &quot;judge&quot;: &#123;</span><br><span class=\"line\">        &quot;type&quot;: 1,</span><br><span class=\"line\">        &quot;conditions&quot;: [</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                &quot;type&quot;: &quot;URI&quot;,</span><br><span class=\"line\">                &quot;operator&quot;: &quot;match&quot;,</span><br><span class=\"line\">                &quot;value&quot;: &quot;^/user&quot;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        ]</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &quot;extractor&quot;: &#123;</span><br><span class=\"line\">        &quot;type&quot;: 1,</span><br><span class=\"line\">        &quot;extractions&quot;: [</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                &quot;type&quot;: &quot;Query&quot;,</span><br><span class=\"line\">                &quot;name&quot;: &quot;username&quot;</span><br><span class=\"line\">            &#125;,</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                &quot;type&quot;: &quot;Header&quot;,</span><br><span class=\"line\">                &quot;name&quot;: &quot;id&quot;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        ]</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    &quot;handle&quot;: &#123;</span><br><span class=\"line\">        &quot;trim_qs&quot;: false,</span><br><span class=\"line\">        &quot;url_tmpl&quot;: &quot;/u/$&#123;2&#125;/$&#123;1&#125;&quot;,</span><br><span class=\"line\">        &quot;log&quot;: true</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"字段描述\"><a href=\"#字段描述\" class=\"headerlink\" title=\"字段描述\"></a>字段描述</h3><p>各个字段的解释如下：</p>\n<h4 id=\"enable\"><a href=\"#enable\" class=\"headerlink\" title=\"enable\"></a>enable</h4><p>是否开启这条规则  </p>\n<h4 id=\"name\"><a href=\"#name\" class=\"headerlink\" title=\"name\"></a>name</h4><p>规则名称</p>\n<h4 id=\"id\"><a href=\"#id\" class=\"headerlink\" title=\"id\"></a>id</h4><p>这条规则的id，用于修改和删除  </p>\n<h4 id=\"time\"><a href=\"#time\" class=\"headerlink\" title=\"time\"></a>time</h4><p>添加或者更改时间</p>\n<h4 id=\"judge\"><a href=\"#judge\" class=\"headerlink\" title=\"judge\"></a>judge</h4><p>规则适配器，用于筛选请求，详见<a href=\"/docs/concept/judge/\">规则适配器</a></p>\n<h4 id=\"extractor\"><a href=\"#extractor\" class=\"headerlink\" title=\"extractor\"></a>extractor</h4><p>变量提取模块，用于提取出请求中的变量供后续使用，详见<a href=\"/docs/concept/extractor\">变量提取模块</a></p>\n<h4 id=\"handle\"><a href=\"#handle\" class=\"headerlink\" title=\"handle\"></a>handle</h4><p>这条规则对应的后续处理，如果这条规则有一个下游触发动作，此值不为空。不同的插件这个字段的子字段可能不同。</p>\n<p>重定向插件的该字段子字段描述如下：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">log: 当执行这个动作时，是否要记录日志</span><br><span class=\"line\">url_tmpl: 后续要redirect到的url模板，可在里面使用`变量提取模块`提取出来的值</span><br><span class=\"line\">trim_qs: 是否要清除原始请求的QueryString</span><br></pre></td></tr></table></figure>\n\n\n<h4 id=\"judge-conditions\"><a href=\"#judge-conditions\" class=\"headerlink\" title=\"judge.conditions\"></a>judge.conditions</h4><p>条件集合，每个条件即为对某项值的判断，这个值是从HTTP请求中提取出来的。详见<a href=\"/docs/concept/condition\">匹配条件</a></p>\n<h4 id=\"extractor-extractions\"><a href=\"#extractor-extractions\" class=\"headerlink\" title=\"extractor.extractions\"></a>extractor.extractions</h4><p>从哪些项中提取变量。详见<a href=\"/docs/concept/extraction\">变量提取器</a></p>\n","text":" category: Conceptredirect_from: - /docs/v0.4.0/concept/rule/ - /docs/latest/concept/rule/title: “规则”sort_title: “1” ** 规则 ** 是Orange中的一个概念，...","link":"","photos":[],"count_time":{"symbolsCount":"1.9k","symbolsTime":"2 mins."},"categories":[{"name":"topic","slug":"topic","count":308,"path":"api/categories/topic.json"}],"tags":[],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%A0%BC%E5%BC%8F\"><span class=\"toc-text\">格式</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%AD%97%E6%AE%B5%E6%8F%8F%E8%BF%B0\"><span class=\"toc-text\">字段描述</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#enable\"><span class=\"toc-text\">enable</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#name\"><span class=\"toc-text\">name</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#id\"><span class=\"toc-text\">id</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#time\"><span class=\"toc-text\">time</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#judge\"><span class=\"toc-text\">judge</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#extractor\"><span class=\"toc-text\">extractor</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#handle\"><span class=\"toc-text\">handle</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#judge-conditions\"><span class=\"toc-text\">judge.conditions</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#extractor-extractions\"><span class=\"toc-text\">extractor.extractions</span></a></li></ol></li></ol>","author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"extraction.md","uid":"ee91c36a84884fbd0171736f39b1f0db","slug":"old_topic/2016-09-17-298","date":"2016-09-17T14:50:18.000Z","updated":"2024-03-14T06:15:59.747Z","comments":true,"path":"api/articles/old_topic/2016-09-17-298.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":null,"text":" category: Conceptredirect_from: - /docs/v0.4.0/concept/extraction/ - /docs/latest/concept/extraction/title: “变量提取器”sort_title: “6” 每个提取器的格式...","link":"","photos":[],"count_time":{"symbolsCount":704,"symbolsTime":"1 mins."},"categories":[{"name":"topic","slug":"topic","count":308,"path":"api/categories/topic.json"}],"tags":[],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"waf.md","uid":"af3dedc41147fb62d7e9d45739663031","slug":"old_topic/2016-09-17-303","date":"2016-09-17T14:50:18.000Z","updated":"2024-03-14T06:15:59.747Z","comments":true,"path":"api/articles/old_topic/2016-09-17-303.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":null,"text":" category: APIredirect_from: - /docs/latest/api/waf/title: “WAF防火墙”sort_title: “9”flag: “2” 1) 开启或关闭此插件请求 URI Method /waf/enable Post 参数 名称 ...","link":"","photos":[],"count_time":{"symbolsCount":"5k","symbolsTime":"5 mins."},"categories":[{"name":"topic","slug":"topic","count":308,"path":"api/categories/topic.json"}],"tags":[],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}}}