{"title":"rule.md","uid":"d1e289c6fe68119c3bd6635eff90f158","slug":"old_topic/2016-09-17-302","date":"2016-09-17T14:50:18.000Z","updated":"2024-03-14T07:45:09.217Z","comments":true,"path":"api/articles/old_topic/2016-09-17-302.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","content":"<hr />\n<h2 id=\"category-conceptredirect_from-docsv040conceptrule-docslatestconceptruletitle-规则sort_title-1\"><a class=\"markdownIt-Anchor\" href=\"#category-conceptredirect_from-docsv040conceptrule-docslatestconceptruletitle-规则sort_title-1\"></a> category: Concept<br />\nredirect_from:<br />\n- /docs/v0.4.0/concept/rule/<br />\n- /docs/latest/concept/rule/<br />\ntitle: “规则”<br />\nsort_title: “1”</h2>\n<p>** 规则 ** 是Orange中的一个概念，它可能包括一个<a href=\"/docs/concept/judge\">条件判断模块</a>、一个<a href=\"/docs/concept/extractor\">变量提取模块</a>和一个<a href=\"/docs/concept/handle\">后续处理模块</a>。一般情况下，插件的一条规则会包含条件判断模块和一个处理模块，根据需要选择是否使用变量提取模块，如分流插件就需要变量提取模块，但防火墙插件则不需要。</p>\n<p>下面通过一个具体的实例看一下它的组成。</p>\n<h3 id=\"格式\"><a class=\"markdownIt-Anchor\" href=\"#格式\"></a> 格式</h3>\n<p>以<code>重定向插件</code>的一条规则的结构为例，介绍如下(以json格式描述):</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#123;\n    &quot;enable&quot;: true,\n    &quot;name&quot;: &quot;用户访问重定向&quot;,\n    &quot;id&quot;: &quot;F7F73D94-AEEB-4B61-9E59-AEDBF200B941&quot;,\n    &quot;time&quot;: &quot;2016-05-04 16:05:03&quot;,\n    &quot;judge&quot;: &#123;\n        &quot;type&quot;: 1,\n        &quot;conditions&quot;: [\n            &#123;\n                &quot;type&quot;: &quot;URI&quot;,\n                &quot;operator&quot;: &quot;match&quot;,\n                &quot;value&quot;: &quot;^&#x2F;user&quot;\n            &#125;\n        ]\n    &#125;,\n    &quot;extractor&quot;: &#123;\n        &quot;type&quot;: 1,\n        &quot;extractions&quot;: [\n            &#123;\n                &quot;type&quot;: &quot;Query&quot;,\n                &quot;name&quot;: &quot;username&quot;\n            &#125;,\n            &#123;\n                &quot;type&quot;: &quot;Header&quot;,\n                &quot;name&quot;: &quot;id&quot;\n            &#125;\n        ]\n    &#125;,\n    &quot;handle&quot;: &#123;\n        &quot;trim_qs&quot;: false,\n        &quot;url_tmpl&quot;: &quot;&#x2F;u&#x2F;$&#123;2&#125;&#x2F;$&#123;1&#125;&quot;,\n        &quot;log&quot;: true\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<h3 id=\"字段描述\"><a class=\"markdownIt-Anchor\" href=\"#字段描述\"></a> 字段描述</h3>\n<p>各个字段的解释如下：</p>\n<h4 id=\"enable\"><a class=\"markdownIt-Anchor\" href=\"#enable\"></a> enable</h4>\n<p>是否开启这条规则</p>\n<h4 id=\"name\"><a class=\"markdownIt-Anchor\" href=\"#name\"></a> name</h4>\n<p>规则名称</p>\n<h4 id=\"id\"><a class=\"markdownIt-Anchor\" href=\"#id\"></a> id</h4>\n<p>这条规则的id，用于修改和删除</p>\n<h4 id=\"time\"><a class=\"markdownIt-Anchor\" href=\"#time\"></a> time</h4>\n<p>添加或者更改时间</p>\n<h4 id=\"judge\"><a class=\"markdownIt-Anchor\" href=\"#judge\"></a> judge</h4>\n<p>规则适配器，用于筛选请求，详见<a href=\"/docs/concept/judge/\">规则适配器</a></p>\n<h4 id=\"extractor\"><a class=\"markdownIt-Anchor\" href=\"#extractor\"></a> extractor</h4>\n<p>变量提取模块，用于提取出请求中的变量供后续使用，详见<a href=\"/docs/concept/extractor\">变量提取模块</a></p>\n<h4 id=\"handle\"><a class=\"markdownIt-Anchor\" href=\"#handle\"></a> handle</h4>\n<p>这条规则对应的后续处理，如果这条规则有一个下游触发动作，此值不为空。不同的插件这个字段的子字段可能不同。</p>\n<p>重定向插件的该字段子字段描述如下：</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">log: 当执行这个动作时，是否要记录日志\nurl_tmpl: 后续要redirect到的url模板，可在里面使用&#96;变量提取模块&#96;提取出来的值\ntrim_qs: 是否要清除原始请求的QueryString<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<h4 id=\"judgeconditions\"><a class=\"markdownIt-Anchor\" href=\"#judgeconditions\"></a> judge.conditions</h4>\n<p>条件集合，每个条件即为对某项值的判断，这个值是从HTTP请求中提取出来的。详见<a href=\"/docs/concept/condition\">匹配条件</a></p>\n<h4 id=\"extractorextractions\"><a class=\"markdownIt-Anchor\" href=\"#extractorextractions\"></a> extractor.extractions</h4>\n<p>从哪些项中提取变量。详见<a href=\"/docs/concept/extraction\">变量提取器</a></p>\n","text":" category: Concept redirect_from: - /docs/v0.4.0/concept/rule/ - /docs/latest/concept/rule/ title: “规则” sort_title: “1” ** 规则 ** 是Orange中的一个...","link":"","photos":[],"count_time":{"symbolsCount":"1.9k","symbolsTime":"2 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#category-conceptredirect_from-docsv040conceptrule-docslatestconceptruletitle-%E8%A7%84%E5%88%99sort_title-1\"><span class=\"toc-text\"> category: Concept\nredirect_from:\n- &#x2F;docs&#x2F;v0.4.0&#x2F;concept&#x2F;rule&#x2F;\n- &#x2F;docs&#x2F;latest&#x2F;concept&#x2F;rule&#x2F;\ntitle: “规则”\nsort_title: “1”</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%A0%BC%E5%BC%8F\"><span class=\"toc-text\"> 格式</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%AD%97%E6%AE%B5%E6%8F%8F%E8%BF%B0\"><span class=\"toc-text\"> 字段描述</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#enable\"><span class=\"toc-text\"> enable</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#name\"><span class=\"toc-text\"> name</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#id\"><span class=\"toc-text\"> id</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#time\"><span class=\"toc-text\"> time</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#judge\"><span class=\"toc-text\"> judge</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#extractor\"><span class=\"toc-text\"> extractor</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#handle\"><span class=\"toc-text\"> handle</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#judgeconditions\"><span class=\"toc-text\"> judge.conditions</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#extractorextractions\"><span class=\"toc-text\"> extractor.extractions</span></a></li></ol></li></ol></li></ol>","author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"judge.md","uid":"6cade316b90b96b8add415272fdf2bc9","slug":"old_topic/2016-09-17-301","date":"2016-09-17T14:50:18.000Z","updated":"2024-03-14T07:45:09.177Z","comments":true,"path":"api/articles/old_topic/2016-09-17-301.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":" category: Concept redirect_from: - /docs/v0.4.0/concept/judge/ - /docs/latest/concept/judge/ title: “条件判断模块” sort_title: “2” 条件判断模块，是一系列匹配条...","link":"","photos":[],"count_time":{"symbolsCount":401,"symbolsTime":"1 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"api_server.md","uid":"e3aed5e630276c44941c876b650cbd89","slug":"old_topic/2016-09-17-304","date":"2016-09-17T14:50:18.000Z","updated":"2024-03-14T07:45:09.160Z","comments":true,"path":"api/articles/old_topic/2016-09-17-304.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":" category: Advanced redirect_from: - /docs/latest/advanced/api_server/ title: “如何使用Open API” sort_title: “2” Orange提供了各种API用于实现第三方需求， 如： 根据A...","link":"","photos":[],"count_time":{"symbolsCount":257,"symbolsTime":"1 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}}}