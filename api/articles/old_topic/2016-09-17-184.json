{"title":"Moonscript的常用WEB特性","uid":"cc7492c9c593b6abb05073ddf9060cb2","slug":"old_topic/2016-09-17-184","date":"2016-09-17T14:50:18.000Z","updated":"2024-03-14T07:45:09.159Z","comments":true,"path":"api/articles/old_topic/2016-09-17-184.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","content":"<p>下面是一个简单的moonscript脚本，值得注意的地方有几点。<br />\n1.Moonscript如何表示List列比数据结构。<br />\n2.Moonscript的路由样式。<br />\n3.Moonscript如何取得请求URL中的参数变量值。<br />\n4.Moonscript如何遍历List数据结构。（pairs）<br />\n5.Moonscript如何显示HTML。<br />\n6.Moonscript判空语句。</p>\n  <h3>1.Moonscript如何表示List列比数据结构。</h3> \n<p>Lua种的Table在Moonscript种，便成了如下的格式。</p>\n<p>– Moonscript<br />\n[code]<br />\nlist_items =  {<br />\n“item1”:“test item1”<br />\n“item2”:“test item2”<br />\n“item3”:“test item3”<br />\n}<br />\n[/code]</p>\n<p>–Lua<br />\n[code]<br />\nlocal list_items = {<br />\n[“item1”] = “test item1”,<br />\n[“item2”] = “test item2”,<br />\n[“item3”] = “test item3”<br />\n}</p>\n<p>[/code]</p>\n<p>值得注意的地方就是，每个表元素之间没有了&quot;,&quot;逗号分割。</p>\n<p>如何直接翻译成Lua后，代码形式如下：</p>\n<h3>2.Moonscript的路由样式。</h3> \n<p>[code]<br />\n<a href=\"=%3E\">item: “/item/:name”</a>:=&gt;<br />\n[/code]<br />\nMoonscript是用这种形式表示路由的“item”， “/item/:name”表示URL后面可以跟的参数表量。</p>\n<h3>3.Moonscript如何取得请求URL中的参数变量值。</h3> \n[code]\n    item_description =  list_items[@params.name]\n[/code]    \n@params.name中，params表示输入参数的集合数据结构，\".name\"就是URL种的变量名。\n<p>4.Moonscript如何遍历List数据结构。（pairs）<br />\n[code]<br />\nfor item in pairs list_items<br />\nli -&gt;<br />\na href: @url_for(“item”, name:item), item<br />\n[/code]<br />\nMoonscript遍历Table，for关键字后面不用加do end结构。另外，可以使用pairs关键字，而没有ipairs关键字。</p>\n<h3> 5.Moonscript如何显示HTML。</h3> \n 逻辑和模板放到一起写，“业务”和“表示”放到一起写不便于解耦，但是对于懒人来说，这个特性就比较方便了。\n<p>[code]<br />\n@html -&gt;<br />\nh1 @params.name<br />\nh2 “Result list items”<br />\np item_description<br />\ndiv  “abc”<br />\n[/code]</p>\n<p>@html -&gt;下面就可以直接用短关键字，快捷的生成HTML语句。</p>\n<h3>6.Moonscript判空语句。</h3> \n [code]    \n    item_description =  list_items[@params.name]\n    unless item_description\n [/code]    \n<p>unless关键字用于判空，更接近自然语言。感觉用起来像Cobol的感觉，关键字好长。</p>\n<p>后记：<br />\n其实Moonscript也有语法缩进的，如果缩进不对在编译的时候会报错，这和Python，Cobol很像。</p>\n<p>另外，如下:<br />\n[code]<br />\n@html -&gt;<br />\n[/code]</p>\n<p>“@html”和&quot;-&gt;&quot;之间有一个空格。</p>\n<p>Moonscript懒人的福音。</p>\n<p>代码列表：<br />\n[code]<br />\nlapis = require “lapis”</p>\n<p>list_items =  {<br />\n“item1”:“test item1”<br />\n“item2”:“test item2”<br />\n“item3”:“test item3”<br />\n}</p>\n<p>list_div = {<br />\n“div1”:“div1”<br />\n“div2”:“div2”<br />\n“div3”:“div3”<br />\n}</p>\n<p>class extends lapis.Application<br />\n[index: “/”]:=&gt;<br />\n@html -&gt;<br />\nh1 “test page”<br />\na href: @url_for(“list_items”), “Check out my list items”</p>\n<pre><code>@html -&gt;\n  ul -&gt;\n    for item in pairs list_items\n      li -&gt;\n        a href: @url_for(&quot;item&quot;, name:item), item\n</code></pre>\n<pre><code>item_description =  list_items[@params.name]\nunless item_description\n  return &quot;Not found&quot;, status:404\n\n@html -&gt;\n  h1 @params.name \n  h2 &quot;Result list items&quot;\n  p item_description\n  div  &quot;abc&quot;\n</code></pre>\n<pre><code>@html -&gt;\n  for item in pairs list_div\n    h1 item\n    h1 &quot;test&quot;\n</code></pre>\n<p>[/code]</p>\n","text":"下面是一个简单的moonscript脚本，值得注意的地方有几点。 1.Moonscript如何表示List列比数据结构。 2.Moonscript的路由样式。 3.Moonscript如何取得请求URL中的参数变量值。 4.Moonscript如何遍历List数据结构。（pair...","link":"","photos":[],"count_time":{"symbolsCount":"2.3k","symbolsTime":"2 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\"><span class=\"toc-text\">1.Moonscript如何表示List列比数据结构。</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\"><span class=\"toc-text\">2.Moonscript的路由样式。</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\"><span class=\"toc-text\">3.Moonscript如何取得请求URL中的参数变量值。</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\"><span class=\"toc-text\"> 5.Moonscript如何显示HTML。</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\"><span class=\"toc-text\">6.Moonscript判空语句。</span></a></li></ol>","author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"Tup与Moonscript自动编译","uid":"72fc9906b7ade28d0ec3b847f7af3a98","slug":"old_topic/2016-09-17-183","date":"2016-09-17T14:50:18.000Z","updated":"2024-03-14T07:45:09.223Z","comments":true,"path":"api/articles/old_topic/2016-09-17-183.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":"tup可以监控文件变动的，再执行相应有执行动作。可以设定tupfile规则，当监控目录中的文件发生变化的时候，实时执行编译脚本，只要文件有改动，然后openresty服务会reload文件，刷新一下url就可以看到新的变动结果（LUA）。 安装TUP首先要在Linux上安装FUS...","link":"","photos":[],"count_time":{"symbolsCount":926,"symbolsTime":"1 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"Moonscript的WEB工程配置文件","uid":"92825ad55c31699146a13eff573616d1","slug":"old_topic/2016-09-17-185","date":"2016-09-17T14:50:18.000Z","updated":"2024-03-14T07:45:09.167Z","comments":true,"path":"api/articles/old_topic/2016-09-17-185.json","keywords":"AIGC,LLM,糖果AIGC实验室","cover":"https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg","text":"作者：糖果 http://www.lua.ren Lapis框架默认是没有配置文件，lapis new 创建出来的工程没有对监听的端口和数据库的相关设置，需要在工程目录下创建一个config.moon或是moon.lua配置文件，进行相关的设定。 首先，看一下如何通过Moonsc...","link":"","photos":[],"count_time":{"symbolsCount":"1.1k","symbolsTime":"1 mins."},"categories":[{"name":"topic","slug":"topic","count":1441,"path":"api/categories/topic.json"}],"tags":[],"author":{"name":"安全书","slug":"blog-author","avatar":"https://img-blog.csdnimg.cn/20210313122054101.png","link":"/","description":"《墨守之道-Web服务安全架构与实践》","socials":{"github":"https://github.com/shengnoah","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/3732639263","zhihu":"https://www.zhihu.com/people/openresty","csdn":"","juejin":"","customs":{}}}}}